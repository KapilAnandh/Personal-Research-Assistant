  
		<html lang="en">




<head>
<!-- <title>hklp-52</title> -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<link rel="icon" href="bloomsbury_assets/hklp/images/hklfav.png" sizes="16x16" type="image/png">
<meta charset="UTF-8">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KJ5ZC6WD');</script>
<!-- End Google Tag Manager -->





		



<script>
            window.fiveStarSession = "A78790AA23E3326513549F36A971666D";
      </script>




<meta property="og:url" content="http://www.humankineticslibrary.com/hklp/encyclopedia-chapter" />
<meta property="og:title" content="Scoring Systems" />
<meta property="og:description" content="For many years, traditional scoring in volleyball meant that only the serving team could score points. The first team to earn 15 points won the game, although they needed to win by 2 points. Winning a match required winning a series of games; historically, this was a best-of-three series.The sport o" />



	
			












																																													



























				
					

 










	



	



<input type="hidden" id="counterhiddenInput" value=""/>



<input type="hidden" id="session-timeout-Value" value="30"/>

  



	<meta name="description" content="For many years, traditional scoring in volleyball meant that only the serving team could score points. The first team to earn 15 points won the game, ">
	<meta name="keywords" content="hklp">

    <meta name="DC.identifier" content="b-9781718219342" />

	<title>Human Kinetics Library Platform - Scoring Systems</title>
<meta name="ST.PlatformAPIKey" content="31d35739668eaa1c" />

<!-- CSS -->
<link href="/bloomsbury_assets/bloomsbury/css/support.css" rel="stylesheet" type="text/css">
<link href="/bloomsbury_assets/bloomsbury/css/bootstrap-select.css" rel="stylesheet" type="text/css">
<link href="/bloomsbury_assets/bloomsbury/css/owl-carousel-new.css" rel="stylesheet" type="text/css">
<link href="/bloomsbury_assets/bloomsbury/css/checkbox.css" rel="stylesheet" type="text/css">
<link href="/bloomsbury_assets/bloomsbury/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="/bloomsbury_assets/hklp/css/plyr.css" rel="stylesheet" type="text/css">
<link href="/bloomsbury_assets/bloomsbury/css/bootstrap-slider.css" rel="stylesheet" type="text/css">
<link href="/bloomsbury_assets/bloomsbury/css/support-ui.css" rel="stylesheet" type="text/css">



				<link href="/bloomsbury_assets/hklp/css/hklp.css" rel="stylesheet" type="text/css">
		<link href="/bloomsbury_assets/hklp/css/product.css" rel="stylesheet" type="text/css">
	
<link href="/bloomsbury_assets/bloomsbury/css/typography.css" rel="stylesheet" type="text/css">

<!--<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>-->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" crossorigin="">
   

<!-- JS -->
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/custom.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/owl-carousel-new.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/custom-select.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/plyr.js"></script>


<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/bootstrap-slider.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/mousescroll.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery-show-first.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/clipboard.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery.mark.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery.cloudinary.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/bloomsbury.min.js?v=80018"></script>
<script src='https://www.recaptcha.net/recaptcha/api.js'></script>
<!--<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
   integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
   crossorigin=""></script>-->
   	 <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js" crossorigin=""></script>
	 	 <script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/leaflet.ChineseTmsProviders.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery.truncation.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/openseadragon.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/openseadragon-svg-overlay.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/snap.svg-min.js"></script>

<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/jquery.numeric.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/raphael.min.js"></script>
<script type="text/javascript" src="/bloomsbury_assets/bloomsbury/js/URI.min.js"></script>
<!-- <script src="https://ssl.geoplugin.net/json.gp?k=a79c8a904f5edab4&jsoncallback=getGeolocationData"></script> -->
<script>
	$.ajax({
			type: "GET",
			url: '/app/getmylocat',
			success: function(response){
				getGeolocationData(response); 
			},
			error: function(error){
				console.log(error);
			}
		});
</script>	


<!-- OneTrust Cookies Consent Notice start for humankineticslibrary.com -->
<script src="https://cdn-ukwest.onetrust.com/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="122ee2e4-8df8-40de-93f6-85caa09622cc" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for humankineticslibrary.com -->
</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KJ5ZC6WD "
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div style="position: absolute;top:-10000px;" class="skip-content-div">
<a href="javascript:void(0);" id="skip-content" tabindex="0" style="color:#ffffff;">Skip to main content</a>
</div>

<input type="hidden" id="copytocliptxt" name="copytoclipboard" value="Copy to Clipboard"/>
<input type="hidden" id="copiedtocliptxt" name="copiedtoclipboard" value="Copied"/>
<input id="counterEnabled" type="hidden" value="true">
<input id="instanceValue" type="hidden" value="instance2">
<div id="messageBoxFull" tabindex="0" aria-live="assertive" style="position:absolute;top:-10000;left:-10000" aria-relevant="additions removals"></div>

<a href="#" id="back-to-top" title="Back to Top" alt="Back to Top" style="display:none;">
    <div class="back_circle"><span class="icon-backtotop"></span></div>
    <div class="hidden-xs">Back to Top</div>
</a>

<div class="loading-hidden hide">
    <div class="loading-image"><img src="/bloomsbury_assets/bloomsbury/images/loader.gif" alt="Loading" title="Loading"> </div>
</div>

<div class="content-loader hide">
  <img src="/bloomsbury_assets/bloomsbury/images/loader.gif" alt="Loading" title="Loading" class="loader-icon"/>
</div>

<input type="hidden" id="imageAuthEnabled" value="false"/>

<script>
var sqtrkq = sqtrkq || [];
window.analyticsFlag = false;
function showAjaxLoader(element) {
    $(".content-loader").clone().removeClass("hide").appendTo(element);
}

function hideAjaxLoader(element) {
    $(element).find(".content-loader").remove();
}

(function(){
    var sqtrk=document.createElement('script');
    sqtrk.id='sqtrk';
    sqtrk.type='text/javascript';
    sqtrk.async=true;
    sqtrk.src=(('https:'==document.location.protocol)?'https':'http')+'://'+document.location.host+'/analytics/js/tracker.js';
    var selm=document.getElementsByTagName('script')[0];
    selm.parentNode.insertBefore(sqtrk,selm);
})();

var signupEventFlag=localStorage.getItem("signup-success");
if (signupEventFlag && signupEventFlag == "true") {
	dataLayer.push({
		'event' : 'sign_up'
	});
}
localStorage.removeItem("signup-success");

	// default language code setting
	if (typeof $.cookie('seleLang') === 'undefined'){
		$.cookie("seleLang", "en");
		$.cookie("taxonomy", "");
		$.cookie("contenttype", "");
		$.cookie("fromYear", "");
		$.cookie("toYear", "");
	}
	
   
 $(document).ready(function() {
  $(window).resize(function() {
   var width = $(window).width();
   if (width >= 1024) {
       } else if ((width <= 1023) && (width >= 768)) {
       } else {
       }
  });
  
	$(".lang_list a").on("click",function(){
	   var oldLang = $(".lang_list a.active").attr("data-lang");
	   var newLang = $(this).attr("data-lang");
	   $.cookie("seleLang", newLang);
	   location.reload();
	});
 }); 

function getCoverSheetDate(){
    var d = new Date();
    var year = d.getFullYear();
    var month = d.toLocaleString([], { month: "short" });
    var day = d.toLocaleString([], { day: "2-digit" });
    var time = d.getTime();
    var minutes = d.getTimezoneOffset();
    var offset =  minutes / 60;
    var utc = day + ' ' + month + ' ' + year +' at '+  d.getUTCHours() + ':'+d.getUTCMinutes()+':'+ d.getUTCSeconds() + "." + d.getUTCMilliseconds() + ''+ Math.floor(offset) + ":00";
    return utc;
 }
 
 function isIEBrowser() {
	   var ua = window.navigator.userAgent;
	   var msie = ua.indexOf("MSIE");
		// If Internet Explorer
	   if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))  
	   {
		  return true;
	   }
	   else
	   {
		return false;
	   }
 }
 
 function downloadPDF(filePath, downloadName) {
		if (isIEBrowser()){
			var _window = window.open(filePath, '_blank');
			//_window.document.close();
			//_window.document.execCommand('SaveAs', true, downloadName)
			//_window.close(); 
		} else {
			var link=document.createElement('a');
			link.href= filePath;
			link.download= downloadName;
			var isSafari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0 || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || safari.pushNotification);
			if (isSafari) {
				window.location.href=filePath;
			} else {
				var evt = document.createEvent('MouseEvents');
				evt.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);
				link.dispatchEvent(evt);
			}
		}
 }	
 function getMobileOperatingSystem() {
  var userAgent = navigator.userAgent || navigator.vendor || window.opera;

      // Windows Phone must come first because its UA also contains "Android"
    if (/windows phone/i.test(userAgent)) {
        return "Windows Phone";
    }

    if (/android/i.test(userAgent)) {
        return "Android";
    }

    // iOS detection from: http://stackoverflow.com/a/9039885/177710
    if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
        return "iOS";
    }

    return "unknown";
}
 
  function openPrint(content) {
  		var OS = getMobileOperatingSystem();
        if (OS == "iOS") {
          $("#printFrame").remove();
        }
		var frame1 = document.createElement('iframe');
		frame1.name = "frame1";
		frame1.id = "printFrame";
		frame1.style.position = "absolute";
		frame1.style.top = "-1000000px";
		document.body.appendChild(frame1);
		var frameDoc = frame1.contentWindow ? frame1.contentWindow : frame1.contentDocument.document ? frame1.contentDocument.document : frame1.contentDocument;
		if (OS == "Android") {
          var originalContents = document.body.innerHTML;
          document.body.innerHTML = xmlreq.responseText;
          setTimeout(function() {
            window.print();
            document.body.innerHTML = originalContents;
            showProgress();
            location.reload();
          }, 1000);
        } else if (OS == "iOS") {
          frameDoc.document.open();
          frameDoc.document.write(xmlreq.responseText);
          frameDoc.document.close();
          setTimeout(function () {
          window.frames["frame1"].focus();
          window.frames["frame1"].print();
          //document.body.removeChild(frame1);
          }, 1000);
        } else {
          frameDoc.document.open();
          frameDoc.document.write(xmlreq.responseText);
          frameDoc.document.close();
          setTimeout(function () {
          window.frames["frame1"].focus();
          window.frames["frame1"].print();
          document.body.removeChild(frame1);
          }, 500);
		}
 }
</script>



 
<div role="dialog" aria-modal="true" aria-labelledby="signin_modal" aria-describedby="signin-modal-description" class="modal fade" id="signin_modal" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="vertical-alignment-helper">
    <div class="modal-dialog signin-modal vertical-align-center" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="signin_close">
                    <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                        <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
                </div>
                                <h2 id="myModalLabel" tabindex="0" aria-label="Sign in to Your Personal Account ">Sign in to Your Personal Account </h2>
                                <div tabindex="0" class="signinwith hide hide signup_social" aria-label="Sign in with"><span>Sign in with:</span>
					<a href="javascript:;" onclick="if(confirm('You are being redirected to an external link. Do you wish to continue?')) {gp_login();return false;}
					else {return false;}" title="Google"><span class="icon-Social_Google" title="Google"></span></a>
					<a href="javascript:;" onclick="if(confirm('You are being redirected to an external link. Do you wish to continue?')) {fb_login();return false;}
					else {return false;}" title="Facebook"><span class="icon-Social_Facebook" title="Facebook"></span></a>
    				<a href="javascript:;" onclick="if(confirm('You are being redirected to an external link. Do you wish to continue?')) {tw_login();return false;}
					else {return false;}" title="Twitter"><span class="icon-Social_Twitter" title="Twitter"></span></a>
				</div>
                <p align="center" tabindex="0" aria-label="or" class="hide hide">Or</p>
                <form method="post" id="signin-form">
				   <span class="err-msg hide" id="signinerr" tabindex="0" aria-live="polite" aria-label="Incorrect Email Address or password. Please try again.">Incorrect Email Address or password. Please try again.</span>
                   <div class="form-group">
                        <label tabindex="0" aria-label="Email Address">Email Address</label>
                        <input type="email" class="form-control" id="signin-username" name="signin-username" placeholder="Enter your Email Address" autocomplete="off">   
						<span class="err-msg hide" tabindex="0" aria-live="assertive" aria-label="Invalid Email Address">Invalid Email Address</span>
                    </div>
                    <div class="form-group">
                        <label tabindex="0" aria-label="Password">Password</label>
                        <input type="password" class="form-control" id="signin-password" name="signin-password" placeholder="Enter password" autocomplete="off">
						<!-- <span class="err-msg hide" tabindex="0" aria-label="Invalid Password">Invalid Password</span> -->
                        <div class="forget_pass"><a href="pre-forgot-password">Forgot Password?</a></div>
                    </div>
                    <div class="clearfix"></div>
                    <div class="form-group" align="center">
                       <input type="button" id="signin-btn" class="primary_btn disabled-btn" value="Sign in">
                    </div>
					<div>
                    	With a personal account, you can save books, chapters, images or other items to view later.
                    </div>
                                    </form>
                <p class="personal_acc" tabindex="0" aria-label="Don't have a personal account yet? Sign up now">
                    Don't have a personal account yet?<br>
                    <!-- <a href="sign-up?recentUrl=/encyclopedia-chapter?docid=b-9781718219342&tocid=b-9781718219342-chapter14">Sign up now.</a> -->
                    <a href="https://p13n-bloomsbury.highwire.org/register?return-url=https://www.humankineticslibrary.com%2Fencyclopedia-chapter%3Fdocid%3Db-9781718219342%26tocid%3Db-9781718219342-chapter14">Sign up now.</a>
                </p>
            </div>
        </div>
    </div>
    </div>
</div>


<div role="dialog" aria-modal="true" aria-labelledby="commontool-changePassword" aria-describedby="changePassword-dialog-description" class="modal fade" id="changepass" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="vertical-alignment-helper">
        <div class="modal-dialog signin-modal change_password vertical-align-center" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="close_icon">
                    <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                        <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
                </div>
                <h2 id="head-changepwd" tabindex="0" aria-labelledby="head-changepwd">Change Password</h2>
                <form method="post" id="change-password-form">
                    <div class="form-group">
                        <label id="head-currentpwd" tabindex="0" aria-labelledby="head-currentpwd">Current Password</label>
                        <input name="oldpassword" id="change-old-pwd" type="password" class="form-control" placeholder="Enter Current Password" maxlength="20" autocomplete="off">
						<span id="head-currentpwd-err" class="err-msg hide" tabindex="0" aria-live="polite" aria-labelledby="head-currentpwd">Current Password doesn't match</span>
					</div>
                    <div class="form-group">
                        <label id="head-newpwd" tabindex="0" aria-labelledby="head-newpwd">New Password</label>
                        <input name="newpassword" id="change-new-pwd" type="password" class="form-control" placeholder="Enter new password" maxlength="20" autocomplete="off">
						<span id="head-newpwd-err" class="err-msg hide" tabindex="0" aria-live="polite" aria-labelledby="head-newpwd-err">Enter min 6 Characters</span>
					</div>
                    <div class="form-group">
                        <label id="head-confirm-newpwd" tabindex="0" aria-labelledby="head-confirm-newpwd">Confirm New Password</label>
                        <input name="confnewpassword" id="change-confirm-pwd" type="password" class="form-control" placeholder="Re-enter password" maxlength="20" autocomplete="off">
						<span id="head-confirm-newpwd-err" class="err-msg hide" tabindex="0"  aria-live="polite" aria-labelledby="head-confirm-newpwd">Entered password does not match</span>
					</div>
                    <div class="form-group no_margin" align="center">
                        <input type="button" id="change-pwd-btn" value="Save" class="primary_btn disabled-btn" aria-label="save">
                        <input type="button" value="Cancel" class="secondary_btn" data-dismiss="modal" aria-label="cancel">
                    </div>
                </form>
            </div>
        </div>
    </div>
    </div>
</div>


<!-- Signup via Social Media Modal starts Here-->
<div role="dialog" aria-modal="true" aria-labelledby="signup-social-media" aria-describedby="signup-social-media-description" class="modal fade" id="signup-social-media" tabindex="-1" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog" role="document">
	<div class="modal-content">		
		<div class="modal-body fb-signup">
			<div class="signin_close">
				<button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                    <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                </button>
			</div>
			  <h3 id="sn-signup-media-title" tabindex="0" aria-labelledby="sn-signup-media-title">Sign Up Via FaceBook</h3>
			  
			  <!-- <div class="row prof-pic"> -->
				<!-- <div class="col-lg-3 col-sm-3 col-md-3 col-xs-3 profile-icon"> -->
				<!-- <img id="sn-profile-pic" src="/bloomsbury_assets/bloomsbury/images/fb-prof-pic.jpg" style="margin: 0 auto; width: 70px; height: 70px;" class="img-rounded" alt="prof pic" tabindex="0"> -->
			    <!-- </div> -->
				<!-- <div class="col-lg-9 col-sm-9 col-md-9 col-xs-9"> -->
			    <!-- <h5 id="sn-full-name" tabindex="0" aria-labelledby="sn-full-name">John Doe</h5> -->
			    <!-- <p id="sn-email" class="mail-id" tabindex="0" aria-labelledby="sn-email">johndoe@gmail.com</p>	 -->
                <!-- <div class="fb-icon">				 -->
				<!-- <img id="sn-signup-icon" src="/bloomsbury_assets/bloomsbury/images/fb-signup-icon.png" alt="fb-icon" tabindex="0"> -->
				<!-- <span id="signup-social-label" tabindex="0" aria-labelledby="signup-social-label">&nbsp;Facebook</span></div> -->
			  <!-- </div> -->
			  <!-- </div> -->
			  
			  <div class="clearfix prof-pic">
				<div class="profile-icon">
				<img id="sn-profile-pic" src="/bloomsbury_assets/bloomsbury/images/fb-prof-pic.jpg" width="75" height="75" class="img-rounded" alt="prof pic" tabindex="0">
			    </div>
				<div class="profile-text">
			    <h5 id="sn-full-name" tabindex="0" aria-labelledby="sn-full-name">John Doe</h5>
			    <p id="sn-email" class="mail-id" tabindex="0" aria-labelledby="sn-email">johndoe@gmail.com</p>	
                <div class="fb-icon">				
				<img id="sn-signup-icon" src="/bloomsbury_assets/bloomsbury/images/fb-signup-icon.png" width="25" height="25" alt="fb-icon" tabindex="0">
				<span id="signup-social-label" tabindex="0" aria-labelledby="signup-social-label">&nbsp;Facebook</span></div>
			  </div>
			  </div>
			  
			  <div class="clearfix"></div>

			  <h4 id="head-addInfo" tabindex="0" aria-labelledby="head-addInfo">Additional info required</h4>
			  <div class="row">
				<form id="sn-signup-form" class="fb-signup-form" method="post">
					<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 signup-title hide">
						<div class="title_cont">
							<div class="form-group clearfix">
								<label id="head-social-titlab" tabindex="0" aria-labelledby="head-social-titlab">Title<sup>*</sup></label>
								<div class="clearfix"></div>
								<select id="sn-signup-title-option" name="title" class="selectpicker form-control title_style col-lg-6 col-md-6 col-sm-6 col-xs-6">
									<option value="">Select</option>
																														<option value="Mr."> Mr. </option>
																					<option value="Mrs."> Mrs. </option>
																					<option value="Miss."> Miss. </option>
																					<option value="Ms."> Ms. </option>
																					<option value="Dr."> Dr. </option>
																					<option value="Prof."> Prof. </option>
																					<option value="Other"> Other </option>
																											</select>
							<input type="text" id="sn-signup-other-txt-box" name="otherTitle" class="hide form-control title_style other-txt-box col-lg-6 col-md-6 col-sm-6 col-xs-6" autocomplete="off">
							</div>
						</div>
					</div>
					<div class="clearfix"></div>
					
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="form-group">
							<label id="head-social-frsnme" tabindex="0" aria-labelledby="head-social-frsnme">First Name<sup>*</sup></label>
							<input id="sn-signup-first-name" name="firstname" type="text" class="form-control" placeholder="First Name" maxlength="30" autocomplete="off">
						</div>
					</div>

					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12 hide">
						<div class="form-group">
							<label id="head-social-surnme" tabindex="0" aria-labelledby="head-social-surnme">Surname<sup>*</sup></label>
						<input id="sn-signup-sur-name" class="form-control" name="surname" type="text" class="form-control" placeholder="Surname" maxlength="30" autocomplete="off">
						</div>
					</div>
					<div class="clearfix"></div>
					
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12 hide">
						<div class="form-group">
							<label id="head-social-occup" tabindex="0" aria-labelledby="head-social-occup">Occupation<sup>*</sup></label>
							<select id="sn-signup-occupation-select" name="occupation" class="selectpicker form-control">
								<option value="">Select</option>
																											<option value="Librarian"> Librarian </option>
																			<option value="Academic/Faculty"> Academic/Faculty </option>
																			<option value="Administrator"> Administrator </option>
																			<option value="Student"> Student </option>
																			<option value="Other"> Other </option>
																								</select>
						</div>
						<div class="clearfix"></div>
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 no_pad">
							<input type="text" id="sn-signup-occupation-text-box" name="occupationTitle" class="hide form-control" autocomplete="off">
						</div>
					</div>

					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12 hide">
						<div class="form-group">
							<label id="head-social-crty" tabindex="0" aria-labelledby="head-social-crty">Country<sup>*</sup></label>
							<select id="sn-signup-country" name="signup-country" class="selectpicker form-control">
								<option value="">Select</option>
																											<option value="af" title="Afghanistan">Afghanistan</option>
																			<option value="ax" title="Aland Islands">Aland Islands</option>
																			<option value="al" title="Albania">Albania</option>
																			<option value="dz" title="Algeria">Algeria</option>
																			<option value="as" title="American Samoa">American Samoa</option>
																			<option value="ad" title="Andorra">Andorra</option>
																			<option value="ao" title="Angola">Angola</option>
																			<option value="ai" title="Anguilla">Anguilla</option>
																			<option value="aq" title="Antarctica">Antarctica</option>
																			<option value="ag" title="Antigua and Barbuda">Antigua and Barbuda</option>
																			<option value="ar" title="Argentina">Argentina</option>
																			<option value="am" title="Armenia">Armenia</option>
																			<option value="aw" title="Aruba">Aruba</option>
																			<option value="au" title="Australia">Australia</option>
																			<option value="at" title="Austria">Austria</option>
																			<option value="az" title="Azerbaijan">Azerbaijan</option>
																			<option value="bs" title="Bahamas">Bahamas</option>
																			<option value="bh" title="Bahrain">Bahrain</option>
																			<option value="bd" title="Bangladesh">Bangladesh</option>
																			<option value="bb" title="Barbados">Barbados</option>
																			<option value="by" title="Belarus">Belarus</option>
																			<option value="be" title="Belgium">Belgium</option>
																			<option value="bz" title="Belize">Belize</option>
																			<option value="bj" title="Benin">Benin</option>
																			<option value="bm" title="Bermuda">Bermuda</option>
																			<option value="bt" title="Bhutan">Bhutan</option>
																			<option value="bo" title="Bolivia, Plurinational State of">Bolivia, Plurinational State of</option>
																			<option value="bq" title="Bonaire, Sint Eustatius and Saba">Bonaire, Sint Eustatius and Saba</option>
																			<option value="ba" title="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
																			<option value="bw" title="Botswana">Botswana</option>
																			<option value="bv" title="Bouvet Island">Bouvet Island</option>
																			<option value="br" title="Brazil">Brazil</option>
																			<option value="io" title="British Indian Ocean Territory">British Indian Ocean Territory</option>
																			<option value="bn" title="Brunei Darussalam">Brunei Darussalam</option>
																			<option value="bg" title="Bulgaria">Bulgaria</option>
																			<option value="bf" title="Burkina Faso">Burkina Faso</option>
																			<option value="bi" title="Burundi">Burundi</option>
																			<option value="kh" title="Cambodia">Cambodia</option>
																			<option value="cm" title="Cameroon">Cameroon</option>
																			<option value="ca" title="Canada">Canada</option>
																			<option value="cv" title="Cape Verde">Cape Verde</option>
																			<option value="ky" title="Cayman Islands">Cayman Islands</option>
																			<option value="cf" title="Central African Republic">Central African Republic</option>
																			<option value="td" title="Chad">Chad</option>
																			<option value="cl" title="Chile">Chile</option>
																			<option value="cn" title="China">China</option>
																			<option value="cx" title="Christmas Island">Christmas Island</option>
																			<option value="cc" title="Cocos (Keeling) Islands">Cocos (Keeling) Islands</option>
																			<option value="co" title="Colombia">Colombia</option>
																			<option value="km" title="Comoros">Comoros</option>
																			<option value="cg" title="Congo">Congo</option>
																			<option value="cd" title="Congo, the Democratic Republic of the">Congo, the Democratic Republic of the</option>
																			<option value="ck" title="Cook Islands">Cook Islands</option>
																			<option value="cr" title="Costa Rica">Costa Rica</option>
																			<option value="ci" title="Côte d'Ivoire">Côte d'Ivoire</option>
																			<option value="hr" title="Croatia">Croatia</option>
																			<option value="cu" title="Cuba">Cuba</option>
																			<option value="cw" title="Curaçao">Curaçao</option>
																			<option value="cy" title="Cyprus">Cyprus</option>
																			<option value="cz" title="Czech Republic">Czech Republic</option>
																			<option value="dk" title="Denmark">Denmark</option>
																			<option value="dj" title="Djibouti">Djibouti</option>
																			<option value="dm" title="Dominica">Dominica</option>
																			<option value="do" title="Dominican Republic">Dominican Republic</option>
																			<option value="ec" title="Ecuador">Ecuador</option>
																			<option value="eg" title="Egypt">Egypt</option>
																			<option value="sv" title="El Salvador">El Salvador</option>
																			<option value="gq" title="Equatorial Guinea">Equatorial Guinea</option>
																			<option value="er" title="Eritrea">Eritrea</option>
																			<option value="ee" title="Estonia">Estonia</option>
																			<option value="et" title="Ethiopia">Ethiopia</option>
																			<option value="fk" title="Falkland Islands (Malvinas)">Falkland Islands (Malvinas)</option>
																			<option value="fo" title="Faroe Islands">Faroe Islands</option>
																			<option value="fj" title="Fiji">Fiji</option>
																			<option value="fi" title="Finland">Finland</option>
																			<option value="fr" title="France">France</option>
																			<option value="gf" title="French Guiana">French Guiana</option>
																			<option value="pf" title="French Polynesia">French Polynesia</option>
																			<option value="tf" title="French Southern Territories">French Southern Territories</option>
																			<option value="ga" title="Gabon">Gabon</option>
																			<option value="gm" title="Gambia">Gambia</option>
																			<option value="ge" title="Georgia">Georgia</option>
																			<option value="de" title="Germany">Germany</option>
																			<option value="gh" title="Ghana">Ghana</option>
																			<option value="gi" title="Gibraltar">Gibraltar</option>
																			<option value="gr" title="Greece">Greece</option>
																			<option value="gl" title="Greenland">Greenland</option>
																			<option value="gd" title="Grenada">Grenada</option>
																			<option value="gp" title="Guadeloupe">Guadeloupe</option>
																			<option value="gu" title="Guam">Guam</option>
																			<option value="gt" title="Guatemala">Guatemala</option>
																			<option value="gg" title="Guernsey">Guernsey</option>
																			<option value="gn" title="Guinea">Guinea</option>
																			<option value="gw" title="Guinea-Bissau">Guinea-Bissau</option>
																			<option value="gy" title="Guyana">Guyana</option>
																			<option value="ht" title="Haiti">Haiti</option>
																			<option value="hm" title="Heard Island and McDonald Islands">Heard Island and McDonald Islands</option>
																			<option value="va" title="Holy See (Vatican City State)">Holy See (Vatican City State)</option>
																			<option value="hn" title="Honduras">Honduras</option>
																			<option value="hk" title="Hong Kong">Hong Kong</option>
																			<option value="hu" title="Hungary">Hungary</option>
																			<option value="is" title="Iceland">Iceland</option>
																			<option value="in" title="India">India</option>
																			<option value="id" title="Indonesia">Indonesia</option>
																			<option value="ir" title="Iran, Islamic Republic of">Iran, Islamic Republic of</option>
																			<option value="iq" title="Iraq">Iraq</option>
																			<option value="ie" title="Ireland">Ireland</option>
																			<option value="im" title="Isle of Man">Isle of Man</option>
																			<option value="il" title="Israel">Israel</option>
																			<option value="it" title="Italy">Italy</option>
																			<option value="jm" title="Jamaica">Jamaica</option>
																			<option value="jp" title="Japan">Japan</option>
																			<option value="je" title="Jersey">Jersey</option>
																			<option value="jo" title="Jordan">Jordan</option>
																			<option value="kz" title="Kazakhstan">Kazakhstan</option>
																			<option value="ke" title="Kenya">Kenya</option>
																			<option value="ki" title="Kiribati">Kiribati</option>
																			<option value="kp" title="Korea, Democratic People's Republic of">Korea, Democratic People's Republic of</option>
																			<option value="kr" title="Korea, Republic of">Korea, Republic of</option>
																			<option value="kw" title="Kuwait">Kuwait</option>
																			<option value="kg" title="Kyrgyzstan">Kyrgyzstan</option>
																			<option value="la" title="Lao People's Democratic Republic">Lao People's Democratic Republic</option>
																			<option value="lv" title="Latvia">Latvia</option>
																			<option value="lb" title="Lebanon">Lebanon</option>
																			<option value="ls" title="Lesotho">Lesotho</option>
																			<option value="lr" title="Liberia">Liberia</option>
																			<option value="ly" title="Libya">Libya</option>
																			<option value="li" title="Liechtenstein">Liechtenstein</option>
																			<option value="lt" title="Lithuania">Lithuania</option>
																			<option value="lu" title="Luxembourg">Luxembourg</option>
																			<option value="mo" title="Macao">Macao</option>
																			<option value="mk" title="Macedonia, the Former Yugoslav Republic of">Macedonia, the Former Yugoslav Republic of</option>
																			<option value="mg" title="Madagascar">Madagascar</option>
																			<option value="mw" title="Malawi">Malawi</option>
																			<option value="my" title="Malaysia">Malaysia</option>
																			<option value="mv" title="Maldives">Maldives</option>
																			<option value="ml" title="Mali">Mali</option>
																			<option value="mt" title="Malta">Malta</option>
																			<option value="mh" title="Marshall Islands">Marshall Islands</option>
																			<option value="mq" title="Martinique">Martinique</option>
																			<option value="mr" title="Mauritania">Mauritania</option>
																			<option value="mu" title="Mauritius">Mauritius</option>
																			<option value="yt" title="Mayotte">Mayotte</option>
																			<option value="mx" title="Mexico">Mexico</option>
																			<option value="fm" title="Micronesia, Federated States of">Micronesia, Federated States of</option>
																			<option value="md" title="Moldova, Republic of">Moldova, Republic of</option>
																			<option value="mc" title="Monaco">Monaco</option>
																			<option value="mn" title="Mongolia">Mongolia</option>
																			<option value="me" title="Montenegro">Montenegro</option>
																			<option value="ms" title="Montserrat">Montserrat</option>
																			<option value="ma" title="Morocco">Morocco</option>
																			<option value="mz" title="Mozambique">Mozambique</option>
																			<option value="mm" title="Myanmar">Myanmar</option>
																			<option value="na" title="Namibia">Namibia</option>
																			<option value="nr" title="Nauru">Nauru</option>
																			<option value="np" title="Nepal">Nepal</option>
																			<option value="nl" title="Netherlands">Netherlands</option>
																			<option value="nc" title="New Caledonia">New Caledonia</option>
																			<option value="nz" title="New Zealand">New Zealand</option>
																			<option value="ni" title="Nicaragua">Nicaragua</option>
																			<option value="ne" title="Niger">Niger</option>
																			<option value="ng" title="Nigeria">Nigeria</option>
																			<option value="nu" title="Niue">Niue</option>
																			<option value="nf" title="Norfolk Island">Norfolk Island</option>
																			<option value="mp" title="Northern Mariana Islands">Northern Mariana Islands</option>
																			<option value="no" title="Norway">Norway</option>
																			<option value="om" title="Oman">Oman</option>
																			<option value="pk" title="Pakistan">Pakistan</option>
																			<option value="pw" title="Palau">Palau</option>
																			<option value="ps" title="Palestine, State of">Palestine, State of</option>
																			<option value="pa" title="Panama">Panama</option>
																			<option value="pg" title="Papua New Guinea">Papua New Guinea</option>
																			<option value="py" title="Paraguay">Paraguay</option>
																			<option value="pe" title="Peru">Peru</option>
																			<option value="ph" title="Philippines">Philippines</option>
																			<option value="pn" title="Pitcairn">Pitcairn</option>
																			<option value="pl" title="Poland">Poland</option>
																			<option value="pt" title="Portugal">Portugal</option>
																			<option value="pr" title="Puerto Rico">Puerto Rico</option>
																			<option value="qa" title="Qatar">Qatar</option>
																			<option value="re" title="Réunion">Réunion</option>
																			<option value="ro" title="Romania">Romania</option>
																			<option value="ru" title="Russian Federation">Russian Federation</option>
																			<option value="rw" title="Rwanda">Rwanda</option>
																			<option value="bl" title="Saint Barthélemy">Saint Barthélemy</option>
																			<option value="sh" title="Saint Helena, Ascension and Tristan da Cunha">Saint Helena, Ascension and Tristan da Cunha</option>
																			<option value="kn" title="Saint Kitts and Nevis">Saint Kitts and Nevis</option>
																			<option value="lc" title="Saint Lucia">Saint Lucia</option>
																			<option value="mf" title="Saint Martin (French part)">Saint Martin (French part)</option>
																			<option value="pm" title="Saint Pierre and Miquelon">Saint Pierre and Miquelon</option>
																			<option value="vc" title="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines</option>
																			<option value="ws" title="Samoa">Samoa</option>
																			<option value="sm" title="San Marino">San Marino</option>
																			<option value="st" title="Sao Tome and Principe">Sao Tome and Principe</option>
																			<option value="sa" title="Saudi Arabia">Saudi Arabia</option>
																			<option value="sn" title="Senegal">Senegal</option>
																			<option value="rs" title="Serbia">Serbia</option>
																			<option value="sc" title="Seychelles">Seychelles</option>
																			<option value="sl" title="Sierra Leone">Sierra Leone</option>
																			<option value="sg" title="Singapore">Singapore</option>
																			<option value="sx" title="Sint Maarten (Dutch part)">Sint Maarten (Dutch part)</option>
																			<option value="sk" title="Slovakia">Slovakia</option>
																			<option value="si" title="Slovenia">Slovenia</option>
																			<option value="sb" title="Solomon Islands">Solomon Islands</option>
																			<option value="so" title="Somalia">Somalia</option>
																			<option value="za" title="South Africa">South Africa</option>
																			<option value="gs" title="South Georgia and the South Sandwich Islands">South Georgia and the South Sandwich Islands</option>
																			<option value="ss" title="South Sudan">South Sudan</option>
																			<option value="es" title="Spain">Spain</option>
																			<option value="lk" title="Sri Lanka">Sri Lanka</option>
																			<option value="sd" title="Sudan">Sudan</option>
																			<option value="sr" title="Suriname">Suriname</option>
																			<option value="sj" title="Svalbard and Jan Mayen">Svalbard and Jan Mayen</option>
																			<option value="sz" title="Swaziland">Swaziland</option>
																			<option value="se" title="Sweden">Sweden</option>
																			<option value="ch" title="Switzerland">Switzerland</option>
																			<option value="sy" title="Syrian Arab Republic">Syrian Arab Republic</option>
																			<option value="tw" title="Taiwan, Province of China">Taiwan, Province of China</option>
																			<option value="tj" title="Tajikistan">Tajikistan</option>
																			<option value="tz" title="Tanzania, United Republic of">Tanzania, United Republic of</option>
																			<option value="th" title="Thailand">Thailand</option>
																			<option value="tl" title="Timor-Leste">Timor-Leste</option>
																			<option value="tg" title="Togo">Togo</option>
																			<option value="tk" title="Tokelau">Tokelau</option>
																			<option value="to" title="Tonga">Tonga</option>
																			<option value="tt" title="Trinidad and Tobago">Trinidad and Tobago</option>
																			<option value="tn" title="Tunisia">Tunisia</option>
																			<option value="tr" title="Turkey">Turkey</option>
																			<option value="tm" title="Turkmenistan">Turkmenistan</option>
																			<option value="tc" title="Turks and Caicos Islands">Turks and Caicos Islands</option>
																			<option value="tv" title="Tuvalu">Tuvalu</option>
																			<option value="ug" title="Uganda">Uganda</option>
																			<option value="ua" title="Ukraine">Ukraine</option>
																			<option value="ae" title="United Arab Emirates">United Arab Emirates</option>
																			<option value="gb" title="United Kingdom">United Kingdom</option>
																			<option value="us" title="United States">United States</option>
																			<option value="um" title="United States Minor Outlying Islands">United States Minor Outlying Islands</option>
																			<option value="uy" title="Uruguay">Uruguay</option>
																			<option value="uz" title="Uzbekistan">Uzbekistan</option>
																			<option value="vu" title="Vanuatu">Vanuatu</option>
																			<option value="ve" title="Venezuela, Bolivarian Republic of">Venezuela, Bolivarian Republic of</option>
																			<option value="vn" title="Viet Nam">Viet Nam</option>
																			<option value="vg" title="Virgin Islands, British">Virgin Islands, British</option>
																			<option value="vi" title="Virgin Islands, U.S.">Virgin Islands, U.S.</option>
																			<option value="wf" title="Wallis and Futuna">Wallis and Futuna</option>
																			<option value="eh" title="Western Sahara">Western Sahara</option>
																			<option value="ye" title="Yemen">Yemen</option>
																			<option value="zm" title="Zambia">Zambia</option>
																			<option value="zw" title="Zimbabwe">Zimbabwe</option>
																								</select>
						</div>
					</div>
					<div class="clearfix"></div>
					
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="form-group">
							<label id="head-social-emaillab" tabindex="0" aria-labelledby="head-social-emaillab">Email Address<sup>*</sup></label>
							<input id="sn-signup-email-addr" type="email" name="email" class="form-control" placeholder="Email Address" autocomplete="off">
                            <span id="sn-signup-emailexists" class="err-msg hide" tabindex="0" aria-live="polite" aria-label="Invalid Email address">Invalid Email address</span>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" id="sn-social-verify-email">
						<div class="form-group">
							<label id="head-social-cnfemail" tabindex="0" aria-labelledby="head-social-cnfemail">Confirm Email Address<sup>*</sup></label>
							<input id="sn-signup-verify-email" type="email" class="form-control" placeholder="Confirm Email Address" autocomplete="off">
                            <span id="sn-signup-verify-email-err" class="err-msg hide" tabindex="0" aria-live="polite" aria-labelledby="signup-verify-email-err">Entered Email address does not match</span>
						</div>
					</div>
										<input id="sn-password" type="hidden" name="profile-id">
					<input id="sn-signup-social" type="hidden" name="signup-social-name">
					<div class="clearfix"></div>
					
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="checkbox hide">
							<input id="sn-signup-checkbox1" name="keepintouch" class="styled" type="checkbox">
							<label for="sn-signup-checkbox1" tabindex="0" aria-labelledby="I would like to receive information on Human Kinetics Library Platform and related Bloomsbury products">
								I would like to receive information on Human Kinetics Library Platform and related Bloomsbury products
							</label>
						</div>
						<div class="checkbox">
							<input id="sn-signup-checkbox2" class="styled" type="checkbox">
							<label for="sn-signup-checkbox2" tabindex="0" aria-labelledby="sn-signup-checkbox2">
								I agree with  <a href="terms-and-conditions">Terms & Conditions</a> and <a href="privacy-policy">Privacy & Cookies Policy</a><sup>*</sup>
							</label>
						</div>
					</div>
					
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
						<div class="form-group button_elements">							
							<input id="sn-signup-send-btn" type="button" value="Submit" class="primary_btn disabled-btn">
							<input type="button" value="Clear" class="secondary_btn" data-toggle="modal" data-target="#sn-signup-reset">
						</div>
					</div>
					
				</form>
			  </div>
		</div>
	</div>
  </div>
</div>
<!-- Signup via Social Media Modal End's Here-->

<div role="dialog" aria-modal="true" aria-labelledby="commontool-sn-signup-reset" aria-describedby="sn-signup-reset-description" class="modal fade" id="sn-signup-reset" tabindex="-1" data-backdrop="static" data-keyboard="false">
  <div class="vertical-alignment-helper">
	  <div class="modal-dialog alert_modal vertical-align-center" role="document">
		<div class="modal-content">
		  <div class="modal-body">
			<h2 id="socialsignup-alertmsg" tabindex="0" aria-labelledby="socialsignup-alertmsg">Alert</h2>
			<p id="socialsignup-alertconfirm" tabindex="0" aria-labelledby="socialsignup-alertconfirm">Are you sure you want to reset the form?</p>
			<input type="button" value="Yes" class="primary_btn sn-signup-clear-btn" data-dismiss="modal"> 
			<input data-dismiss="modal" type="button" value="No" class="secondary_btn sn-signup-clear-cancel-btn">
		  </div>
		</div>
	  </div>
	</div> 
</div>

<!-- Shareviaemail model window ---->
<div role="dialog" aria-modal="true" aria-labelledby="sharevia-mail" aria-describedby="sharevia-mail-dialog-description" class="modal fade" id="sharevia-mail" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="vertical-alignment-helper">
		<div class="modal-dialog share-via-success vertical-align-center" role="document">
			<div class="modal-content">
		   <div class="modal-body text-center">
			<h2 id="socialsignup-successmsg" tabindex="0" aria-labelledby="socialsignup-successmsg">Success</h2>
			<p id="socialsignup-alertconfirmation" tabindex="0" aria-labelledby="socialsignup-alertconfirmation">Your mail has been sent successfully</p>
			<input type="button" value="OK" class="primary_btn sn-signup-clear-btn" data-dismiss="modal"> 
		  </div>
			</div>
		</div>
    </div>
</div>


<!-- Alert Selection-->

<div role="dialog" aria-modal="true" aria-labelledby="commontool-sharevia-mail" aria-describedby="sharevia-mail-dialog-description"  class="modal fade" id="alertselect" tabindex="-1" data-backdrop="static" data-keyboard="false">
  <div class="vertical-alignment-helper">
	  <div class="modal-dialog alert_modal vertical-align-center" role="document">
		<div class="modal-content">
		  <div class="modal-body">
			<h2 id="alert-alertmsg" tabindex="0" aria-labelledby="alert-alertmsg">Alert Me</h2>
			<p id="alert-alertconfirm" tabindex="0" aria-labelledby="alert-alertconfirm">Are you sure you want to remove the alert?</p>
			<input type="button" value="Yes" class="primary_btn alert-clear-btn" data-dismiss="modal" id="remove-alert-button"> 
			<input data-dismiss="modal" type="button" value="No" class="secondary_btn alert-clear-cancel-btn">
		  </div>
		</div>
	  </div>
	</div> 
</div>

<script type="text/javascript">
  var emailNotMatchMsg = "Entered Email address does not match";
  function setTwitterUserInfo(id, fullname, firstname, surname, email, profileImageUrl){
    var signUpViaTiw = "Sign Up Via";
    document.getElementById("sn-signup-media-title").innerHTML = signUpViaTiw+" Twitter";
    document.getElementById("sn-full-name").innerHTML = fullname;
    document.getElementById("sn-email").innerHTML = email;
    document.getElementById("sn-profile-pic").setAttribute("src", profileImageUrl);
    document.getElementById("sn-signup-icon").setAttribute("src", "/bloomsbury_assets/bloomsbury/images/signin_twitter.png");
    document.getElementById("signup-social-label").innerHTML = "Twitter";
    document.getElementById("sn-signup-first-name").value = fullname;
    document.getElementById("sn-signup-sur-name").value = surname;
    document.getElementById("sn-password").value = id;
    document.getElementById("sn-signup-social").value = "twitter";
    document.getElementById("sn-signup-email-addr").value = email;
    var dbFlag = validateUserExists(id);
    if(dbFlag) {
      window.location.href = '/signin?id=' + id + '&recentUrl=/encyclopedia-chapter?docid=b-9781718219342&tocid=b-9781718219342-chapter14';
    } else {
      // now popup the signup modal
      $('#signup-social-media').modal('show');
    }
  }

  function twitterDenied(){
    $('#signin-username').css("border","solid red 1px").siblings("span").removeClass("hide").html('Access Denied');
  }

  function SocialSignUpSubmission() {
    var isValid = true;
    var $email_addr=$('#sn-signup-email-addr');
    var $verify_email_addr=$('#sn-signup-verify-email');
    var f_email=$email_addr.val();
    var s_email=$verify_email_addr.val();
    $email_addr.css("border","solid #ccc 1px").siblings("span").addClass("hide");
    $verify_email_addr.css("border","solid #ccc 1px").siblings("span").addClass("hide");
    if(!ValidateEmail(f_email)){
        isValid=false;
        $email_addr.css("border","solid red 1px").siblings("span").removeClass("hide");
    }
    if(f_email!=s_email){
        isValid=false;
		
        $verify_email_addr.css("border","solid red 1px").siblings("span").removeClass("hide").html(emailNotMatchMsg);
    }
    if (isValid) {
        showProgress();
        $.ajax({
            type: "POST",
            url: '/app/sams',
            dataType: 'text',
            data: {username: f_email},
            async: false,
            success: function (e) {
                if (e == "-1") {
                    $("#sn-signup-form").submit();
                } else {
                    hideProgress();
                    $('#sn-signup-email-addr').css("border","solid red 1px").siblings("span").removeClass("hide").html('Email Address already exists');
                }
            },
            error: function (error) {
                console.log(error);
            }
        });
    }
}

$(document).ready(function() {
	$("#change-old-pwd, #change-new-pwd, #change-confirm-pwd").keyup(function(event) {
		$(this).css("border","solid #ccc 1px").siblings("span").addClass("hide");
		if (!$(this).val()) {
			$("#change-pwd-btn").addClass("disabled-btn");
		}
		else {
			if ($("#change-old-pwd").val() != "" && $("#change-new-pwd").val() != "" && $("#change-confirm-pwd").val() != "") {
				$("#change-pwd-btn").removeClass("disabled-btn");
			} else {
				$("#change-pwd-btn").addClass("disabled-btn");
			}
		}
		if(!$("#change-pwd-btn").hasClass('disabled-btn')){
			if(event.keyCode=="13"){
				changePassword();
			}
		}
	});

  	
	$("#social-signup-close").on('click', function(e) {
		$("#signup-social-media").find('.selectpicker').selectpicker('deselectAll');
		$("#signup-social-media").find("input:checkbox").removeAttr("checked");
	});
	
	var input_email_addr;
	$('#signup-social-media').on('show.bs.modal', function (e) {
		input_email_addr = $("#sn-signup-email-addr").val();
	});
	
	$("#sn-signup-email-addr").on('keyup', function() {
		var input_verify_email_addr = $("#sn-signup-email-addr").val();
		if (input_email_addr != input_verify_email_addr) {
			$("#sn-social-verify-email").removeClass("hide");
		} else {
			$("#sn-social-verify-email").addClass("hide");
		}
		var socialSignupMandatory = $("#sn-signup-title-option, #sn-signup-first-name, #sn-signup-sur-name, #sn-signup-email-addr, #sn-signup-verify-email, #sn-signup-occupation-select, #sn-signup-country, #sn-signup-checkbox2, #sn-signup-other-txt-box, #sn-signup-occupation-text-box");
		socialSignupValidate(socialSignupMandatory);
	});

  $(".glyphicon.glyphicon-minus, .glyphicon.glyphicon-plus, .search-fav-icon").on("keyup", function(e){
    if (e.keyCode == 13) {
      $(this).click();
    }
  });
});

$("#changepass").on("hide.bs.modal", function (e) {
	$("#change-pwd-btn").addClass("disabled-btn");
	$(this).find("input[type=password]").val("").css("border","solid #ccc 1px");	
	$(this).find(".err-msg").addClass("hide");
});

function changePassword() {
	var oldPwd =  $("#change-old-pwd").val();
	var newPwd =  $("#change-new-pwd").val();
	var confirmPwd =  $("#change-confirm-pwd").val();
	$("#change-new-pwd").css("border","solid #ccc 1px").siblings("span").addClass("hide");
	$("#change-confirm-pwd").css("border","solid #ccc 1px").siblings("span").addClass("hide");
	if (newPwd.length < 6) {
		$("#change-new-pwd").css("border","solid red 1px").siblings("span").removeClass("hide");
		$("#change-new-pwd").focus();
		return false;
	}
	if (newPwd != confirmPwd) {
		$("#change-confirm-pwd").css("border","solid red 1px").siblings("span").removeClass("hide");
		$("#change-confirm-pwd").focus();
		return false;
	}
	$("#change-password-form").submit();
}

$(document).on('click', "#change-pwd-btn", function() {
	if (!$(this).hasClass('disabled-btn')) {
		changePassword();
	}
});

$(document).on('click', ".signin-success-btn", function() {
	var signinUser = $("#signin-username").val();
	if (!ValidateEmail(signinUser)){
		$("#signin-username").addClass("error-address").css("border","solid red 1px").siblings("span").removeClass("hide");
		$("#signin-username").focus();
	}
	else {
		$("#signin-username").css("border","solid #ccc 1px").siblings("span").addClass("hide");
		showProgress();
		$("#signin-form").submit();
	}
});
$("#signin-username,#signin-password").on('keyup',function(e){
	if($("#signin-username").val() == ""){
		$("#signin-username").css("border","1px solid #ccc");
	}
	if($("#signin-password").val() == ""){
		$("#signin-password").css("border","1px solid #ccc");
	}
	if(!$(this).hasClass('disabled-btn')){
		if(e.keyCode=="13"){
			showProgress();
			$("#signin-form").submit();
		}
	}
});
$("#signin_modal").on('show.bs.modal', function (e) {
	 $("#signin_modal h2").focus();
	if ($('#signin-username').val().trim().length == 0 || $('#signin-password').val().trim().length == 0) {
		$("#signin-btn").addClass("disabled-btn").removeClass("signin-success-btn");
	}
	else {
		if ($("#signin-username").val() != "" && $("#signin-password").val() != "") {
			$("#signin-btn").removeClass("disabled-btn").addClass("signin-success-btn");
			$("#signin-username").css("border","1px solid #ccc").siblings("span").addClass("hide");
			$("#signin-password").css("border","1px solid #ccc").siblings("span").addClass("hide");
		} else {
		    $("#signin-btn").addClass("disabled-btn").removeClass("signin-success-btn");
		}
	}
});
$("#skip-content").on("click keyup", function(e){
  if (e.type == "click" || e.keyCode == 13) {
        $(".page-content-start").attr("tabindex", "0");
    $(".page-content-start").focus();
    $(".page-content-start").addClass("no-focus");
    $(".page-content-start").attr("id", "pageStart");
    document.getElementById("pageStart").scrollIntoView();
      }
});
$("#skip-content").on("focusin", function(e){
  $(this).parent().removeAttr("style");
});
$("#skip-content").on("focusout", function(e){
  $(this).parent().attr("style", "position: absolute;top:-10000px;");
});

// Focus close button on ESC or 'b' or Arrow keys
/*$(document).on('keydown.modal-accessibility', function (e) {
	const $modal = $('.share_modal.vertical-align-center:visible').last();
	if (!$modal.length) return;

	const $closeBtn = $modal.find('[data-dismiss="modal"]').filter('[aria-label="Close"], [aria-hidden="true"]').first();

	if (['Escape', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {
		e.preventDefault();
		console.log("Key pressed2:", e.key);

		$closeBtn.focus();

		if (e.key === 'Escape') {
			$closeBtn.trigger('click'); // Triggers close
		}
	}
});*/
</script>
<script>
window.taxonomyDataLayer = [
    {
      "topFacet": "African Studies",
      "dataLayer": "content_african_studies"
    },
    {
      "topFacet": "Anthropology",
      "dataLayer": "content_anthropology"
    },
    {
      "topFacet": "Archaeology",
      "dataLayer": "content_archaeology"
    },
    {
      "topFacet": "Architecture",
      "dataLayer": "content_architecture"
    },
    {
      "topFacet": "Architecture & Interior Design",
      "dataLayer": "content_architecture_interior_design"
    },
    {
      "topFacet": "Art & Visual Culture",
      "dataLayer": "content_art_visual_culture"
    },
    {
      "topFacet": "Artists",
      "dataLayer": "content_artists"
    },
    {
      "topFacet": "Asia Studies",
      "dataLayer": "content_asia_studies"
    },
    {
      "topFacet": "Biblical Studies",
      "dataLayer": "content_biblical_studies"
    },
    {
      "topFacet": "Bloomsbury Art Markets Article Type",
      "dataLayer": "content_art_markets_article_type"
    },
    {
      "topFacet": "BP Ireland",
      "dataLayer": "content_bp_ireland"
    },
    {
      "topFacet": "BP Law",
      "dataLayer": "content_bp_law"
    },
    {
      "topFacet": "BP Scotland",
      "dataLayer": "content_bp_scotland"
    },
    {
      "topFacet": "BP Tax",
      "dataLayer": "content_bp_tax"
    },
    {
      "topFacet": "Business & Management",
      "dataLayer": "content_business_management"
    },
    {
      "topFacet": "Catalogue",
      "dataLayer": "content_catalogue"
    },
    {
      "topFacet": "Category",
      "dataLayer": "content_category"
    },
    {
      "topFacet": "Classical Studies",
      "dataLayer": "content_classical_studies"
    },
    {
      "topFacet": "Collection",
      "dataLayer": "content_collection"
    },
    {
        "topFacet": "Collections",
        "dataLayer": "content_collection"
    },
    {
      "topFacet": "Computer & Information Science",
      "dataLayer": "content_computer_information_science"
    },
    {
      "topFacet": "Content Type",
      "dataLayer": "content_type"
    },
    {
        "topFacet": "Type of Contents",
        "dataLayer": "content_type"
    },
    {
      "topFacet": "Counselling & Psychotherapy",
      "dataLayer": "content_counselling_psychotherapy"
    },
    {
      "topFacet": "Craft & Decorative Arts",
      "dataLayer": "content_craft_decorative_arts"
    },
    {
      "topFacet": "Crafts & Making",
      "dataLayer": "content_crafts_making"
    },
    {
      "topFacet": "Creator's place of origin",
      "dataLayer": "content_creator's_place_of_origin"
    },
    {
      "topFacet": "Criminology",
      "dataLayer": "content_criminology"
    },
    {
      "topFacet": "Date",
      "dataLayer": "content_date"
    },
    {
      "topFacet": "Design",
      "dataLayer": "content_design"
    },
    {
      "topFacet": "Design & Fashion",
      "dataLayer": "content_design_fashion"
    },
    {
      "topFacet": "Design and Making",
      "dataLayer": "content_design_and_making"
    },
    {
      "topFacet": "Digital Humanities & Digital Cultures",
      "dataLayer": "content_digital_humanities_and_cultures"
    },
    {
      "topFacet": "Discipline",
      "dataLayer": "content_discipline"
    },
    {
      "topFacet": "Doctrines",
      "dataLayer": "content_doctrines"
    },
    {
      "topFacet": "Document Type",
      "dataLayer": "content_document_type"
    },
    {
      "topFacet": "Drama & Performance Studies",
      "dataLayer": "content_drama_performance_studies"
    },
    {
      "topFacet": "Dress",
      "dataLayer": "content_dress"
    },
    {
      "topFacet": "Economics",
      "dataLayer": "content_economics"
    },
    {
      "topFacet": "Education",
      "dataLayer": "content_education"
    },
    {
      "topFacet": "Education Level",
      "dataLayer": "content_education_level"
    },
    {
      "topFacet": "Elements of interior design",
      "dataLayer": "content_elements_of_interior_design"
    },
    {
      "topFacet": "Engineering",
      "dataLayer": "content_engineering"
    },
    {
      "topFacet": "Environmental Studies",
      "dataLayer": "content_environmental_studies"
    },
    {
      "topFacet": "Fashion",
      "dataLayer": "content_fashion"
    },
    {
      "topFacet": "Fashion Business",
      "dataLayer": "content_fashion_business"
    },
    {
      "topFacet": "Film & Media",
      "dataLayer": "content_film_media"
    },
    {
      "topFacet": "Films",
      "dataLayer": "content_films"
    },
    {
      "topFacet": "Food",
      "dataLayer": "content_food"
    },
    {
      "topFacet": "Gender & Sexuality Studies",
      "dataLayer": "content_gender_sexuality_studies"
    },
    {
      "topFacet": "General Religion",
      "dataLayer": "content_general_religion"
    },
    {
      "topFacet": "Genres and forms",
      "dataLayer": "content_genres_and_forms"
    },
    {
      "topFacet": "Genres, Movements and Styles",
      "dataLayer": "content_genres_movements_and_styles"
    },
    {
      "topFacet": "Geography",
      "dataLayer": "content_geography"
    },
    {
      "topFacet": "Health & Wellbeing",
      "dataLayer": "content_health_wellbeing"
    },
    {
      "topFacet": "History",
      "dataLayer": "content_history"
    },
    {
      "topFacet": "History, theory and criticism",
      "dataLayer": "content_history_theory_and_criticism"
    },
    {
      "topFacet": "Ideologies and schools of thought",
      "dataLayer": "content_ideologies_schools_of_thought"
    },
    {
      "topFacet": "Image",
      "dataLayer": "content_image"
    },
    {
      "topFacet": "Interior construction and building systems",
      "dataLayer": "content_interior_construction"
    },
    {
      "topFacet": "Interior Design & Interior Architecture",
      "dataLayer": "content_interior_design"
    },
    {
      "topFacet": "International Development",
      "dataLayer": "content_international_development"
    },
    {
      "topFacet": "Language",
      "dataLayer": "content_language"
    },
    {
      "topFacet": "Law",
      "dataLayer": "content_law"
    },
    {
      "topFacet": "Library & Information Science",
      "dataLayer": "content_library_information_science"
    },
    {
      "topFacet": "Linguistics",
      "dataLayer": "content_linguistics"
    },
    {
      "topFacet": "Literary Studies",
      "dataLayer": "content_literary_studies"
    },
    {
      "topFacet": "Marine Engineering",
      "dataLayer": "content_marine_engineering"
    },
    {
      "topFacet": "Material type",
      "dataLayer": "content_material_type"
    },
    {
      "topFacet": "Materials",
      "dataLayer": "content_materials"
    },
    {
      "topFacet": "Mathematics & Statistics",
      "dataLayer": "content_mathematics_statistics"
    },
    {
      "topFacet": "Medical Humanities & Medical History",
      "dataLayer": "content_medical_humanities_and_history"
    },
    {
      "topFacet": "Middle East",
      "dataLayer": "content_middle_east"
    },
    {
      "topFacet": "Modern Languages",
      "dataLayer": "content_modern_languages"
    },
    {
      "topFacet": "Movements and Schools Of Thought",
      "dataLayer": "content_movements_schools_of_thought"
    },
    {
      "topFacet": "Music & Sound Studies",
      "dataLayer": "content_music_sound_studies"
    },
    {
      "topFacet": "Music Genres",
      "dataLayer": "content_music_genres"
    },
    {
      "topFacet": "Named individuals (non-fictional)",
      "dataLayer": "content_named_individuals"
    },
    {
      "topFacet": "Natural Sciences",
      "dataLayer": "content_natural_sciences"
    },
    {
      "topFacet": "Nursing & Health",
      "dataLayer": "content_nursing_health"
    },
    {
      "topFacet": "Objects",
      "dataLayer": "content_objects"
    },
    {
      "topFacet": "Organizations and Design Houses",
      "dataLayer": "content_organizations_and_design_houses"
    },
    {
      "topFacet": "Peer-Reviewed",
      "dataLayer": "content_peer-reviewed"
    },
    {
      "topFacet": "People",
      "dataLayer": "content_people"
    },
    {
        "topFacet": "People and Organisations",
        "dataLayer": "content_people"
    },
    {
      "topFacet": "Peoples, Cultures and Religions",
      "dataLayer": "content_peoples_cultures_and_religions"
    },
    {
      "topFacet": "Period (first performed)",
      "dataLayer": "content_period_first_performed"
    },
    {
      "topFacet": "Period featured",
      "dataLayer": "content_period_featured"
    },
    {
      "topFacet": "Period",
      "dataLayer": "content_period"
    },
    {
      "topFacet": "Periods",
      "dataLayer": "content_period"
    },
    {
      "topFacet": "Philosophy",
      "dataLayer": "content_philosophy"
    },
    {
      "topFacet": "Photography",
      "dataLayer": "content_photography"
    },
    {
      "topFacet": "Place",
      "dataLayer": "content_place"
    },
    {
      "topFacet": "Places",
      "dataLayer": "content_place"
    },
    {
       "topFacet": "Place Featured",
       "dataLayer": "content_place"
    },
    {
      "topFacet": "Plays",
      "dataLayer": "content_plays"
    },
    {
      "topFacet": "Playwrights",
      "dataLayer": "content_playwrights"
    },
    {
      "topFacet": "Politics & International Relations",
      "dataLayer": "content_politics_international_relations"
    },
    {
      "topFacet": "Practice subject",
      "dataLayer": "content_practice_subject"
    },
    {
      "topFacet": "Practitioner roles",
      "dataLayer": "content_practitioner_roles"
    },
    {
      "topFacet": "Primary text",
      "dataLayer": "content_primary_text"
    },
    {
      "topFacet": "Principles and approaches",
      "dataLayer": "content_principles_and_approaches"
    },
    {
      "topFacet": "Professional and business practice",
      "dataLayer": "content_business_practice"
    },
    {
      "topFacet": "Psychology",
      "dataLayer": "content_psychology"
    },
    {
      "topFacet": "Race & Ethnicity Studies",
      "dataLayer": "content_race_ethnicity_studies"
    },
    {
      "topFacet": "Referencing Style",
      "dataLayer": "content_referencing_style"
    },
    {
      "topFacet": "Referencing Topic",
      "dataLayer": "content_referencing_topic"
    },
    {
      "topFacet": "Religion",
      "dataLayer": "content_religion"
    },
    {
      "topFacet": "Religious Studies",
      "dataLayer": "content_religious_studies"
    },
    {
      "topFacet": "Representing space: Drawing, Modelling and CAD",
      "dataLayer": "content_representing_space"
    },
    {
      "topFacet": "Research fields",
      "dataLayer": "content_research_fields"
    },
    {
      "topFacet": "Research Methods",
      "dataLayer": "content_research_methods"
    },
    {
      "topFacet": "Schools, Movements, Styles",
      "dataLayer": "content_schools_movements_styles"
    },
    {
      "topFacet": "Science & Technology",
      "dataLayer": "content_science_technology"
    },
    {
      "topFacet": "Setting",
      "dataLayer": "content_setting"
    },
    {
      "topFacet": "Social Work & Social Welfare",
      "dataLayer": "content_social_work_social_welfare"
    },
    {
      "topFacet": "Sociology",
      "dataLayer": "content_sociology"
    },
    {
      "topFacet": "Sources",
      "dataLayer": "content_sources"
    },
    {
      "topFacet": "Special Features",
      "dataLayer": "content_special_features"
    },
    {
      "topFacet": "Sport & Exercise",
      "dataLayer": "content_sport_exercise"
    },
    {
      "topFacet": "Sport / Activity",
      "dataLayer": "content_sport_or_activity"
    },
    {
      "topFacet": "Study Skills",
      "dataLayer": "content_study_skills"
    },
    {
      "topFacet": "Subject",
      "dataLayer": "content_subject"
    },
    {
        "topFacet": "Subjects",
        "dataLayer": "content_subject"
    },
    {
      "topFacet": "Supplier",
      "dataLayer": "content_supplier"
    },
    {
      "topFacet": "Textiles",
      "dataLayer": "content_textiles"
    },
    {
      "topFacet": "Textiles, Materials and Colors",
      "dataLayer": "content_textiles_materials_and_colors"
    },
    {
      "topFacet": "The Design Industry",
      "dataLayer": "content_the_design_industry"
    },
    {
      "topFacet": "Themes",
      "dataLayer": "content_themes"
    },
    {
      "topFacet": "Theology",
      "dataLayer": "content_theology"
    },
    {
      "topFacet": "Topic",
      "dataLayer": "content_topic"
    },
    {
        "topFacet": "Topics",
        "dataLayer": "content_topic"
    },
    {
      "topFacet": "Types of History",
      "dataLayer": "content_types_of_history"
    },
    {
      "topFacet": "UN Sustainable Development Goals",
      "dataLayer": "content_unsustainable_development_goals"
    }
  ];
</script><script type="text/javascript">
	function googleAnalyticsPageLoad(options) {
		var dataLayerObj = {};
		dataLayerObj.event = 'page_load';
		//Customer Related
					dataLayerObj.authentication_status = 'not logged in';
				//Page Related
					dataLayerObj.page_type = "cms";
				dataLayerObj.product_id = "hklp";
		dataLayerObj.product_name = "Human Kinetics Library Platform";
		dataLayerObj.platform = "Human Kinetics Library Platform";
				dataLayerObj.product_id = "hklskill";
				        dataLayerObj.product_name = ('Human Kinetics Sports Skills').split("~!").join("'");
				
		if (options) {
			for (member in options) {
				dataLayerObj[member] = options[member];
			}
		}
		dataLayer.push(dataLayerObj);
	}
</script>



<div class="main-container">
<header class="bs-docs-nav navbar header-layout header-temp1">		<div class="top-header">		<div class="container">			<div class="hidden-xs">									<div class="pull-left mt10">						<div class="social-icons">							<ul role="menu">															</ul>						</div>					</div>							</div>			<!-- social Icons for mobile devices starts-->			<div class="visible-xs">									<div class="pull-left">						<div class="social-icons">							<ul role="menu">															</ul>						</div>					</div>							</div>			<!-- social Icons for mobile devices ends-->			<div class="pull-right user-details">								

		<div class="header-dropdown dropdown inline-disp " id="checkForLogout">
		<a href="login?recentUrl=/encyclopedia-chapter?docid=b-9781718219342&tocid=b-9781718219342-chapter14" title="Login">						
			<img src="/bloomsbury_assets/bloomsbury/images/signin_icon.png" alt="" title=""> 
			<span tabindex="0" aria-label="Log In">Log In</span>
		</a>
	</div>
				</div>		</div>	</div>				<div class="btm-header">		<div class="container">						<div class="navbar-header"> 				<button aria-controls="bs-navbar" aria-expanded="false" class="collapsed navbar-toggle" data-target="#bs-navbar" data-toggle="collapse" type="button"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> 				</button>					<span class="navbar-brand zero-leftpad single-logo">						<a href="home"><img src="https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" class="img-responsive" alt="Human Kinetics Library Logo" title="Human Kinetics Library Logo"></a>					</span>					<span class="navbar-brand single-logo">											</span>					<div class="hidden-md hidden-lg mob-search-icon">					<a href="javascript:;"><img src="/bloomsbury_assets/bloomsbury/images/search-icon-gray.png" class="img-responsive mob-search"  aria-label="Search Button" tabindex="0"/></a>				</div>					</div>									<nav class="collapse navbar-collapse" id="bs-navbar">				<span class="bpm-menu-close hidden-lg hidden-md">X</span>				<ul  role="navigation" aria-label="Main" class="nav navbar-nav">								                    	<li class="" role="listitem"><a tabindex="0" aria-label="Home" href="/home">Home</a></li><li class="dropdown " role="listitem"><a tabindex="0" href="#" data-toggle="dropdown" class="dropdown-toggle" aria-label="Explore By" aria-expanded="false">Explore By</a><ul class="dropdown-menu" role="list" aria-label="Explore By"><li role="presentation"><a role="listitem" tabindex="0" href="/taxonomy?id=sportandActivities" title="Sport / Activity" aria-label="Sport / Activity">Sport / Activity</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/taxonomy?id=topic" title="Topic" aria-label="Topic">Topic</a></li></ul> </li><li class="dropdown " role="listitem"><a tabindex="0" href="#" data-toggle="dropdown" class="dropdown-toggle" aria-label="Browse Collections" aria-expanded="false">Browse Collections</a><ul class="dropdown-menu" role="list" aria-label="Browse Collections"><li role="presentation"><a role="listitem" tabindex="0" href="/human-kinetics-library-core-collection" title="Human Kinetics Library Core Collection" aria-label="Human Kinetics Library Core Collection">Human Kinetics Library Core Collection</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/human-kinetics-dance-technique" title="Human Kinetics Dance Technique" aria-label="Human Kinetics Dance Technique">Human Kinetics Dance Technique</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/physical-and-health-education" title="Human Kinetics Physical and Health Education" aria-label="Human Kinetics Physical and Health Education">Human Kinetics Physical and Health Education</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/healthcare-in-sport-and-exercise" title="Human Kinetics Health Care in Sport and Exercise" aria-label="Human Kinetics Health Care in Sport and Exercise">Human Kinetics Health Care in Sport and Exercise</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/sports-skills" title="Human Kinetics Sports Skills" aria-label="Human Kinetics Sports Skills">Human Kinetics Sports Skills</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/strength-and-conditioning" title="Human Kinetics Strength and Conditioning" aria-label="Human Kinetics Strength and Conditioning">Human Kinetics Strength and Conditioning</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/category-list?docid=Ebooks" title="Browse All Ebooks" aria-label="Browse All Ebooks">Browse All Ebooks</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/category-list?docid=Video" title="Browse All Video" aria-label="Browse All Video">Browse All Video</a></li></ul> </li><li class="dropdown " role="listitem"><a tabindex="0" href="#" data-toggle="dropdown" class="dropdown-toggle" aria-label="About" aria-expanded="false">About</a><ul class="dropdown-menu" role="list" aria-label="About"><li role="presentation"><a role="listitem" tabindex="0" href="/about-human-kinetics-library" title="About Human Kinetics Library" aria-label="About Human Kinetics Library">About Human Kinetics Library</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/editorial-advisory-board" title="Editorial Advisory Board" aria-label="Editorial Advisory Board">Editorial Advisory Board</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/featured-content" title="Featured Content" aria-label="Featured Content">Featured Content</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/reviews" title="Reviews" aria-label="Reviews">Reviews</a></li><li role="presentation"><a role="listitem" tabindex="0" href="/about-human-kinetics" title="About Human Kinetics" aria-label="About Human Kinetics">About Human Kinetics</a></li></ul> </li><li class="" role="listitem"><a tabindex="0" aria-label="Librarians" href="/librarians">Librarians</a></li>                    							</ul>			</nav>					</div>			</div>		<div class="clearfix"></div></header></div>
<div class="modal fade" id="session-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static" data-keyboard="false">
    <div class="vertical-alignment-helper">
		<div class="modal-dialog session-modal vertical-align-center" role="document">
			<div class="modal-content">
				<div class="modal-body">
										 	<h2>Alert</h2>
						<p id="session-prompttext">Your session is about to expire! You will be logged out in </p>
						<div id="time" class="text-center session-time">10:00</div>
						<p id="session-promptconfirm" tabindex="0" aria-labelledby="session-promptconfirm"> Do you wish to stay logged in?</p>
						<input type="button" value="Yes, keep me logged in" class="primary_btn clear-btn" id="session-login">
						<input type="button" value="No, log me out" id="session-logout" class="secondary_btn">
									</div>
			</div>
		</div>
	</div>	
</div>

     
     


<script type="text/javascript">
    function search(request, response) {
	var siteName="hklp";
    var langCode ="en";     
	var country = "$territory";
	searchContent = request.term.replace("/", "~");
	    var predicitivexmlreq = new XMLHttpRequest();
	 
        predicitivexmlreq.open("GET","/api/searchresult/searchPredictive/"+searchContent+"/"+siteName+"/"+langCode+"/"+country,true);
 
		
        predicitivexmlreq.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        predicitivexmlreq.send();
	    predicitivexmlreq.onreadystatechange = function() {
        if (predicitivexmlreq.status == 200 ) {
            if(searchContent.replace(/\s/g, "").length>2) {
                var predicitivedata = predicitivexmlreq.response;
                var predicitivedataString = jQuery.parseJSON(predicitivedata);
            }else{
		        predicitivedataString="";
            }
		    response(predicitivedataString);
			 
            }
        }
    }
 
  $(document).ready(function() {
    try {
	$("#global_searchbox").autocomplete({
	    source: search,
        minLength: 1,
        select: function( event, ui ) {
            showProgress();
            localStorage.setItem("selectedCheckBoxItem", null);
            localStorage.setItem("EnabledCheckBoxs",false);
            var text=ui.item.value;
            if(text.trim().length>0){
                var url=window.location.protocol+'//'+window.location.host+'/search-results?any='+text;
                window.location.href=url;
            }
        },
        open: function (event, ui) {
            if (navigator.userAgent.match(/(iPod|iPhone|iPad)/)) {
                $('.ui-autocomplete').off('menufocus hover mouseover mouseenter');
            }
        }
	});
	$.ui.autocomplete.prototype._renderItem = function (ul, item) {
	item.label = item.label.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)(" + $.ui.autocomplete.escapeRegex(this.term) + ")(?![^<>]*>)(?![^&;]+;)", "gi"), "<strong>$1</strong>");
	return $("<li></li>")
                    .data("item.autocomplete", item)
                    .append("<a>" + item.label + "</a>")
                    .appendTo(ul);
    };

    $(document).on('touchstart', '.ui-autocomplete a',function(e){
        $("#global_searchbox").data('ui-autocomplete')._trigger('select', 'autocompleteselect', {item:{value:$(this).text()}});
    });

    } catch (e) {}
  });

</script>





<div class="search" style="text-align: left; background: none;">
	<div class="container">
		<div class="advanced_keyboard">
							<input type="text" name="search_text"  id="global_searchbox" title="Enter text to search" placeholder="Search Human Kinetics Library Platform" value='' autocomplete="off" class="">
			            			<input id="global_searchbtn" type="submit" class="disabled-btn" title="Search Icon">		</div>
        	</div>
   <!--search ends-->
</div>



<script>
    $("#global_searchbox").on("change", function(){
        if ($(this).val().length > 0) {
            $("#global_searchbtn").removeClass('disabled-btn');
        } else {
            $("#global_searchbtn").addClass('disabled-btn');
        }
    });
</script>		

    

	
			


	
<script type="text/javascript">
	$(document).ready(function(){
		var navigationList = $("header li.dropdown");
		navigationList.each(function(){
			var dropdownList = $(this).find(".dropdown-menu li");
			if (dropdownList.length == 0) {
				$(this).addClass('hide');
			}
		});
		
	 $('.navbar-collapse li a').on('click', function(e){
	     var protocol = "https://";
		 var domainname = window.location.host;
 		 var host = window.location.href;
  		 var parent=$(this).parent().parent();   		 
   		 var interactiontype = "parent";
   		 var sibling= "";
   		 var linkurl = "";
   		 var hrefValue = $(this).attr('href');   		  
         if (parent.hasClass('dropdown-menu'))
	   	 {
	   	   if(hrefValue.includes("/")){
	   	   linkurl = protocol+domainname+hrefValue;
	   	   }
	   	   else
	   	   {
	   	    linkurl = protocol+domainname+"/"+hrefValue;
	   	   }
		   interactiontype = "child";
		   sibling=parent.prev().text()+ " > "+$(this).text();
	  	  }	  	 
		 else
		 {
		   sibling = $(this).text();
		   hrefValue = '';  
		   linkurl = "";
		 }
		 var idattrvalue = $(this).attr('title');
		 if(idattrvalue == undefined){
			 idattrvalue = "";
		 }		
		 if(hrefValue== "#")
		 {
		  hrefValue = '';
		 }
		 const navObj = {};			 
		 navObj.event= 'click_nav_link'
		 navObj.link_classes = $(this).attr('class')
		 navObj.link_domain = domainname
		 navObj.link_id = idattrvalue
		 navObj.link_text = $(this).text()
		 navObj.link_url= linkurl
		 navObj.link_breadcrumb = sibling
		 navObj.interaction_type = interactiontype
		 console.log(navObj);
		 dataLayer.push(navObj);
           });
		$("header nav>ul>li:visible:last a").css("background-image", "none");
	});
	navbarPadding();
	$(window).resize(function(){
		navbarPadding();
	});
	function navbarPadding(){
		var navbarHeight=0;
		if ($("nav .navbar-nav>li").length > 0) {
			var heights = $("nav .navbar-nav>li").map(function ()
			    {
			        return $(this).height();
			    }).get();

			navbarHeight = Math.max.apply(null, heights);
		}
		if (navbarHeight > 50) {
			$("nav.navbar-collapse").css("padding-top", "21px");
		} else {
			$("nav.navbar-collapse").css("padding-top", "40px");
		}	
	}
	var loginEvent = $.cookie("LoginEvent");
	if (loginEvent == "true") {
		dataLayer.push({
			'event' : 'login',
			'method' : '$session.getAttribute("BB-LOGGEDIN-TYPE")'
		});
		$.cookie("LoginEvent", "false");
	}
</script>
			
	









						<div class="container oops hide error-div" id="error-div">
	<div class="row">
		<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
			<div class="error-oops">
				<p tabindex="0" aria-labelledby="lorem-dummy" class="text-center">We're sorry, but that page can’t be found.</p>
				<p tabindex="0" aria-labelledby="lorem-dummy" class="text-center">Please visit our Home page or try using the Search, Explore or Browse links above to find what you are looking for.</p>
			</div>				
			<img src="/bloomsbury_assets/hklp/images/error_img.png" class="img-responsive" alt="Error Image" tabindex="0"/>
		</div>
	</div>
</div>				<div class="hide" >
		



		<div id="login-left-hidden" class="col-lg-5 col-md-5 col-sm-12 col-xs-12 login_left">
	<h1 tabindex="0" aria-label="Log in to hklp">Log in to Human Kinetics Library Platform</h1>
   	<form id="loginform" class="form-horizontal signin-form" role="form" method="post">
    	<span class="err-msg hide" id="loginerr" tabindex="0" aria-label="Incorrect username or password. Please try again.">Incorrect username or password. Please try again.</span>
		<div class="form-group">
						<button id="instloginbtn" type="button" class="btn btn-primary "  aria-hidden="false" aria-label="Login via your institution" >Login via your institution</button>
					</div>
			    	<h2>Shibboleth / Open Athens </h2>
	    	    <hr style="border-bottom: 2px solid #ccc;"></hr>
	    <h2>Log in here if you have a username and password</h2>
	    <div class="form-group">
	         <label for="login-username" tabindex="0" aria-label="Username">Username</label>
	         <input type="text" id="login-username" class="form-control signin-form" name="login-username" placeholder="Enter username provided by your institution" value="" method="post" autocomplete="off">
	    </div>
      	<div class="form-group">
      		<label for="login-password" tabindex="0" aria-label="Password">Password</label>
         	<input type="password" id="login-password" class="form-control signin-form password-type" name="login-password" placeholder="Enter password provided by your institution" value="" method="post" autocomplete="off">
        </div>
      	<div class="form-group">
      		<button id="loginbtn" type="button" class="btn btn-primary disabled-btn" aria-hidden="false" aria-label="Login" >Login</button>
   		</div>
    </form>
    <form id="libraryloginform" class="form-horizontal signin-form" role="form" method="post">
    	<h2 tabindex="0" aria-label="OR log in with your library card">Or log in with your library card</h2>
    	<span class="err-msg mt20 hide" id="libraryloginerr" tabindex="0" aria-label="Library card number not recognised. Please try again.">Library card number not recognised. Please try again.</span>
    	<div class="form-group">
    		<label for="login-librarycard" tabindex="0" aria-label="Library Card Number">Library Card Number</label>
    		<input type="text" id="login-librarycard" class="form-control signin-form" name="librarycard" placeholder="Enter library card number" value="" method="post" autocomplete="off">
    	</div>
    	<div class="form-group">
    		<button id="libraryloginbtn" type="button" class="btn btn-primary disabled-btn" aria-hidden="false" aria-label="Login" >Login</button>
      </div>
   </form>
</div>	</div>
<script language="javascript">
var contenttype = {
    init: function(options) {
        var self = this;
        this.type = options.type;
        this.docid = options.docid;
        this.tocid = options.tocid;
                this.actid = "";
                this.dispName = options.dispName;
                this.title = $("#title");
        this.login = $("#login");
        this.articleRight = $(".article_right");
        this.mainContainer = $('.content_container,.screenplay_content');
        this.mainArticleContainer = $('.container.article_template');
        this.buyItem = $("#buy-item");
        this.buyLeft = $("#buy-left");
        this.downloadtable = $(".table-download");
        this.downloadimage = $(".image-download");
        this.tablemodal = $("#table-modal");
        this.imagemodal = $("#image-download-modal");
                        this.imageRight = $(".image_right");
                                        this.searchencbtn = $("#srch-enc-btn");
        this.searchencinput = $("#srch-enc");
                        this.truncateContainer = $(".desc-museum-truncation");
        this.buildingGallery = $(".building_galley");
        this.titleTrunk = $(".title_trunk");
        this.authorTrunk = $(".author_trunk");
        this.popoverHide = $('.cat_tab2, #vol-originalTitle');
        this.accordianPanel = $('#accordion-panel');
        this.gotopagebtn = $('#goto_pagenobtn');
        this.gotopageinput = $('#goto_pageno');
                                                this.squidFlag = true;
                this.contentImageSlider = $(".playtext-image-slider");
                try {
            this.setTitle();
            this.setMainHeadingForScreenReader();
            if (this.login.length > 0) {
                this.setLoginLink();    
            }
            relatedContent(options.relid, options.lang, options.site, options.type, options.territory, this);
            this.relatedMediaandContentsonKeyAction();
                                    if (options.clientLocation) {
                this.toggleBuyButton(options.clientLocation);
            }
                                    this.createArticleReference();
                        this.pageNumbersInit();
            this.createMutationObserver();
                                                                                                this.initPdfViewer();
                                                this.getViewAndDownloadCount();
                                                this.imageDownloadEnable();
                        this.truncateDescription();
                        this.markTerms();
                        this.addResponsiveImageClass();
            viewmoreLink();
                        $.cloudinary.responsive();
            this.subjectsviewmore();
                                    this.externalLinkAlert();
                                    this.initGlossaryPopup();
            this.viewMoreToC();
                        this.addListenerForPrintDownload();
            this.showRecentlyViewed();
            setTimeout(function(){
                self.doHashScroll();
            }, 1000);
                                                this.createPdf();
                        //this.createFrame();
                                    this.bindDocumentPageEventListeners();
                                                                        this.initAuthorBioPopup();
            if (this.contentImageSlider.length > 0) {
                this.loadImageSlider();
            }
            this.imageViewerFullScreenKeyup();
            this.imageViewerControlIconsFocus();
                                                this.sendCounterData();
            this.loadStarJS();
                                    this.sendSquidData();
                                                this.registerRecentlySquidEvents();
            this.registerReferenceSquidEvents();
                                    this.removeDownloadIcon();
                        			            this.blankTargetVulnerabilityFix();
            this.googleAnalyticsTrack();
            this.initCounterUrl();
            this.initDownloadPdfTooltip();
            this.seektimeinfo();
                      	this.hideImage();
         
           				            this.cancelevent();
            this.dotsDivWithPageno();
            this.monoListLinkEnable();
                        this.playDictSearch();
        } catch (err) {
            console.log("Error in init function::", err);
        }
    },
     seektimeinfo: function () {
     $('.seektime-button').on('click', function() {
      let accountId = $("#bbplayer").data("account");
        let playerId = $("#bbplayer").data("player");
         function parseTime(time) {
            const parts = time.split(':');
            return parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);
        }
        let player = videojs.getPlayers(playerId); 
        let timeValue = $(this).find('.seektimeframe').val();
        let seconds = parseTime(timeValue);
        player.bbplayer.currentTime(seconds); 
         player.play();
        
    });
},
    hideImage: function () {
		$("#coverImageUrl").on('error', function() {       
	        if ($(this).parent().text()) {
                $(this).addClass('hide');
                $(this).parent().removeClass('hide');
            } else {
                $(this).parent().addClass('hide');
            }

	    }).on('load', function() {
	        $(this).parent().removeClass('hide');
            $(this).removeClass('hide');
	    });
    },
    

	cancelevent: function () {
	$(document).on('click', '#btn-cancel', function() {
    	$('#fullscreen-clip-save-modal').remove();
 	    $('#fullscreen-clip-save-success').remove();
 		$('.vua-close-button').click();
 		$('.vua-clip-button').click();
 	});
  },
 
  dotsDivWithPageno :function(){
    $('li.mono-list,div.mono-list').each(function() {
    var tagName = $(this).prop('tagName').toUpperCase();
    var firstLink = $(this).find('.dots_div a').first(); 
    var secondLink = $(this).find('span a').first(); 
    
    if (firstLink.length ) {
      var chapterTitle = firstLink.text().trim(); 
      var pageNumbers = secondLink.text().trim(); 
      var pageNumberSpan;
      if(tagName==='LI'){
        pageNumberSpan = $('<span aria-hidden="true" class="page-num"></span>').text(pageNumbers);
      }
      else{
        pageNumberSpan = $('<span aria-hidden="true" class="page-num toc-num"></span>').text(pageNumbers);
      }
      var ariaLabel = chapterTitle + ", page " + pageNumbers;
      firstLink.attr('aria-label', ariaLabel);
      secondLink.remove();
      firstLink.closest('div').after(pageNumberSpan);
        $(this).find('span').each(function() {
        if(!$(this).hasClass('glyphicon')){
        if (!$(this).text().trim()) {
          $(this).remove();
        }
        }
      });
      
    }
  });
  
  },
    
  	monoListLinkEnable :function() {
	 $('div.mono-list div.dots_div, li.mono-list').click(function (event) {
        window.location.href = $(this).find("a").attr("href");
    });	
     $('div.mono-list, li.mono-list').keydown(function (event) {
        if (event.keyCode === 13) { 
            window.location.href = $(this).find("a").attr("href");
        }
  	  });
	},	
  

  
    getHtmlContent: function(contentType, cachetype) {
        window.analyticsFlag = true;
        try {
            var self = this;
            var lang = 'en';
                        var privacyPolicy = "";
                                    var docId = "b-9781718219342";
                                    var tocId = "b-9781718219342-chapter14";
                        var relId = tocId;
            var studioId = "";
                                    var site = 'hklp';
            var territoryFlag = true;        
                        var data = {
                tocId : tocId,
                contentType : contentType,
                docId : docId,
                cachepagetype : cachetype,
                privacyPolicy :privacyPolicy,
                debug : ""
            };
                        data.sourceXML = "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml";
                                    data.sourceXSL = "/content-types/encyclopedia/chapter.xsl";
                                    data.lang = "en";
                                    data.hideDetail = "";
                                    data.pgno = "";
                                    data.partid = "";
                                    data.docIdS = "b-9781718219342-chapter14";
                                    data.docIdF = "b-9781718219342-chapter14";
                                                                        var expr = /^[a-zA-Z0-9-_.]+$/;
            var docIdSanity = docId?((~docId.indexOf(">") || ~docId.indexOf("<"))? false : true):true;
            var tocIdSanity = tocId?((~tocId.indexOf(">") || ~tocId.indexOf("<"))? false : true):true;
                        if (docIdSanity && tocIdSanity) {
                showAjaxLoader('#mycontent');
                $.ajax({
                    url: "/app/gethtmlcontent",
                    type: 'POST',
                    data: data,
                    dataType: "html",
                    success: function(responseText, status, xhr) {
                        hideProgress();
                        hideAjaxLoader('#mycontent');
                                                if (responseText && xhr.status == 200 && territoryFlag) {
                            if (~responseText.indexOf("mml:")) {
                                responseText = responseText.replaceAll("mml:", "");
                            }
                            $('#mycontent').append(responseText);
                            $('.emptytest').remove();
                            var options = {
                                docid: docId,
                                tocid: tocId,
                                type: contentType,
                                dispName: "Human Kinetics Library Platform",
                                relid: relId,
                                lang: lang,
                                site: site,
                                territory: "$territory",
                                cache: cachetype,
                                clientLocation: "",
                                pageLink: "/encyclopedia-chapter?docid=b-9781718219342&tocid=b-9781718219342-chapter14",
                                actid: "$actId",
                                studioid: studioId
                            }
                            self.init(options);
                        } else if (!territoryFlag) {
                            $('#mycontent').addClass('hide');
                            $('#territory-restricted').removeClass('hide');
                        } else {
                            $('#mycontent').addClass('hide');
                            $('#error-div').removeClass('hide');
                        }
                    },
                    error: function(error) {
                        hideProgress();
                        hideAjaxLoader('#mycontent');
                        $('#mycontent').addClass('hide');
                        $('#error-div').removeClass('hide');
                    }
                });
            } else {
                $('#mycontent').addClass('hide');
                $('#error-div').removeClass('hide');
            }
                    } catch (err) {
            console.log("Error in getHtmlContent function::", err);
        }
    },
    bindDocumentPageEventListeners: function() {
        var self = this;
        try {
            $(document).on('keydown', this.printPreview);
                       		$("#print_page_pre").on('click' , function(e) {self.showPrintDialog(e, self)});
           	           	$("#catalogue_download").on('click', function(e) {
        		var flag=true;
        		var download = $("#download-catalog");
        		download.find(".err-msg").addClass("hide");
        		var total = parseInt($("#imageIds").val().split("~").length);
        		var downloadTo = parseInt($("#download-to").val());
        		var downloadFrom = parseInt($("#download-from").val());
        		var selected = downloadTo-downloadFrom+1;
        		if($("#range-download").is(":checked")){
        			if(downloadTo=="" || downloadFrom==""){
        				download.find(".fromto-missing").removeClass("hide");
        				flag=false;
        			}
        			else if(downloadTo<=downloadFrom){
            			$(".fromto-invalid").removeClass("hide");
            			flag=false;
            		}
        			else if(downloadFrom>total || downloadTo>total || downloadFrom<=0 || downloadTo<=0 || selected>25){
            			download.find(".available-limit").text("Select between 1 to "+total+". You can select a maximum of 25 images.");
            			download.find(".available-limit").removeClass("hide");
            			flag=false;
            		}
        		}
        		if(flag){
        		var currenthref = $("#download").attr('href');
        			if(currenthref.indexOf("&downloadType")>-1){
        				currenthref= currenthref.split("&downloadType")[0];
        			}
        			var downloadType=$('input[name="download-type"]:checked').val();
        	        var imageUrls = $("#buildprevimagelist").val().split("~");
        	        var selectedImages="";
        	        for(var i=downloadFrom-1; i<downloadTo; i++){
        	        	if(selectedImages==""){
        	        		selectedImages=imageUrls[i];
        	        	}else{
        	        		selectedImages+="~"+imageUrls[i];
        	        	}
        	        }
        			currenthref+="&downloadType="+downloadType;
        			currenthref+="&selectedImages="+selectedImages;
        			$("#download").attr('href',currenthref);
        			$("#allowDownload").val("true");
        			$("#download").get(0).click();
        		}
        	});
           	$(document).on('click',".professional_download", function(e) {
           		$(this).removeClass("no-focus");
        		let currenthref = $("#download").attr('href');
        		if(currenthref.search("&xsltWordPath") > 0){
        			currenthref = currenthref.substring(0,currenthref.search("&xsltWordPath"));
        		}
        		let downloadType = $(this).attr("class").split(" ").pop();
        		let pdfPresent = $(".pdf-content").length > 0;
        		let wordPresent = $(".word-content").length > 0;
				let fileName = pdfPresent?$(".pdf-file-name").val():$(".word-file-name").val();
				let fileType;
				if(fileName){
	               	fileName = ~fileName.indexOf("/")?fileName.split("/")[1]:fileName;
    	            fileType = fileName.split(".")[1];
				}
        		let download = true;
        		let isEmbedded = false;
           		switch(downloadType){
           			case "leg-download" : break;
           			case "word-download" : currenthref +="&xsltWordPath=" + "$xslDownloadWordPath";download=true; break;
           			case "embedded-download" :	if(pdfPresent){
                       								currenthref = "/app/printPdfDownload?chapterPdfId=" +fileName+ "&source=cloudinary"+ "&downloadType="+fileType+"&documentId=" + "b-9781718219342"+"&downloadFrom=download";
                       								isEmbedded = true;
           										}else if(wordPresent){
           											currenthref = "/app/printPdfDownload?id=" +fileName+ "&source=cloudinary"+ "&downloadType="+fileType+"&documentId=" + "b-9781718219342"+"&downloadFrom=download";
           											isEmbedded = true;
           										}else{
           											currenthref +="&xsltWordPath=" + "$xslDownloadWordPath";download=true; break;
           										}
           										break;
           			case "notes-download" : currenthref+="&notesOnly="+true; break;
           		}
           		if(download){
           			if(!isEmbedded){
	           			$("#allowDownload").val("true");
		       			$("#download").attr('href',currenthref);
		       			$("#download").get(0).click();
           			}else{
           				$("#embedded-download-url").attr('href',currenthref);
		       			$("#embedded-download-url").get(0).click();
		       			$("#download-professional").modal("hide");
           			}
           		}
        	});
            this.downloadtable.on('click', function(e) {self.showTableModal(e, self, this)});
            this.downloadimage.on('click',  function(e) {self.showImageModal(e, self, this)});
            this.imagemodal.on('hidden.bs.modal', this.onHiddenImageModal);
            this.tablemodal.on('hidden.bs.modal', this.onHiddenTableModal);
            this.tablemodal.on('shown.bs.modal', function() {self.onShowTableModal(self, this)});
            this.imageRight.on("load", function(){self.imageCaptionWidth()});
                                                            this.searchencbtn.on('click', function(e) {self.searchWithinEnc(self)});
            this.searchencinput.on('keyup', function(e) {self.searchWithinEncInputKeyup(e, self)});
                                                            this.bindDocumentCollapseEvents();
            this.accordianPanel.off().on('keypress click', this.accordianPanelCollapseAll);
            this.gotopagebtn.on('click', this.goToPageClick);
            this.gotopageinput.on('keyup', this.goToPageKeyUp);
                                            } catch (err) {
            console.log("Error in bindDocumentPageEventListeners function::", err);    
        }
    },
    removeDownloadIcon: function() {
        $('#collapseAbstractExtract a').attr("style","pointer-events:none; color: black !important");
        $('#collapseAbstractExtract a .footnote').remove();
        $('#collapseAbstractExtract a.accordion-toggle').css({"pointer-events":"auto"});
        $('#collapseAbstractExtract p').last().append("...");
        var openAcc = $(".open-access").length;
        var loggedIn = "$userLoggedIn";
        if(openAcc > 0){
            if(loggedIn=="true"){
                $("#download").parent().removeClass("hide");
            } else {
                if(openAcc > 0) {
                    $("#download").parent().removeClass("hide");
                } else{
                    $("#download").parent().addClass("hide");    
                }
            }
        } else{
            if(loggedIn!="true") {
                  $("#download").parent().addClass("hide");
            }    
        }
    },
        toggleBuyButton: function(clientLocation){
        try {
            if (this.buyItem.length > 0) {
                var buyItemCountry = "#buy-item-"+clientLocation;
                if ($(buyItemCountry).length > 0 || $("#buy-item-default").length > 0) {
                    var buyLink = $(buyItemCountry).val() || $("#buy-item-default").val();
                      this.buyItem.attr("href", buyLink);
                    this.buyItem.attr("target", "_blank");
                    var buyItemText = buyLink.replace(/^(?:https?:\/\/)?(?:www\.)?/i, '');
                    this.buyItem.text(buyItemText);
                    this.buyItem.parent().removeClass('hide');
                    this.buyItem.parent().prev().removeClass('hide');
                    this.buyLeft.removeClass('hide');
                } else {
                    this.buyItem.attr("href", "javascript:void(0);");
                    this.buyItem.removeAttr("target");
                    this.buyItem.text("");
                    this.buyItem.parent().addClass('hide');
                    this.buyItem.parent().prev().addClass('hide');
                    this.buyLeft.addClass('hide');
                }
            }
        } catch (err) {
            console.log("Error in toggleBuyButton function::", err);    
        }
    },
        printPreview: function(e) {
        try {
            var isMac = navigator.platform.indexOf('Mac') >= 0;
            var isWin = navigator.platform.indexOf('Win') >= 0;
            if (e.keyCode == 80 && ((e.ctrlKey && isWin) || (e.metaKey && isMac))) {
                e.preventDefault();
                $("#print_page_pre").click();
            }
        } catch (err) {
            console.log("Error in printPreview function::", err);    
        }
    },
    showPrintDialog: function(e , self) {
        try {
            if ($("#printFrame").length == 0) {
                $("#print-dialog").modal("show");
                self.createFrame();
            } else {
            	$("#print-dialog").find(".print_page").click();
            }
           dataLayer.push({
			'event' : 'content_print'
			});
        } catch (err) {
            console.log("Error in showPrintDialog function::", err);    
        }
    },
    showPrintCatalog: function(e , self) {
        try {
        	$("#print-catalog").modal("show");
        } catch (err) {
            console.log("Error in showPrintCatalog function::", err);    
        }
    },
    createArticleReference: function() {
        try {
            this.mainContainer.find('a').each(function(){
                  if ($(this).attr('href') && $(this).is(':visible') && !$(this).attr('id') && 
                      (!$(this).attr('class') || $(this).attr('class') == "link")) {
                      if($(this).attr('href').charAt(0) != "#"  && !~$(this).attr('href').indexOf('javascript')) {
                          $(this).addClass('article-reference-link');    
                      }
                  }
              });
        } catch (err) {
            console.log("Error in createArticleReference function::", err);    
        }
    },
    externalLinkAlert: function() {
        try {
            this.mainArticleContainer.find('a').each(function(){
                  if ($(this).attr('href') && !$(this).hasClass('links-toc')) {
                      if ((~$(this).attr('href').indexOf('http:') || ~$(this).attr('href').indexOf('https:')) &&
                       !~$(this).attr('href').indexOf(window.location.host)) {
                          $(this).addClass('confirmModal');
                          $(this).attr('target', '_blank');
                          $(this).attr('rel', 'noopener noreferrer');
                      }
                }
              });
        } catch (err) {
            console.log("Error in externalLinkAlert function::", err);    
        }
    },
    processPageIndicators: function (self) {
        try {
            $('span.page-indicator').remove();
            var container = self.mainContainer;
                        container.find("a.page-indicator").each(function() {
                var width = container.offset().left + container.outerWidth() - $(this).offset().left;
                var pagenum = $(this).attr('data-value');
                if (pagenum != undefined && pagenum != '') {
                    var span = '<span class="page-indicator" style="width:'+(width+20)+
                    'px;visibility:hidden"><span class="page-numbers">'+pagenum+'</span></span>';
                    $(span).insertAfter(this);
                }            
            });
        } catch (err) {
            console.log("Error in processPageIndicators function::", err);    
        }
    },
    removeUnwantedPageNumbers: function() {
        try {
               $('.table_of_content a.page-indicator, #table_content a.page-indicator').each(function () {
		  var pageIndicator = $(this);
    	  var div = pageIndicator.closest('.dots_div');
       	if (div.length) {
      	var mainLink = div.find('a').first(); 
        div.find('a.page-indicator').remove(); 
        var contentNodes = div.contents().not(mainLink);
        mainLink.append(contentNodes);       
        div.empty().append(mainLink);       
         			 }
		});
              $('#table_content a.page-indicator').remove();
             $(".titlepage .title .page-num, .breadcrumb span, .title-section span,"+
                 " .table_contents span, #title span, .breadcrumb a, .title-section a, #title a").each(function(){
                  if($(this).hasClass('page-indicator')){
                      $(this).remove();
                  }
              });
              $(".titlepage .title .page-num, .breadcrumb span, .title-section span, .table_contents span, .blockquote .page-indicator")
              .removeClass("page-indicator").find(".page-numbers").remove();
              $(".breadcrumb span.page-numbers, .title-section span.page-numbers, .table_contents span.page-numbers").addClass('hide');
          } catch (err) {
            console.log("Error in removeUnwantedPageNumbers function::", err);    
        }
    },
    pagenumbermouseenter: function() {
        try {
            $('.content-section span.page-indicator').css('visibility', 'visible');
        } catch (err) {
            console.log("Error in pagenumbermouseenter function::", err);    
        }
    },
    pagenumbermouseleave: function() {
        try {
            $('span.page-indicator').css('visibility', 'hidden');
        } catch (err) {
            console.log("Error in pagenumbermouseleave function::", err);    
        }
    },
    registerPageNumberEvents: function() {
        try {
            $('.content_container p,.drama-content').on('mouseenter', this.pagenumbermouseenter);
            $('.content_container p,.drama-content').on('mouseleave', this.pagenumbermouseleave);
        } catch (err) {
            console.log("Error in registerPageNumberEvents function::", err);    
        }
    },
    removePageNumbersPostInit: function() {
        try {
            var container = this.mainContainer;
            this.mainContainer.find("a.page-indicator").each(function() {
                if ($(this).next().is('span') && $(this).next().hasClass('page-indicator')) {
                    if ($(this).next().next().is('a') && $(this).next().next().hasClass('page-indicator')) {
                        var width = $(this).offset().left;
                        var top = $(this).offset().top;
                        var adjacent = $(this).next().next();
                        var adjacentWidth = adjacent.offset().left;
                        var adjacentTop = adjacent.offset().top;
                        if (top == adjacentTop) {
                            $(this).remove();
                        }
                    }
                }    
            });
        } catch (err) {
            console.log("Error in removePageNumbersPostInit function::", err);    
        }
    },
    processPageIndicatorsForResize: function() {
        try {
            var self = this;
            $(window).resize(function() {
                self.processPageIndicators(self);
            });
        } catch (err) {
            console.log("Error in processPageIndicatorsForResize function::", err);    
        }
    },
    pageNumbersInit: function() {
        try {
            this.removeUnwantedPageNumbers();
            this.processPageIndicators(this);
            this.processPageIndicatorsForResize();
            this.registerPageNumberEvents();
            this.removePageNumbersPostInit();
        } catch (err) {
            console.log("Error in pageNumbersInit function::", err);    
        }
    },
    createMutationObserver: function() {
        try {
            var self = this;
            const baselineStyles = window.getComputedStyle(document.body);
            var baselineValue = {
                "letter-spacing" : baselineStyles.getPropertyValue('letter-spacing'),
                "line-height" : baselineStyles.getPropertyValue('line-height'),
                "word-spacing" : baselineStyles.getPropertyValue('word-spacing'),
                "font-size" : baselineStyles.getPropertyValue('font-size'),
            };
            const propertiesToCheck = ['letter-spacing', 'line-height', 'word-spacing', 'font-size'];
            var flag = false;
            setInterval(function checkInjectedStyles() {
                const currentStyles = window.getComputedStyle(document.body);
                propertiesToCheck.forEach((prop) => {
                    const currentValue = currentStyles.getPropertyValue(prop);
                    if (baselineValue[prop] !== currentValue) {
                        baselineValue[prop] = currentValue;
                        flag = true;
                    }
                });
                if (flag) {
                    self.processPageIndicators(self);
                    flag = false;
                }
            }, 1000);
        } catch (err) {
            console.log("Error in createMutationObserver function::", err);    
        }
    },
    createDownloadFileForTable: function(table) {
        try {
            var tableArray = [];
            var offset = 0;
            var offsetColumn = 0;
            var offsetRow = 0;    
            table.find('table thead tr').each(function(index){
                var tableHead = [];
                var rowpos = index;
                $(this).find('th').each(function(headIndex){
                    var tableObject = {};
                    var colpos = headIndex;
                    tableObject.text = $(this).text().trim();
                    tableObject.colspan = $(this).attr('colspan')?$(this).attr('colspan'):"1";
                    tableObject.rowspan = $(this).attr('rowspan')?$(this).attr('rowspan'):"1";
                    if (parseInt(tableObject.rowspan) > 1) {
                        offset = parseInt(tableObject.rowspan) - 1;
                        offsetColumn = headIndex;
                        offsetRow = index;
                    }
                    tableObject.style = [];
                    if ($(this).attr('align')) {
                        var alignment = {};
                        alignment.name = "align";
                        alignment.value = $(this).attr('align');
                        tableObject.style.push(alignment);
                    }
                    var font = {};
                    font.name = "font-weight";
                    font.value = "bold";
                    tableObject.style.push(font);
                    tableObject.headingrow = true;
                    tableObject.rowpos = rowpos;
                    if (index > offsetRow && index <= offsetRow + offset) {
                        tableObject.colpos = colpos + offset;    
                    } else {
                        tableObject.colpos = colpos;
                    }
                    tableHead.push(tableObject);
                });
                tableArray.push(tableHead);
            });
            var headerLength = tableArray.length;
            table.find('table tbody tr').each(function(index){
                var tableRow = [];
                var rowpos = index + headerLength;
                $(this).find('td').each(function(headIndex){
                    var tableObject = {};
                    var colpos = headIndex;
                    tableObject.text = $(this).text().trim();
                    tableObject.colspan = $(this).attr('colspan')?$(this).attr('colspan'):"1";
                    tableObject.rowspan = $(this).attr('rowspan')?$(this).attr('rowspan'):"1";
                    tableObject.style = [];
                    if ($(this).attr('align')) {
                        var alignment = {};
                        alignment.name = "align";
                        alignment.value = $(this).attr('align');
                        tableObject.style.push(alignment);
                    }
                    tableObject.rowpos = rowpos;
                    tableObject.colpos = colpos;
                    tableObject.headingrow = false;
                    tableRow.push(tableObject);
                });
                tableArray.push(tableRow);
            });
            return tableArray;
        } catch (err) {
            console.log("Error in createDownloadFileForTable function::", err);    
        }
    },
    callTableServlet: function(table, title, caption) {
        try {
            var currentDate = new Date();
            var timeStamp = currentDate.getTime();
            var documentKey = this.docid;
            var requestJSON = {tableData:table,key:documentKey+"-"+timeStamp};
            if (title) {
                requestJSON.tableheading = title;
            }
            if (caption) {
                requestJSON.tableCaption = caption;
            }
            $.ajax({
                url: "/app/downloadtable",
                data: JSON.stringify(requestJSON),
                contentType: "application/json",
                type: "POST",
                success: function(e) {
                    $("#download-table").removeClass('disabled-btn');
                    $("#download-table").attr('href', "/app/downloadtable?key="+documentKey+"-"+timeStamp);
                    $("#download-table").attr('download', this.docid+".csv");
                },
                error: function(e) {
                    hideProgress();
                }
            });
        } catch (err) {
            console.log("Error in callTableServlet function::", err);    
        }
    },
    showTableModal: function(e, self, element) {
        try {
            var targetElement = e.target;
            if (!$(targetElement).hasClass('footnote')) {
                self.tablemodal.find(".table-content").append($(element).html());
                self.tablemodal.modal("show");
                self.tablemodal.find(".footnote").remove();
            }
        } catch (err) {
            console.log("Error in showTableModal function::", err);    
        }
    },
    showImageModal: function(e, self, element) {
        try {
            var targetElement = e.target;
            if (!$(targetElement).hasClass('footnote')) {
                $(element).find('img').clone().appendTo("#image-download-modal .table-content");
                if ($(element).find('div.title').length > 0) {
                    $(element).find('div.title:first').clone().appendTo("#image-download-modal .table-content");    
                }
                self.imagemodal.modal("show");
            }
        } catch (err) {
            console.log("Error in showImageModal function::", err);    
        }
    },
    onHiddenImageModal: function() {
        try {
            $(this).find(".table-content").empty();
        } catch (err) {
            console.log("Error in onHiddenImageModal function::", err);    
        }
    },
    onHiddenTableModal:function() {
        try {
            $(this).find(".table-content").empty();
            $(this).find("#download-table").addClass('disabled-btn');
            $(this).find("#download-excel-table").addClass('hide');
            $(this).find("#download-excel-table").removeAttr('href');
        } catch (err) {
            console.log("Error in onHiddenTableModal function::", err);    
        }
    },
    onShowTableModal: function(self, element) {
        try {
            var tableArray = self.createDownloadFileForTable($(element));
            var tableTitle = $(element).find(".title").length>0?$(element).find(".title").text().trim():"";
            var tableCaption = $(element).find(".caption").length>0?$(element).find(".caption").text().trim():"";
            self.callTableServlet(tableArray, tableTitle, tableCaption);
        } catch (err) {
            console.log("Error in onShowTableModal function::", err);    
        }
    },
        registerRelatedSquidEvents: function() {
        var self = this;
        try {
            $('#related_content .category_cont a').on('click', function(e){
                var refLink = $(this).attr('href');
                window.refLink = refLink;
                e.preventDefault();
                var params = refLink.split('?');
                var documentLink;
                if (params[1]) {
                    documentLink = params[1].split('&')[0].split('=')[1];
                }
                squidCall("Related Content", 'Left Panel', refLink);
            });
        } catch (err) {
            console.log("Error in registerRelatedSquidEvents function::", err);    
        }
    },
    registerRecentlySquidEvents: function() {
        var self = this;
        try {
            $('#recently_viewed .category_cont a').on('click', function(e){
                var refLink = $(this).attr('href');
                window.refLink = refLink;
                e.preventDefault();
                var params = refLink.split('?');
                var documentLink;
                if (params[1]) {
                    documentLink = params[1].split('&')[0].split('=')[1];
                }
                squidCall("Recently Viewed", 'Left Panel', refLink);
            });
        } catch (err) {
            console.log("Error in registerRecentlySquidEvents function::", err);    
        }
    },
    registerReferenceSquidEvents: function() {
        var self = this;
        try {
            $('.article-reference-link').on('click', function(e){
                var refLink = $(this).attr('href');
                var target = $(this).attr('target');
                var params = refLink.split('?');
                if (target != "_blank") {
                    window.refLink = refLink;
                    e.preventDefault();
                }
                var documentLink;
                if (params[1]) {
                    documentLink = params[1].split('&')[0].indexOf('docid') > -1 ? params[1].split('&')[0].split('=')[1] : refLink;
                }
                squidCall("Reference", 'Content Body', refLink);
            });
        } catch (err) {
            console.log("Error in registerReferenceSquidEvents function::", err);
        }
    },
                imageCaptionWidth: function() {
        try {
            $(this).parent().find('.image_caption').css('width',$(this).width());
        } catch (err) {
            console.log("Error in imageCaptionWidth function::", err);
        }
    },
    toggleSearchWithinButton: function(btn, input){
        try {
            if (input.val().trim().length > 0) {
                btn.removeClass("disabled-btn");
            }
            else {
                btn.addClass("disabled-btn");
            }
        } catch (err) {
            console.log("Error in toggleSearchWithinButton function::", err);
        }
    },
                    searchWithinEnc: function(self) {
        try {
            if(!self.searchencbtn.hasClass('disabled-btn')) {
                var searchVal = self.searchencinput.val();
                var workId = $('#workid').val();
                var title = $('#workTitle').val();
                var docId = '';
                if($("#docid").length>0 ){
                    docId = $('#docid').val();
                }
                if (searchVal) {
                    title = title.split("&").join("~~");
                    var url = "/encyclopedia-search?searchterm=" + searchVal + '&workid=' + workId + '&title=' + title;
                    if(docId != ''){
                        url = url + '&docid=' + docId;
                    }
                    window.location.href = url;
                }
            }
        } catch (err) {
            console.log("Error in searchWithinEnc function::", err);
        }
    },
    searchWithinEncInputKeyup: function(e, self) {
        try {
            self.toggleSearchWithinButton(self.searchencbtn, self.searchencinput);
            if (e.keyCode == 13) {
                self.searchWithinEnc(self);
            }
        } catch (err) {
            console.log("Error in searchWithinEncInputKeyup function::", err);
        }
    },
            truncateDescription: function() {
        try {
            this.truncateContainer.each(function () {
                var descript = $(this);
                count = $(this).attr('count')?$(this).attr('count'):"220";
                count = isNaN(parseInt(count))?220:parseInt(count);
                var message=$(this).attr('message')?$(this).attr('message'):"Read More";
                var messageLess=$(this).attr('message-less')?$(this).attr('message'):"View Less";
                $(this).truncate({max_length:count, more:message, less:messageLess});
            });
        } catch (err) {
            console.log("Error in truncateDescription function::", err);    
        }
    },
    addResponsiveImageClass: function() {
        try {
            this.articleRight.find('img').addClass('img-responsive');
        } catch (err) {
            console.log("Error in addResponsiveImageClass function::", err);    
        }
    },
    bindDocumentCollapseEvents: function() {
        try {
            this.articleRight.find(".collapse").on("shown.bs.collapse", function (e) {
                if ($('.panel-collapse').hasClass('parent-accordion')) {
                    e.stopPropagation();
                    $(this).prev().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title', 'Collapse');
                    accordianaction($('.parent-accordion'));
                } else if($('.panel-collapse').hasClass('catalogue-table')){
                    $(this).prev().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title', 'Collapse');
                } else {
                    $(this).parent().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title', 'Collapse');
                    accordianaction($('.panel-collapse'));
                }
                $(this).parent().find(".panel-title .panel-title-text").text('HIDE SECTIONS');
                truncateAltAuth();
            }).on("hidden.bs.collapse", function (e) {
                if ($('.panel-collapse').hasClass('parent-accordion')) {
                    e.stopPropagation();
                    $(this).prev().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title', 'Expand');
                    accordianaction($('.parent-accordion'));
                } else if($('.panel-collapse').hasClass('catalogue-table')){
                    $(this).prev().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title', 'Expand');
                } else {
                    $(this).parent().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title', 'Expand');
                    accordianaction($('.panel-collapse'));
                }
                $(this).parent().find(".panel-title .panel-title-text").text('VIEW SECTIONS');
            });
              $(".glyphicon.glyphicon-minus, .glyphicon.glyphicon-plus").off("keyup").on("keyup", function(e){
    			if (e.keyCode == 13) {
      			$(this).click();
    				}
  				});
  			 $(".open-access-lock").on("keyup", function(e) {
  			 if (e.keyCode == 13) {
    			$(this).click(); 
  				} 
			 });
			  $(".recent_img").on("keyup", function(e) {
  			 if (e.keyCode == 13) {
    			$(this).click(); 
  				} 
			 });
			 $(".currentplay a.play-track").attr("tabindex", "-1");
            $('#table_content, .ency-toc').find(".collapse").on("shown.bs.collapse", function (e) {
                e.stopPropagation();
                e.stopImmediatePropagation();
                $(this).parent().children().eq(0).find(".glyphicon-plus").addClass("glyphicon-minus").attr('title', 'Expand').removeClass("glyphicon-plus");
            }).on("hidden.bs.collapse", function (e) {
                e.stopPropagation();
                e.stopImmediatePropagation();
                $(this).parent().children().eq(0).find(".glyphicon-minus").addClass("glyphicon-plus").attr('title', 'Collapse').removeClass("glyphicon-minus");
            });
            $('.article_left').find(".collapse").on("shown.bs.collapse", function (e) {
                $(this).parent().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title', 'Collapse');
                accordianaction($('.panel-collapse'));
            }).on("hidden.bs.collapse", function (e) {
                $(this).parent().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title', 'Expand');
                accordianaction($('.panel-collapse'));
            });
        } catch (err) {
            console.log("Error in bindDocumentCollapseEvents function::", err);    
        } 
    },
    accordianPanelCollapseAll: function(e) {
        try {
            if (e.type === "click" || e.keyCode === 13) {
                var title = $(this).children('span').text();
                var collapsetext=$('#collapseallsec').val();
                var expandtext=$('#expandallsec').val();
                if($('.taxonomy_alphabets').length>0){
                    $(".taxonomy_alphabets li a").parent().children().removeClass("active");
                }
                if (title == collapsetext) {
                    $('.accordion-toggle').addClass('collapsed').attr('aria-expanded', 'false');
                    $('.panel-collapse:not(.child-panel)').removeClass('in').attr('aria-expanded', 'false');
                    $(this).children('span').text(expandtext);
                    $('.glyphicon:not(.child-toggle-icon)').removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title', 'Collapse');
                } else {
                    $('.accordion-toggle').removeClass('collapsed').removeAttr('aria-expanded');
                    $('.panel-collapse:not(.child-panel)').addClass('in').removeAttr('aria-expanded').css('height', 'auto');
                    if ($('#accordion0').hasClass('hide')) {
                        $('#collapseZero').removeClass('in').attr('aria-expanded', 'false');
                    }
                    $(this).children('span').text(collapsetext);
                    $('.glyphicon:not(.child-toggle-icon').removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title', 'Expand');
                }
            }
        } catch (err) {
            console.log("Error in accordianPanelCollapseAll function::", err);    
        }  
    },
    catalogueDescReadMore: function(){
        try{
            $('#catalogue-content').find('.catalogue_more').each(function () {
                if($(this).find('p').length > 1 ) {
                        if($(this).find('p:first').height() > 125) {
                            $(this).find('p:first').addClass('content-height');
                        }
                        $(this).find('p').not(":first").addClass('hide');
                        $(this).append('<a href="javascript:void(0)" class="more-results pull-right" data-more="read more..." data-less="...read less" '+
                                'id="catalogue_readmore">read more...</a>');
                }else {
                    if($(this).find('p').height() > 125) {
                        $(this).find('p').addClass('content-height');
                        $(this).append('<a href="javascript:void(0)" class="more-results pull-right" data-more="read more..." data-less="...read less" '+
                                'id="catalogue_readmore">read more...</a>');
                    }
                }
            });
            this.catalogDescReadMoreReadLess();
        }catch(ex) {
            console.log("Error in catalogueDescReadMore function::", ex);  
        }
        
    },
    catalogDescReadMoreReadLess: function() {
        try {
            $(document).on('click', '#catalogue_readmore', function() {
                var type = $(this).attr('data-type');
                var category = '.category_cont';
                if (type == 'media') {
                    category = '.multimedia-thumb';
                }
                if($(this).hasClass('more-results')){
                    $(this).parent().find(category).removeClass('hide');
                    $(this).removeClass('more-results');
                    $(this).text($(this).attr('data-less'));
                    if (type != 'media') {
                        $(this).prev().removeClass('content-height');
                        $(this).parent().find('p:first').removeClass("content-height");
                        $(this).parent().find('p').not(':first').removeClass("hide");
                    }
                } else {
                    $(this).text($(this).attr('data-more'));
                    $(this).addClass('more-results');
                    $(this).parent().find(category).each(function(index) {
                        if(index > 4) {
                            $(this).addClass('hide');
                        }
                    });
                    if (type != 'media') {
                        $(this).prev().addClass('content-height');
                        $(this).parent().find('p:first').addClass("content-height");
                        $(this).parent().find('p').not(':first').addClass("hide");
                    }
                }
            });
        } catch (err) {
            console.log("Error in registerviewMore function::", err);    
        }
    },
    subjectsviewmore: function() {
        try {
            $('.article_left .category_more').each(function () {
                if ($(this).find('p').height() > 125) {
                    $(this).find('p').addClass('content-height');
                    $(this).append('<a href="javascript:void(0)" style="position:static;" class="more-results" data-more="More..." data-less="...Less" '+
                        'id="contenttype_more">More...</a>');
                }
            });
            this.registerviewMore();
        } catch (err) {
            console.log("Error in subjectsviewmore function::", err);    
        }
    },
    registerviewMore: function() {
        try {
            $(document).on('click', '.article_left .category_more a.more-results, #contenttype_more', function() {
                var type = $(this).attr('data-type');
                var category = '.category_cont';
                if (type == 'media') {
                    category = '.multimedia-thumb';
                }
                if($(this).hasClass('more-results')){
                    $(this).parent().find(category).removeClass('hide');
                    $(this).removeClass('more-results');
                    $(this).text($(this).attr('data-less'));
                    if (type != 'media') {
                      $.cloudinary.responsive();
                        $(this).prev().removeClass('content-height');
                        $(this).closest('#related_content').addClass('border-related');
                        $(this).closest('#catalogue-content').addClass('border-related');
                    }
                }else {
                    $(this).text($(this).attr('data-more'));
                    $.cloudinary.responsive();
                    $(this).addClass('more-results');
                    $(this).parent().find(category).each(function(index) {
                        if(index > 4) {
                            $(this).addClass('hide');
                        }
                    });
                    if (type != 'media') {
                        $(this).closest('#related_content').removeClass('border-related classname2');
                        $(this).closest('#catalogue-content').removeClass('border-related classname2');
                        $(this).prev().addClass('content-height');
                    }
                }
            });
        } catch (err) {
            console.log("Error in registerviewMore function::", err);    
        }
    },
    viewMoreToC: function() {
        try {
            if($('.toc_box li, .toc_box b').length > 5) {
                var viewMore = $('#view-more').val();
                $('.volume_box, .toc_box').children('ul').append('<div align="right"><a href="javascript:;" id="view_morelink">'
                    +viewMore+'</a></div>');
            }    
            $('.toc_box').find('#view_morelink').click(function () {
                var viewMore = $('#view-more').val();
                var viewLess = $('#view-less').val();
                if($(this).text() == viewMore){
                    $('.volume_box li , .toc_box li, .toc_box b').show();
                    $('.volume_box li , .toc_box li, .toc_box b').find('div, span').show();
                    $(this).text(viewLess);
                } else {
                    viewmoreLink();
                    $(this).text(viewMore);
                    $("body").scrollTop($('.toc_box').offset().top);
                }
            });
        } catch (err) {
            console.log("Error in viewMoreToC function::", err);    
        }    
    },
                        markTerms: function() {
        try {
            var searchVal = decodeURIComponent("$searchTextHighlight");
            var clearBtn = $("#mark-removeterm"),
                nextBtn = $("#mark-nextterm"),
                prevBtn = $("#mark-prevterm"),
                                content = $("#accordionAbstractExtract, #title, .title-section .author-alias a.popper, .page-range .highlight-txt, #collapseTwo.encyclo-accordian, .content-section, #taxonomy-subjects p"),
                                exclude = "",
                showBtn = $("#show-markterm"),
                markContainer = $("#mark-container"),
                markHidden = $("#mark-hidden"),
                currentClass = "current",
                offsetTop = 50,
                   currentIndex = 0,
                   results;
                                  exclude = (".copyright").split(",");
                              function jumpTo() {
                if (results.length) {
                    var position,
                        current = results.eq(currentIndex);
                    results.removeClass(currentClass);
                    if (current.length) {
                        current.addClass(currentClass);
                        position = current.offset().top - offsetTop;
                        $(window).scrollTop(position);
                    }
                }
            }
            function showButtons(){
                nextBtn.removeClass("hide");
                prevBtn.removeClass("hide");
            }
            function showHidden(){
                markHidden.removeClass("hide");
            }
            if (searchVal && $.trim(searchVal)) {
                markContainer.removeClass("hide");
                content.unmark({
                  done: function(count) {
                    content.mark(searchVal, {
                      separateWordSearch: false,
                      acrossElements: true,
                                            accuracy: {
                          value: "exactly",
                          limiters: ["'",",", ".", ":", ";", "‘", "’"]
                        },
                                                ignorePunctuation: ":;.,-–—‒_(){}[]!'\"+=‘’".split(""),
                        exclude: exclude,
                        done: function(count) {
                        results = content.find("mark");
                        currentIndex = 0;
                        if(currentIndex >= results.length - 1) {
                            nextBtn.addClass('disable-arrow');
                        }
                        if (results.length == 0) {
                            prevBtn.addClass('disable-arrow');
                            markContainer.addClass("hide");
                        }
                        setTimeout(function(){
                            jumpTo();
                        }, 200);
                      }
                    });
                  }
                });    
            }
            clearBtn.on("click", function() {
                content.unmark();
                nextBtn.addClass("hide");
                prevBtn.addClass("hide");
                markContainer.hide("slide", {direction: "right"}, 200, showHidden);
            });

            showBtn.on("click", function() {
                content.mark(searchVal, {
                      separateWordSearch: false,
                      acrossElements: true,
                                            accuracy: {
                          value: "exactly",
                          limiters: ["'", ",", ".", ":", ";", "‘", "’"]
                      },
                                            ignorePunctuation: ":;.,-–—‒_(){}[]!'\"+=‘’".split(""),
                      exclude: exclude,
                      done: function(count) {
                        results = content.find("mark");
                        //currentIndex = 0;
                        jumpTo();
                      }
                });
                markHidden.addClass("hide");
                markContainer.show("slide", {direction: "right"}, 200, showButtons);
            });

            nextBtn.add(prevBtn).on("click", function() {
                if (!$(this).hasClass('disable-arrow')) {
                    if (results.length) {
                          currentIndex += $(this).is(prevBtn) ? -1 : 1;
                          if (currentIndex < 0) {
                            currentIndex = results.length - 1;
                          }
                          if (currentIndex > results.length - 1) {
                            currentIndex = 0;
                          }
                          if (currentIndex == 0){
                              prevBtn.addClass('disable-arrow');
                          } else {
                              prevBtn.removeClass('disable-arrow');
                          }
                          if (currentIndex == results.length - 1) {
                              nextBtn.addClass('disable-arrow');
                          } else {
                              nextBtn.removeClass('disable-arrow');
                          }
                    }
                }
                jumpTo();
            });
        } catch (err) {
            console.log("Error in markTerms function::", err);    
        }
    },
        showRecentlyViewed: function() {
        try {
            if($('#showrecentlyview').length>0){
                if($('#showrecentlyview').val().toLowerCase()=='yes'){
                    var recentlyViewed = this.getRecentlyViewed();
                    if (recentlyViewed == "") {
                        $("#recently_viewed").remove();
                    } else {
                        $("#recently_viewed").html(recentlyViewed);
                           $('p.authors-recent a').addClass("author-name");
                    }
                }
            }
        } catch (err) {
            console.log("Error in showRecentlyViewed function::", err);    
        }
    },
    getRecentlyViewed: function() {
        try {
            var recent_html='';
            var currentUrl=window.location.href.split('&st')[0];
            var recentlyViewed = [];
            if(localStorage.getItem('recentlyViewed')){
                  recentlyViewed=$.parseJSON(localStorage.getItem('recentlyViewed'));
            }
            var itemExists=false;
            var addtorecentlyview='no';
            var docid=$.linkNewParam('docid', currentUrl);
            if($('#addtorecentlyview').length>0){
                  addtorecentlyview=$('#addtorecentlyview').val();
            }
            if(addtorecentlyview.toLowerCase()=='yes'){
                  var title=$("#title").length>0 ? $.trim($("#title").find('h2').text()):'';
                  if(title.length==0){
                    title=$('#title').length>0?$.trim($("#title").text()):'';
                  }
                  if(title.length==0){
                    title=$('#title').length>0?$.trim($("#title").val()):'';
                  }
                  if(title.length==0){
                    title=$('#detail-title').length>0?$.trim($("#detail-title").text()):'';
                  }
                  if(title.length==0){
                    title=$('h1.title').length>0?$.trim($("h1.title").text()):'';
                  }
                    var subtitle='';
                    if ($("#titlevalue").length > 0) {
                    subtitle = $("#titlevalue").val();
                  } else if($("#wvTitle").length>0){
                    subtitle=$("#wvTitle").val();
                  } else if($("#sub-title").length > 0) {
                	  subtitle = $("#sub-title").text();
                  }
                  if(subtitle.length == 0 && $('#recentcontenttype').length > 0 && $('#recentcontenttype').val() == "catalogue" && $('#description').text().trim().length > 60) {
                	  subtitle = $('#description').text().trim().substring(0,57)+"...";
                  }
                  if (title.toLowerCase().trim() == subtitle.toLowerCase().trim()) {
                    subtitle = '';
                  }
                  var towncity = '';
                  if($("#town_city_address").length > 0) {
                    towncity = $("#town_city_address").val();
                  }
                  var contentdisplay = '';
                  if ($("#vol-contentTypes a").length > 0) {
                    contentdisplay = $("#vol-contentTypes a").text();
                  } else if ($("#vol-documentType a").length > 0) {
                    contentdisplay = $("#vol-documentType a").text();
                  } else if ($("#vol-contentType a").length > 0) {
                    contentdisplay = $("#vol-contentType a").eq(0).text();
                  } 
                 author=$("#authorChap").html()?$("#authorChap").html():'';
                  if(author.length==0){
                    author=$("#author").html()?$("#author").html():'';
                  }
                  if(author.length==0){
                    author=$("h3.author").html()?$("h3.author").html():'';
                  }
                  var pubname=$("#pub-name").length>0?$.trim($("#pub-name").text()):'';
                  var pubyear=$("#pub-year").length>0? $.trim($("#pub-year").text()):'';
                  var recentimageurl=$('#coverImageUrl').length>0?$('#coverImageUrl').attr('src')||$('#coverImageUrl').val():$('#buildsupportimagelist').length>0?$('#buildsupportimagelist').val().split('~')[0]:'';
                  var contenttype=$('#recentcontenttype').length>0?$('#recentcontenttype').val():'';
                  var pubnameyear=$('#pub-yeardata').length>0?$.trim($('#pub-yeardata').text()):'';
                  var publishyeardata='';
                  if(pubnameyear.length>0){
                    publishyeardata=pubnameyear;
                  }else {
                    if(pubname.length>0&&pubyear.length>0){
                          publishyeardata=pubname+', '+pubyear;
                    }else if(pubname.length>0&&pubyear.length==0){
                          publishyeardata=pubname;
                    }else if(pubname.length==0&&pubyear.length>0){
                          publishyeardata=pubyear;
                    }
                  }
                  
                    var writtenby=$("#writtenby").length>0 ? $.trim($("#writtenby").html()):'';
                    var directedby=$("#directedby").length>0 ? $.trim($("#directedby").html()):'';
                var adaptedBy=$("#adaptedBy").length>0 ? $.trim($("#adaptedBy").html()):'';
                var originalAuthor=$("#originalAuthor").length>0 ? $.trim($("#originalAuthor").html()):'';
                var translatedBy=$("#translatedBy").length>0 ? $.trim($("#translatedBy").html()):'';
                var editedBy=$("#editedBy").length>0 ? $.trim($("#editedBy").html()):'';
                    
                  if(contenttype=='encyclopedia'){
                    recentimageurl='';
                  }
                  if(currentUrl.length>0){
                    if (title.length > 60) {
                          title = title.substring(0, 57) + "...";
                    }
                    recentlyViewed=this.removeExistsRecentlyItem(currentUrl);
                    if(recentlyViewed.length>5){
                          recentlyViewed.shift();
                    }
                    var cookieVal='';
                    cookieVal = {"title": title ,"subtitle":subtitle,"url": currentUrl,"author":author,"publishyeardata":publishyeardata, "image": recentimageurl,"contenttype":contenttype,"docid":docid, "contentdisplay":contentdisplay, "towncity": towncity, "writtenby": writtenby, "directedby": directedby, "adaptedBy": adaptedBy, "originalAuthor": originalAuthor, "translatedBy": translatedBy, "editedBy": editedBy, "image": recentimageurl,"contenttype":contenttype,"docid":docid, "contentdisplay":contentdisplay,    "towncity": towncity, "writtenby":writtenby, "directedby":directedby}
                    recentlyViewed.push(cookieVal);
                    localStorage.setItem('recentlyViewed', JSON.stringify(recentlyViewed));
                   }
            }
            if(recentlyViewed.length>0) {
                  if( $.isArray(recentlyViewed)){
                    var count = 0;
                    for (var i = (recentlyViewed.length -1); i >=0 ; i--) {
                          itemExists=false;
                          if((recentlyViewed[i].contenttype == "monograph" || recentlyViewed[i].contenttype == "archive") &&
                           addtorecentlyview=='no' && recentlyViewed[i].docid==docid){
                            currentPageIndex = i;
                            itemExists=true;
                          } else if ( recentlyViewed[i].url == currentUrl) {
                            currentPageIndex = i;
                            itemExists=true;
                          } else {
                            if ( count < 5) {
                                  var iconclass=recentlyViewed[i].contenttype.toLowerCase()=="museumobject"||recentlyViewed[i].contenttype.toLowerCase()=="imagecollection"?"icon-image":
                                  recentlyViewed[i].contenttype == "professional" && currentUrl.includes("professional-content") ? "icon-professional-content":recentlyViewed[i].contenttype.toLowerCase()=="exhibition"?"icon-museum":recentlyViewed[i].contenttype.toLowerCase()=="catalogue"?"icon-archive":
                                  "icon-"+recentlyViewed[i].contenttype;
                                  recent_html += '<div class="row category_cont">';
                                  if (recentlyViewed[i].image != '') {
                                    if (contenttype == "person") {
                                          recent_html += '<div class="col-xs-12 col-sm-3 col-md-12 col-lg-12" aria-hidden="true">' +
                                              '<a href="' + recentlyViewed[i].url + '" tabindex="-1">' + '<img data-src="' + 
                                              recentlyViewed[i].image +
                                              'class="img-responsive mb10 recent_img cld-responsive" tabindex="-1" /></a></div>';
                                          recent_html += '<div class="col-xs-12 col-sm-9 col-md-12 col-lg-12">';
                                    }else if (contenttype === "professional"){
                                         recent_html += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">';
                                    }else {
                                          recent_html += '<div class="col-xs-12 col-sm-3 col-md-12 col-lg-12" aria-hidden="true">' + '<a href="' + 
                                              recentlyViewed[i].url + '" tabindex="-1">' + '<img data-src="' + recentlyViewed[i].image + 
                                              '" class="img-responsive mb10 recent_img cld-responsive" '+
                                              'tabindex="-1" aria-hidden="true"/></a></div>';
                                          recent_html += '<div class="col-xs-12 col-sm-9 col-md-12 col-lg-12">';
                                    }
                                  } else {
                                    recent_html += '<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">';
                                  }
                                  recent_html += '<div class="row">';
                                  if(recentlyViewed[i].contenttype == "professional" && currentUrl.includes("professional-book")){
                                  iconclass ="icon-professional-content";
                                  recent_html += '<div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 recently-icon"><span class="' +
                                      iconclass + '" aria-hidden="true"></span></div>';
                                  }else{
                                  	recent_html += '<div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 recently-icon"><span class="' +
                                       iconclass + '" aria-hidden="true"></span></div>';
                                  }    
                                  var subtitle_html='';
                                  var towncity_html='';
                                  if(recentlyViewed[i].subtitle.length>0){
                                    if(recentlyViewed[i].contenttype == "building") {
                                          subtitle_html=' ('+recentlyViewed[i].subtitle+')';
                                    } else {
                                          subtitle_html='<p>'+recentlyViewed[i].subtitle+'</p>';
                                    }
                                  }
                                  if(recentlyViewed[i].towncity && recentlyViewed[i].towncity.length>0){
                                    towncity_html='<p>'+recentlyViewed[i].towncity+'</p>';
                                  }
                                    var directedby_html ='';    
                                    var writtenby_html ='';
                                      var adaptedBy_html ='';
                                  var originalAuthor_html ='';
                                  var translatedBy_html ='';
                                  var editedBy_html ='';
                                    if(recentlyViewed[i].writtenby && recentlyViewed[i].writtenby.length>0){
                                    writtenby_html='<span>'+recentlyViewed[i].writtenby+'</span>';
                                  }
                                    if(recentlyViewed[i].directedby && recentlyViewed[i].directedby.length>0){
                                    directedby_html='<span>'+recentlyViewed[i].directedby+'</span>';
                                  }
                                
                                  recent_html += '<div class="col-xs-10 col-sm-9 col-md-9 col-lg-10 recent_fin_cont">' + 
                                      '<p><a href="' + recentlyViewed[i].url + '">' + recentlyViewed[i].title + 
                                      (subtitle_html&&recentlyViewed[i].contenttype=="building"?subtitle_html:'') + '</a></p>';
                                if(recentlyViewed[i].adaptedBy && recentlyViewed[i].adaptedBy.length>0){
                                adaptedBy_html='<span>'+recentlyViewed[i].adaptedBy+'</span>';
                              }
                              if(recentlyViewed[i].originalAuthor && recentlyViewed[i].originalAuthor.length>0){
                                originalAuthor_html='<span>'+recentlyViewed[i].originalAuthor+'</span>';
                              }
                              if(recentlyViewed[i].translatedBy && recentlyViewed[i].translatedBy.length>0){
                                translatedBy_html='<span>'+recentlyViewed[i].translatedBy+'</span>';
                              }
                              if(recentlyViewed[i].editedBy && recentlyViewed[i].editedBy.length>0){
                                editedBy_html='<span>'+recentlyViewed[i].editedBy+'</span>';
                              }
                              	
                                  if(recentlyViewed[i].contenttype == "monograph") {
                                    recent_html += subtitle_html;  
                                  }
                                   if(recentlyViewed[i].contenttype != "professional") {
                                	  if (recentlyViewed[i].author && recentlyViewed[i].contenttype != "catalogue") {
                                   	 	recent_html += '<p class="authors-recent">' + recentlyViewed[i].author + '</p>';
                                 	 }
                                  }
                                  if(recentlyViewed[i].contenttype != "monograph" && recentlyViewed[i].contenttype != "building" && recentlyViewed[i].contenttype != "playtext") {
                                    recent_html += subtitle_html;  
                                  }
                                    if (recentlyViewed[i].directedby && recentlyViewed[i].contenttype != "catalogue") {
                                    recent_html += directedby_html;
                                  }
                                    if (recentlyViewed[i].writtenby && recentlyViewed[i].contenttype != "catalogue") {
                                    recent_html += writtenby_html;
                                  }
                                    if (recentlyViewed[i].adaptedBy && recentlyViewed[i].contenttype != "catalogue") {
                                    recent_html += adaptedBy_html;
                                  }
                                  if (recentlyViewed[i].originalAuthor && recentlyViewed[i].contenttype != "catalogue") {
                                    recent_html += originalAuthor_html;
                                  }
                                  if (recentlyViewed[i].translatedBy && recentlyViewed[i].contenttype != "catalogue") {
                                    recent_html += translatedBy_html;
                                  }
                                  if (recentlyViewed[i].editedBy && recentlyViewed[i].contenttype != "catalogue") {
                                    recent_html += editedBy_html;
                                  }
                                  if(recentlyViewed[i].contenttype != "catalogue") {
                                	  recent_html += towncity_html;
                                  }
                                  if(recentlyViewed[i].contenttype != "professional") {
                                 	 if (recentlyViewed[i].publishyeardata && recentlyViewed[i].contenttype != "catalogue") {
                                  	  recent_html += '<p>'+recentlyViewed[i].publishyeardata+'</p>';  
                                     }
                                  }
                                  if(recentlyViewed[i].contenttype != "professional") {
                                   if (recentlyViewed[i].contentdisplay && recentlyViewed[i].contenttype != "catalogue") {
                                    recent_html += '<p>'+recentlyViewed[i].contentdisplay + '</p>';
                                    }
                                 } 
                                  if(recentlyViewed[i].contenttype === "professional") {
                                  		
                                  	 if (recentlyViewed[i].author && recentlyViewed[i].contenttype != "catalogue") {
                                   	 	recent_html += '<p class="authors-recent">' + recentlyViewed[i].author + '</p>';
                                 	 }
                                  	 if (recentlyViewed[i].publishyeardata && recentlyViewed[i].contenttype != "catalogue") {
                                  	  recent_html += '<p>'+recentlyViewed[i].publishyeardata+'</p>';  
                                     }
                                     if (recentlyViewed[i].contentdisplay && recentlyViewed[i].contenttype != "catalogue") {
                                   		 recent_html += '<p>'+recentlyViewed[i].contentdisplay + '</p>';
                                     }	
                                  }
                                  
                                 
                                 
                                 
                                  recent_html += '</div></div></div></div>';
                                  count++;
                            }
                          }
                    }
                  } else {
                    recentlyViewed = [];
                  }
            } else {
                  recentlyViewed = [];
            }    
            if (recent_html != "") {
                 recent_html = '<h2 class="text-uppercase">Recently Viewed</h2>' + recent_html;
            }
            return recent_html;
        } catch (err) {
            console.log("Error in getRecentlyViewed function::", err);    
        }
      },
      removeExistsRecentlyItem: function(currentUrl) {
          try {
            var newlist = [];
            var recentlyViewed = [];
            if(localStorage.getItem('recentlyViewed')){
                  recentlyViewed=localStorage.getItem('recentlyViewed');
            }
            if(recentlyViewed.length>0) {
                  recentlyViewed = $.parseJSON(recentlyViewed);
                  if ($.isArray(recentlyViewed)) {
                    for (var i = 0; i < recentlyViewed.length; i++) {
                          if (recentlyViewed[i].url != currentUrl) {
                            newlist.push(recentlyViewed[i]);
                          }
                    }
                  }
            }
            return newlist;
        } catch (err) {
            console.log("Error in removeExistsRecentlyItem function::", err);    
        }
      },
        initPdfViewer: function() {
  		try {
            var hostName = window.location.protocol + '//' + window.location.host;
            var screenWidth = $(window).width();
            var currentChannel = true;
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || screenWidth <= 1024) {
                currentChannel = false;
            } else {
                currentChannel = true;
            }
            var iframeHeight = "100%";
            if (!currentChannel) {
                iframeHeight = "450px";
            }
            var documentId="%26documentId~b-9781718219342"
            var type = "%26type~" + this.type;
            var docIdS="%26docIdS~b-9781718219342-chapter14";
            var tocId = "%26tocId~" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId);
                
                
	  		if ($('#pdf-name').length > 0) {
				var pageNum = window.location.hash;
				var destinationPage = "";
				var hashPage = "";
				var VRmode = "";
				if (pageNum && ~pageNum.indexOf("#page-")) {
					pageNum = pageNum.split("#page-")[1].trim();
				}
				var pageRange = $("#pageRange").text();
				if (~pageRange.indexOf(":")) {
					pageRange = pageRange.split(":")[1].trim();
				}
				pageRange = pageRange.split("–")[0].trim();
				if (pageRange) {
					if(pageRange%2 == 1) {
						VRmode = "&vrmode=recto";
					} else {
						VRmode = "&vrmode=verso";
					}
					if (pageNum) {
						destinationPage = parseInt(pageNum) - parseInt(pageRange) + 1;
						if(isNaN(destinationPage) || destinationPage <= 0) {
							hashPage = "";
						} else {
							hashPage = "#page="+destinationPage;
						}
					}
				}
				
		        var openAcc = $(".open-access").length;
		        var openAccess = "";
			  	if(openAcc > 0){
			  		openAccess="%26openAccess~true";
			  	} else {
			  		openAccess="%26openAccess~false";
			  	}
			  	var chapterPdfId = "";
			  	if ("b-9781718219342-chapter14" != "" && $('#chapter-pdfId').val() != null) {
			  		if ($('#chapter-pdfId').val().length > 0) {
			  			chapterPdfId = "%26chapterPdfId~" +$('#chapter-pdfId').val().split("pdfs/")[1];
			  		}
			  	}
			  			            $('#pdf-content').append('<iframe src="'+ hostName + '/pdfjs_updated/web/viewer.html?file=' +
					'/app/getpdf?id~/content-types/'+this.type+'/' + $('#pdf-name').val() + openAccess + docIdS + tocId + chapterPdfId + type + documentId + VRmode + hashPage + 
					'" width="100%" height="'+iframeHeight+'" allowfullscreen="true"/>');
	            				this.bindPdfViewerResize();
			}
            if ($(".pdf-content").length > 0) {
                $(".pdf-content").each(function(){
                    var pdfFileName = $(this).find(".pdf-file-name").val();
                    var pdfName = ~pdfFileName.indexOf("/")?pdfFileName.split("/")[1]:pdfFileName;
                    var chapterPdfId = "%26chapterPdfId~" + pdfName;
                    if (pdfFileName) {
                                                    $(this).append('<iframe src="'+ hostName + '/pdfjs_updated/web/viewer.html?file=' +
                            '/app/getpdf?id~/content-types/'+this.type+'/pdfs/' + pdfName + docIdS + tocId + chapterPdfId + type + documentId + 
                            '%26toolbar~simple%26source~cloudinary" width="100%" height="'+iframeHeight+'"/>');
                                            }
                });
            }
		} catch (err) {
			console.log("Error in initPdfViewer function::", err);	
		} 
  	},
        initWordViewer: function() {
        try {
            var hostName = window.location.protocol + '//' + window.location.host;
            var screenWidth = $(window).width();
            var currentChannel = true;
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || screenWidth <= 1024) {
                currentChannel = false;
            } else {
                currentChannel = true;
            }
            var iframeHeight = "600px";
            if (!currentChannel) {
                iframeHeight = "450px";
            }
            if ($(".word-content").length > 0) {
                $(".word-content").each(function(){
                    var docName = $(this).find(".word-file-name").val();
                    var id = ~docName.indexOf("/")?docName.split("/")[1]:docName;
                    //var documentUrl = "https://res.cloudinary.com/bloomsbury-publishing-public/raw/upload/fbl/9781501359484/9781501359484_document_15.doc";
                    var documentUrl = hostName + "/app/getdoc?id=" + id + "%26documentId=b-9781718219342";
                    $(this).append('<iframe src="https://view.officeapps.live.com/op/embed.aspx?src='+documentUrl+'" width="100%" height="'+iframeHeight+'"/>');
                });
            }
        } catch (err) {
            console.log("Error in initWordViewer function::", err);  
        }  
    },
    setTitle: function() {
          try {
              if (document.title.trim() == (this.dispName + " - ") || document.title.trim() == "" || 
                  document.title.trim() ==this.dispName) {
                document.title = this.dispName + " - " + this.title.text();
            }
        } catch (err) {
            console.log("Error in setTitle function::", err);    
        }
    },
    setLoginLink: function() {
        try {
              var redirectUrl = "login?recentUrl=/encyclopedia-chapter?docid=b-9781718219342&tocid=b-9781718219342-chapter14";
              this.login.attr('href', redirectUrl);
        } catch (err) {
            console.log("Error in setLoginLink function::", err);    
        }
    },
      saveClipMethod: function(url, name) {
          try {
            if(url.length>0) {
                var title = $("#title").text() || $("#title").val();
                var params = {titleclip:name,url:url,contentType:"encyclopedia",actionType:"save",titlepage: title,productname:"hklp",accountid:"$accountId"};
                showProgress();
                 var isFullScreen = document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;
           		if (isFullScreen) {
           			
           		    $('#fullscreen-clip-save-modal').modal('hide');
           		}else{
                    $('#clip-save-modal').modal('hide');
                }
                $.ajax({
                    url: "/app/saveDBClip",
                    type: "GET",
                    data: params,
                    success: function(response) {
                    
                        setTimeout(function(){
                        if (isFullScreen) {
                  
                          $(".vua-generate-url-container").append($("#fullscreen-clip-save-success").clone());
                         
                          $("#fullscreen-clip-save-success").modal('show'); 
                        
                        
                          hideProgress();
                          }else{
                            $('.vua-close-button').click();
                     		$('.vua-clip-button').click();
                     		
                            $('#clip-save-success').modal('show');
                            hideProgress();
                          }
                        }, 300);
                    },
                    error: function(xhr) {
                        hideProgress();
                    }
                });
            }
        } catch (err) {
            console.log("Error in saveClipMethod function::", err);    
        }
    },
            sendCounterData: function(dynamic, opts) {
        try {
            
            var platform = ('Human Kinetics Library Platform').split("~!").join("'");
            var database = ('Human Kinetics Sports Skills').split("~!").join("'");
                        var cdt = 'chapter';
                        var yop = "";
            var pname = "";
            var ctdoi = "";
            var ctisbn = "";
            var title = "";

                        var accesstype = 'controlled';
            if ($("#freeContent_Id").length > 0) {
                accesstype = 'Free_To_View';
            }
            if ($("#openAccess_Id").length > 0) {
                accesstype = 'Open';
            }
            var platformData = {datatype: 'PLATFORM', title: platform, itemtype: 'RECORD_VIEW', articleversion: 'vor', accesstype: accesstype, accessmethod: 'regular', sectiontype: cdt};
            var databaseData = {datatype: 'DATABASE', title: database, itemtype: 'RECORD_VIEW', articleversion: 'vor', accesstype: accesstype, accessmethod: 'regular', sectiontype: cdt};
            var titleData = {accesstype: accesstype, accessmethod: 'regular'};
                        titleData.datatype = "BOOK_ARTICLE";
            if (titleData.datatype == "OTHER") {
                titleData.datatype = "BOOK";
                titleData.fsdatatype = "OTHER";
            }
                                    titleData.itemtype = "FT_HTML";
                                    titleData.sectiontype = "article";
            if ($("#counter-contenttype").length > 0) {
                if($("#counter-contenttype").val() == "article") {
                    titleData.sectiontype = "article";
                } else if($("#counter-contenttype").val() == "reference" || $("#counter-contenttype").val() == "monograph" || $("#counter-contenttype").val() == "monographAsReference") {
                    titleData.sectiontype = "chapter";
                } else {
                    titleData.sectiontype = "chapter";
                }
            }
                                    if ($("#isbn-squid").length > 0) {
                ctisbn = $("#isbn-squid").val();
            }
            if ($("#doi-squid").length > 0) {
                ctdoi = $("#doi-squid").val();
            }
            if ($("#pubname-squid").length > 0) {
                pname = $("#pubname-squid").val();
            }
            if ($("#pubdate-squid").length > 0) {
                yop = $("#pubdate-squid").val();
                yop = yop.split("-")[0];
                yop = yop.match(/\d+/g)?yop.match(/\d+/g)[0]:"";
            }
            if ($(".counter-author").length > 0) {
                var counterAuthor = "";
                $(".counter-author").each(function(){
                    author+= "Author|"+$.trim($(this).val())+"|";
                });
            }
            if ($("#book-title-squid").length > 0) {
                title = $.trim($("#book-title-squid").val());
            }
                        title = $.trim($("#chapter-title-squid").val());
                        if (yop) {
                platformData.yop = yop;
                databaseData.yop = yop;
                titleData.yop = yop;
            }
            if (pname) {
                platformData.publisherid = pname;
                databaseData.publisherid = pname;
                titleData.publisher = pname;
            }
            if (counterAuthor) {
                platformData.contributor = counterAuthor;
                databaseData.contributor = counterAuthor;
            }
            if (title) {
                titleData.title = title;
            }
            if (ctdoi) {
                titleData.doi = ctdoi;
                titleData.fsdoi = ctdoi;
            }
            if (ctisbn) {
                titleData.isbn = ctisbn;
            }

            var counterData = [];
            if (!dynamic) {
                if ($.cookie('searchitemflag') == "true") {
                    _$tarQ.push(['track', {datatype: 'PLATFORM', title: platform, itemtype: 'RESULT_CLICK'}]);
                    counterData.push({datatype: 'PLATFORM', title: platform, itemtype: 'RESULT_CLICK'});
                    _$tarQ.push(['track', {datatype: 'DATABASE', title: database, itemtype: 'RESULT_CLICK'}]);
                    counterData.push({datatype: 'DATABASE', title: database, itemtype: 'RESULT_CLICK'});
                    $.cookie('searchitemflag', 'false');
                }
            }
            if (dynamic && opts) {
                for (member in opts) {
                    titleData[member] = opts[member];
                }
            }
                        if ($('.conent_locked:visible').length > 0) {
                titleData.itemtype = "NO_LICENSE";
                databaseData.itemtype = "NO_LICENSE";
                databaseData.contentdatatype = titleData.datatype;
                _$tarQ.push(['track', databaseData]);
                                if (titleData.hasOwnProperty("title")){
                    _$tarQ.push(['track', titleData]);
                    counterData.push(titleData);
                }
            } else {
                titleData.dbtitle = database;
                if(!dynamic) {
                    _$tarQ.push(['track', platformData]);
                    counterData.push(platformData);
                    _$tarQ.push(['track', databaseData]);
                    counterData.push(databaseData);
                }
                                if (titleData.hasOwnProperty("title")){
                    _$tarQ.push(['track', titleData]);
                    counterData.push(titleData);
                }
                            }
                        if (counterData.length > 0) {
                sendCounterBackendLog(counterData);
            }
        } catch (err) {
            console.log("Error in sendCounterData function::", err);    
        }
    },
    sendSquidData: function() {
        try {
            var siteId = 'bb01';
            sqtrkq.push(['wid', siteId]);
            var u = new URI(document.location.href); 
            sqtrkq.push(['dom', '.' + u.domain()]);
            var squidObj = {};
            var cid = '';
            var citid = '';
            var mpid = '';
            var mpna = '';
            var mpa = 'Content';
            var mut = 'Page';
            var citna = '';
            var ctdoi = '';
            var ctisbn = '';
            var cstid = '';
            var ctid = 'encyclopedia';
            var cpna = '';
            var ciyop = '';
            var cau = '';
                        mpid = 'hklp';
                                    mpna = 'Human Kinetics Library Platform';
                                    cid = 'b-9781718219342';
                                    citid = 'b-9781718219342-chapter14';
                                    var cdid = 'hklskill';
                        var cdna = ('Human Kinetics Sports Skills').split("~!").join("'");
            var ccid;
            var ccna;
                        var cdt = 'Full-Text HTML';
                        var cna = "";
            var ctna = "";
            var citna = "";
            if ($("#book-title-squid").length > 0) {
                cna = $("#book-title-squid").val().trim();
                ctna = $("#book-title-squid").val().trim();
            }
            if ($("#chapter-title-squid").length > 0) {
                citna = $("#chapter-title-squid").val().trim();
            }
            if ($("#isbn-squid").length > 0) {
                ctisbn = $("#isbn-squid").val();
            }
            if ($("#doi-squid").length > 0) {
                ctdoi = $("#doi-squid").val();
            }
            if ($("#section-squid").length > 0) {
                cstid = $("#section-squid").val();
                if (cstid == "Image Work") {
                    ctid = "Image Collection";
                }
            }
            if ($("#pubname-squid").length > 0) {
                cpna = $("#pubname-squid").val();
            }
            if ($("#pubdate-squid").length > 0) {
                ciyop = $("#pubdate-squid").val();
            }
            if ($("#squid-author").length > 0 && $("#squid-author").val()) {
                cau = $("#squid-author").val().trim();
            }
            if ($("#parentid-squid").length > 0 && $("#parentid-squid").val()) {
                cid = $("#parentid-squid").val().trim();
            }

            if ($("#childid-squid").length > 0 && $("#childid-squid").val()) {
                citid = $("#childid-squid").val().trim();
            }
                        if (cid) {
                squidObj.cid = cid;
            }
            if (citid) {
                squidObj.citid = citid;
            }
            if (ctid) {
                squidObj.ctid = ctid;
            }
            if(cdid) {
                squidObj.cdid = cdid;
            }
            if(ccid) {
                squidObj.ccid = ccid;
            }
            if(cdna) {
                squidObj.cdna = cdna;
            }
            if(ccna) {
                squidObj.ccna = ccna;
            }
            if(cdt) {
                squidObj.cdt = cdt;
            }
            if(cna) {
                squidObj.cna = cna;    
            }
            if(ctna) {
                squidObj.ctna = ctna;    
            }
            if(citna) {
                squidObj.citna = citna;    
            }
            if (mpid) {
                squidObj.mpid = mpid;
            }
            if (mpna) {
                squidObj.mpna = mpna;
            }
            if (mpa) {
                squidObj.mpa = mpa;
            }
            if (mut) {
                squidObj.mut = mut;
            }
            if(ctdoi) {
                squidObj.ctdoi = ctdoi;
            }
            if(citna) {
                squidObj.citna = citna;
            }
            if(cstid) {
                squidObj.cstid = cstid;
            }
            if(ctisbn) {
                squidObj.ctisbn = ctisbn;
            }
            if(cpna) {
                squidObj.cpna = cpna;
            }
            if(ciyop) {
                squidObj.ciyop = ciyop;
            }
            if(cau) {
                squidObj.cau = cau;
            }
                                    if (citid) {
                squidObj.ctu = "no_licence";
            }
                                    var squidTrack = $.cookie("squidtrack");
            if (squidTrack == "false") {
                $.cookie("squidtrack", "true");
            } else {
                sqtrkq.push(['ext', encodeURIComponent(JSON.stringify(squidObj))]);
                sqtrkq.push(['post', true]);
                sqtrkq.push(['track']);
            }
            window.squidObj = squidObj;
        } catch (err) {
            console.log("Error in sendSquidData function::", err);    
        }
    },
        goToPageClick: function() {
        try {
            if(!$(this).hasClass('disabled-btn')){
                if(!$(this).hasClass('goto_pageguest')) {
                    gotoPageNo();
                } else {
                    $('#subscription-modal').modal('show');
                }
            }
        } catch (err) {
            console.log("Error in goToPageClick function::", err);    
        }
    },
    goToPageKeyUp: function(e) {
        try {
            if ($(this).val().trim().length > 0) {
                $("#goto_pagenobtn").removeClass("disabled-btn");
            } else {
                $("#goto_pagenobtn").addClass("disabled-btn");
            }
            $(this).css('border', 'solid #ccc 1px');
            $("#go-to-error-msg").remove();
            if(!$("#goto_pagenobtn").hasClass('disabled-btn')) {
                if (e.keyCode == 13) {
                    if(!$('#goto_pagenobtn').hasClass('goto_pageguest')) {
                        gotoPageNo();
                    } else {
                        $('#subscription-modal').modal('show');
                    }
                }
            }
        } catch (err) {
            console.log("Error in goToPageKeyUp function::", err);    
        }
    },
          loadStarJS: function () {
          try {
              var stars = document.createElement('script');
              stars.type = 'text/javascript';
              stars.async = true;
              stars.src = 'https://receiver.star.saas.semcs.net/star.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(stars, s);
          } catch (err) {
            console.log("Error in loadStarJS function::", err);    
        }
      },
            initAuthorBioPopup: function() {
          try {
              $('.popper').popover({
                placement: 'top',
                container: 'body',
                trigger: 'manual',
                html: true,
                content: function () {
                      return $(this).next('.popper-content').length>0?$(this).next('.popper-content').html():$(this).parent().next('.popper-content').html();
                }
            }).off('keyup click').on('keyup click', function(e){
                if (e.keyCode == 13) {
                  $('this').trigger('click');
                } else if (e.type == "click") {
                  e.stopPropagation();
                  $('.popper').popover('hide');
                  $(this).popover('toggle');
                }
            });
        } catch (err) {
            console.log("Error in initAuthorBioPopup function::", err);    
        }    
      },
      initThumbPopup: function() {
          try {
              $('.thumb-popper').popover({
                placement: 'top',
                container: 'body',
                trigger: 'manual',
                html: true,
                content: function () {
                      return '<p><b>'+$(this).attr("img")+'</b></p><p><b>'+$(this).attr("title")+'</b></p>';
                }
            }).on('mouseover mouseout', function(e){
                $(this).popover('toggle');
            });
        } catch (err) {
            console.log("Error in initThumbPopup function::", err);    
        }    
      },
      initGlossaryPopup: function() {
          try {
              $('.article-popper').popover({
                placement: 'top',
                container: 'body',
                trigger: 'manual',
                html: true,
                content: function () {
                  return $('.popper-content[id="'+$(this).attr('popover-id')+'"]').html().replaceAll("dd>", "div>").replaceAll("<dd", "<div");
                }
            }).off('keyup click').on('keyup click', function(e){
                if (e.keyCode == 13) {
                  $('this').trigger('click');
                } else if (e.type == "click") {
                  e.stopPropagation();
                  $('.article-popper').popover('hide');
                  $(this).popover('toggle');
                }
            });
        } catch (err) {
            console.log("Error in initAuthorBioPopup function::", err);    
        }    
      },
      loadSearchWithinData: function() {
          try {
              this.searchwithinresult.append(this.searchwithinhidden.html());
              this.searchwithinhidden.remove();
          } catch (err) {
            console.log("Error in loadSearchWithinData function::", err);    
        }
      },
            addListenerForPrintDownload: function() {
          try {
              var self = this;
              document.addEventListener("cueForPrintDownload", function(){
                  self.createPdf();
                  self.createFrame();
              });
          } catch (err) {
            console.log("Error in addListenerForPrintDownload function::", err);    
        }
      },
      createPdf: function() {
  		try {
	      	var currentImg = '';
	      	if (typeof partId !== "undefined") {
		      	if (partId.startsWith("$")) {
		          	partId = "";
		      	}
	      	}
	      	var GMTIndex;
	      	var currDownloadTime = (new Date()).toString().split(' ');
	      	for (var i = 0; i < currDownloadTime.length; i++) {
	        	if (currDownloadTime[i].indexOf('GMT') > -1 || currDownloadTime[i].indexOf('UTC') > -1) {
	              	GMTIndex = i;
	          	}
	          	if (currDownloadTime[i].indexOf('(') > -1) {
	              	currDownloadTime[i] = currDownloadTime[i].split('(')[1];
	          	}
	          	if (currDownloadTime[i].indexOf(')') > -1) {
	              	currDownloadTime[i] = currDownloadTime[i].split(')')[0];
	          	}
	      	}
		    if (GMTIndex !== undefined) {
		        currDownloadTime.splice(GMTIndex, 1);
		    }
		    currDownloadTime = currDownloadTime.join(' ');
		    if ($('#selected-image-url').length > 0) {
		        currentImg = $('#selected-image-url').val();
		    } else if($('#coverImageUrl').length>0){
				currentImg = $('#coverImageUrl').attr('src') || $('#coverImageUrl').val();
			} else if($('#coverImage').length>0){
				currentImg = $('#coverImage').attr('src') || $('#coverImage').val();
			}
			if(~currentImg.indexOf('?id=')) {
				currentImg = currentImg.split('?id=')[1];
			}
	      	var param='';
		  	var isCitationExist='';
	      	if(doctype =="article")	{
		   				  	}	  
	      	if (doctype == "audio") {
	        	param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + "b-9781718219342" + "&currentTime=" + currDownloadTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname +"&currentImg=" + currentImg + "&cachepagetype=" + "$cachepagetype";
	        } else if(doctype == "catalogue"){
                param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + "b-9781718219342" + "&currentTime=" + currDownloadTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname +"&currentImg=" + currentImg + "&cachepagetype=" + "$cachepagetype"+"&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml";
            } else if (doctype == "video") {
	            param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + "b-9781718219342" + "&currentTime=" + currDownloadTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname +"&currentImg=" + currentImg + "&cachepagetype=" + "$cachepagetype";
	        } else if (doctype == "image") {
		     	isCitationExist = true;
				param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + "b-9781718219342" + "&currentTime=" + currDownloadTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname +"&currentImg=" + currentImg+ "&citationExist=" + isCitationExist + "&cachepagetype=" + "$cachepagetype";
		 	} else if (doctype == "da-volume" || doctype == "archive" || doctype == "da-volume-part") {
		 		param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + documentId + "&currentTime=" + currDownloadTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname + "&workloc=" + "$workLoc"+"&productVersion=" + 52 + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&citationExist=" + isCitationExist + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype" + "&currentImg=" + currentImg;
		 	} else if (doctype == "screenplay" || doctype == "playtext") {
									isCitationExist = true;
								param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + documentId + "&currentTime=" + currDownloadTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname + "&workloc=" + "$workLoc"+"&productVersion=" + 52 + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&citationExist=" + isCitationExist + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
				var playtextPage = "$playtextPage";
		        if ( playtextPage == "playtext-detail"){
		        	param += "&actId=" + "$actId";
		        }
			} else {  
			  						isCitationExist = true;
						  	
	          	param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + "b-9781718219342" + "&currentTime=" + currDownloadTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname + "&citationExist=" + isCitationExist + "&workloc=" + "$workPath" +"&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
		  	    
		  	}
		  	if ($('#pdf-name').length > 0) {
		  				  			param+="&pdfUrl=/content-types/"+doctype+"/"+$('#pdf-name').val()+"&pdfId=/"+$('#pdf-name').val().split("pdfs/")[1];
		  				  	}
		  	if ("b-9781718219342-chapter14" != "" && $('#chapter-pdfId').val() != null) {
		  		if ($('#chapter-pdfId').val().length > 0) {
		  			param += "&chapterPdfId=" +$('#chapter-pdfId').val().split("pdfs/")[1];
		  		}
		  	}
		  	var openAcc = $(".open-access").length;
            if ("b-9781718219342-chapter14" != '') {
                param += "&tocPage=false";
            } else if(openAcc > 0) {
                param += "&tocPage=true";
            } else {
                param += "&tocPage=false";
            }
            var epdfIsbn = $.trim($("#epdf-isbn-squid").val());
            if(epdfIsbn != "false") {
            	param += "&epdfIsbn="+$("#epdf-isbn-squid").val();
            }
            
		  	param+="&docIdS=b-9781718219342-chapter14";
		  	var openAcc = $(".open-access").length;
		  	if(openAcc > 0){
		  		param+="&openAccess=true";
		  	} else {
		  	param+="&openAccess=false";
		  	}
		  	if (doctype == "professional") {
		  		param+="&contentType="+doctype+"&taxonomyLoc="+"hklp/52/content-types/taxonomy/taxonomy.xml"+"&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId);
// 		  		param+="&taxonomyLoc="+"hklp/52/content-types/taxonomy/taxonomy.xml"+"&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId);
		  	}
		  	
		  	$("#download").attr('href', '/app/downloadpdf?'+param);
		  	var OS = getMobileOperatingSystem();
		  	if (OS == "iOS") {
				$("#download").attr('href', '/app/downloadpdf.pdf?'+param);	
			}
		  	$("#download").attr('target', '_blank');
		  	$("#download").attr('download', 'b-9781718219342'+'-'+lang+'.pdf');  
		} catch (err) {
			console.log("Error in createPdf function::", err);	
		}
  	},
      createFrame: function() {
  		try {
	        var currentImg = '';
	        var GMTIndex;
	        var openAccess= $(".open-access").length > 0? "true":"false";
	        var currPrintTime = (new Date()).toString().split(' ');
	        var printType = $('input[name="print-type"]:checked').val();
	        var selectedImages="";
	        var docIdF="";
	        	            docIdF = "b-9781718219342-chapter14";
	        	        if(printType=="range"){
	        	var printFrom = $("#print-from").val();
		        var printTo = $("#print-to").val();
		        var imageUrls = $("#buildprevimagelist").val().split("~");
		        for(var i=printFrom-1; i<printTo; i++){
		        	if(selectedImages==""){
		        		selectedImages=imageUrls[i];
		        	}else{
		        		selectedImages+="~"+imageUrls[i];
		        	}
		        }
	        }
	        for (var i = 0; i < currPrintTime.length; i++) {
	            if (currPrintTime[i].indexOf('GMT') > -1 || currPrintTime[i].indexOf('UTC') > -1) {
	                GMTIndex = i;
	            }
	            if (currPrintTime[i].indexOf('(') > -1) {
	                currPrintTime[i] = currPrintTime[i].split('(')[1];
	            }
	            if (currPrintTime[i].indexOf(')') > -1) {
	                currPrintTime[i] = currPrintTime[i].split(')')[0];
	            }
	        }
	        if (GMTIndex !== undefined) {
	            currPrintTime.splice(GMTIndex, 1);
	        }
	        currPrintTime = currPrintTime.join(' ');

	        if ($('#selected-image-url').length > 0) {
	            currentImg = $('#selected-image-url').val();
	            if(doctype=="catalogue"){
	            	var index =  $('#selected-image-url').attr('data-index');
	            	currentImg =  $("#buildprevimagelist").val().split("~")[index];
	            }
	        } else if($('#coverImage').length>0){
				currentImg = $('#coverImage').attr('src') || $('#coverImage').val();
			} else if($('#coverImageUrl').length>0){
				currentImg = $('#coverImageUrl').attr('src') || $('#coverImageUrl').val();
			}

			if(~currentImg.indexOf('?id=')) {
				currentImg = currentImg.split('?id=')[1];
			}

	        if (typeof partId !== "undefined") {
		      	if (partId.startsWith("$")) {
		          	partId = "";
		      	}
	      	}
	        $(".print_page").attr('href', 'javascript:;');
			$(".print_page").removeAttr('target');
			$(".print_page").removeAttr('download');  
	        var xmlreq = new XMLHttpRequest();
	        xmlreq.onreadystatechange = function () {
	            if (xmlreq.readyState == 4 && xmlreq.status == 200) {
	            	//hideProgress();
	                var response = xmlreq.responseText;
	                if ($("#pdf-name").length > 0) {
	                	$("#printFrame").remove();
	                	var OS = getMobileOperatingSystem();
	                	if (isIE || isFirefox || OS == "Android" || OS == "iOS") {
	                		param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + "b-9781718219342" + "&currentTime=" + currPrintTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname + "&citationExist=true" + "&workloc=" + "$workPath" +"&territory=" + "" + "&cachepagetype=" + "$cachepagetype" + "&docIdS=b-9781718219342-chapter14";
	                		param+="&pdfUrl=/content-types/"+doctype+"/"+$('#pdf-name').val()+"&pdfId=/"+$('#pdf-name').val().split("pdfs/")[1];
	                		if ("b-9781718219342-chapter14" != "" && $('#chapter-pdfId').val() != null) {
						  		if ($('#chapter-pdfId').val().length > 0) {
						  			param += "&chapterPdfId=" +$('#chapter-pdfId').val().split("pdfs/")[1];
						  		}
						  	}
	                		var epdfIsbn = $.trim($("#epdf-isbn-squid").val());
				            if(epdfIsbn != "false") {
				            	param += "&epdfIsbn="+$("#epdf-isbn-squid").val();
				            }
	                		$(".print_page").attr('href', '/app/downloadpdf?'+param+'&print_page=true');
						  	$(".print_page").attr('target', '_blank');
						  	$(".print_page").attr('download', 'b-9781718219342'+'-'+lang+'.pdf');
						  	if (OS == "Android") {
						  		$(".print_page").attr('download', 'b-9781718219342'+'-'+lang+'.pdf');
						  	} else if (OS == "iOS") {
						  		$(".print_page").attr('href', '/app/downloadpdf.pdf?'+param+'&print_page=true');	
						  	}
	                	} else {
	                		var frame1 = document.createElement('iframe');
			                frame1.name = "frame1";
			                frame1.id = "printFrame";
			                frame1.style.position = "absolute";
			                frame1.style.visibility = "hidden";
			                frame1.style.display = "none";
			                frame1.style.top = "-1000000px";
			                frame1.src = "/app/getpdf?id=/downloads/"+$("#pdf-name").val().split("pdfs/")[1]+"&mode=print";
			                window.printContents = response;
			                document.body.appendChild(frame1);
	                	}
	                } else {
	                	if(xmlreq.responseText.indexOf('MapPlaceHolder') > -1){
		                									response = response.replace('MapPlaceHolder', '<div style="width: 100%; margin-bottom: 10px; height: 200px; position: relative; overflow: hidden;" class="leaflet-container leaflet-touch leaflet-retina leaflet-fade-anim leaflet-touch-zoom">' + $('#globalMap').html().split('href=').join('data-href=').split('<div class="gmnoprint').join('<div class="gmnoprint hide').split('<div class="gmnoscreen').join('<div class="gmnoscreen hide') + '</div>');
								response = '<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"			   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="	crossorigin=""/>' + response;
							
		                }
                        if (~response.indexOf('mml:')) {
                            response = response.replaceAll("mml:", "");
                        }
		                window.printContents = response;
		                var OS = getMobileOperatingSystem();
		                $("#printFrame").remove();
		                var frame1 = document.createElement('iframe');
		                frame1.name = "frame1";
		                frame1.id = "printFrame";
		                frame1.style.position = "absolute";
		                frame1.style.top = "-1000000px";
		                document.body.appendChild(frame1);
		                var frameDoc = frame1.contentWindow ? frame1.contentWindow : frame1.contentDocument.document ? frame1.contentDocument.document : frame1.contentDocument;
		                frameDoc.document.open();
		                frameDoc.document.write(response);
		                frameDoc.document.close();
		            	$(".print_waiting").addClass("hide");
		            	$(".print_loading").addClass("hide");
		            	$(".print_ready").removeClass("hide");
	                }
	            }
	        };
	        xmlreq.open("POST", "/app/print", true);
	        xmlreq.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	        var param='';
	        var mlaCitation = '';
			var hasCitation = '';
				        if (doctype == "image") {
	            param = 'xmlPath=content-types/image/image.xml&xsltPath=content-types/image/image-print.xsl';
	        }
	        if (doctype == "audio") {
	            param = 'xmlPath=content-types/audio/audio.xml&xsltPath=content-types/audio/audio-print.xsl';
	        }
	        if (doctype == "video") {
	            param = 'xmlPath=content-types/video/video.xml&xsltPath=content-types/video/video-print.xsl';
	        }
	        if (doctype == "person") {
	            mlaCitation = '';
	               param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&productVersion=" + 52 + "&productName="+ productname + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
	        if (doctype == "monograph" ) {
	            mlaCitation = '';
									var xslPath = $("#pdf-name").length>0?"/content-types/encyclopedia/chapter-download.xsl":"/content-types/encyclopedia/chapter-print.xsl";
	                param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + xslPath + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId + "&tocId=" +"b-9781718219342-chapter14" + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
					        }
			if (doctype == "encyclopedia") {
				var xslPath = $("#pdf-name").length>0?"/content-types/encyclopedia/chapter-download.xsl":"/content-types/encyclopedia/chapter-print.xsl";
	            param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + xslPath + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	            	        }
	        if (doctype == "dictionary") {
	            mlaCitation = encodeURIComponent(mlaCitation);
				param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=dictionary" + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&workloc=" + "$dictionaryWork" + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
	        if (doctype == "sourcetype") {
	        	param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=sourcetype" + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
						if (doctype == "building") {
	            mlaCitation = '';
	            param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId + "&tocId=" + "b-9781718219342-chapter14"+"&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
			
						if (doctype == "museum") {
	            mlaCitation = '';
	            param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId + "&tocId=" + "b-9781718219342-chapter14" + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }

	        if (doctype == "imagecollection") {
	            mlaCitation = '';
	            param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId + "&tocId=" + "b-9781718219342-chapter14" + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
			
			
						if (doctype == "image") {
	            mlaCitation = '';
	         param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId+ "&tocId=" + "b-9781718219342-chapter14" + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" 
			 + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
			
			
						if (doctype == "video") {
	            mlaCitation = '';
	         param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId+ "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)+"&productName="+ productname + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
						if (doctype == "audio") {
	            mlaCitation = '';
	         param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + mlaCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype=" + doctype + "&docid=" + documentId+ "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)+"&productName="+ productname + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
			if (doctype == "article") {
	               param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&workloc=" + "$articleWork" + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
	        if (doctype == "businesscase") {
	               param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml" + "&workloc=" + "$articleWork" + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
			if (doctype == "screenplay") {
	               param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&productVersion=" + 52 + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml"+ "&workloc=" + "$workFileLoc" + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
	        }
	        if (doctype == "playtext") {
               param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&productVersion=" + 52 + "&taxonomyLoc=" + "hklp/52/content-types/taxonomy/taxonomy.xml"+ "&workloc=" + "$workFileLoc" + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
               var playtextPage = "$playtextPage";
               if ( playtextPage == "playtext-detail"){
               	param += "&actId=" + "$actId";
               }
        	}
			if(doctype == "da-volume" || doctype == "archive" || doctype == "da-volume-part"){
	               param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
			}

            if(doctype=="catalogue"){
                param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-print.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype"+ "&printType="+printType + "&selectedImages="+selectedImages;
            }
            
            if(doctype=="professional"){
            	const metadata = [];
				$(".category_table ul > li").each(function () {
				    if ($(this).text().trim() !== "Notes") {
				        const catTab1Value = $(this).find(".cat_tab1").text().trim();
				        const catTab2Value = $(this).find(".cat_tab2").text().trim();
				        metadata.push([catTab1Value, catTab2Value]);
				    }
				});
				var metadataParam = JSON.stringify(metadata);
				var title = $(".title-section").find("div > h2").text();
				var isNotesPresent = false;
				var noteDiv = $("div.note");
				if (noteDiv.length > 0) {
				    var h3Text = noteDiv.find("h3").text().trim();
				    if (h3Text.toLowerCase() === "notes") {
				        isNotesPresent = true;
				    }
				}
				var xslPath = $(".pdf-content").length > 0?"/content-types/encyclopedia/chapter-download.xsl":$(".word-content").length > 0?"/content-types/encyclopedia/chapter-download.xsl":"/content-types/encyclopedia/chapter-print.xsl";
	            param = "xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + xslPath + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&hasCitation=" + hasCitation + "&partId=" + partId + "&lang=" + lang + "&currentImg=" + currentImg + "&currentdate=" + currPrintTime + "&doctype="+ doctype + "&docid=" + documentId + "&tocId=" +("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId) + "&productName="+ productname + "&productVersion=" + 52 + "&territory=" + "" + "&cachepagetype=" + "$cachepagetype"+"&metaData="+metadataParam+"&title="+title+"&isNotesPresent="+isNotesPresent; 
            }

			if ($("#pdf-name").length > 0) {
				param+="&pdfUrl=/content-types/"+doctype+"/"+$("#pdf-name").val()+"&pdfId=/"+$("#pdf-name").val().split("pdfs/")[1];
			}

			param+="&docIdS=b-9781718219342-chapter14"+"&openAccess="+openAccess+"&docIdF="+docIdF;
			
	        //showProgress();
	        if ($("#pdf-name").length > 0) {
		        param = "type=" + doctype + "&xmlPath=" + "hklp/52/content-types/encyclopedia/9781718219342_txt_xml.xml" + "&xsltPath=" + "/content-types/encyclopedia/chapter-download.xsl" + "&productLogo=" + "https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/hkl/Static/HKL_Logo.png" + "&mlaCitation=" + "&lang=" + lang + "&documentId=" + "b-9781718219342" + "&currentTime=" + currPrintTime + "&tocId=" + ("b-9781718219342-chapter14" != "" ? "b-9781718219342-chapter14" : documentId)  + "&productName="+ productname + "&citationExist=true" + "&workloc=" + "$workPath" +"&territory=" + "" + "&cachepagetype=" + "$cachepagetype";
		        param+="&pdfUrl=/content-types/"+doctype+"/"+$('#pdf-name').val()+"&pdfId=/"+$('#pdf-name').val().split("pdfs/")[1];
		        param+="&docIdS=b-9781718219342-chapter14";
		        if ("b-9781718219342-chapter14" != "" && $('#chapter-pdfId').val() != null) {
			  		if ($('#chapter-pdfId').val().length > 0) {
			  			param += "&chapterPdfId=" +$('#chapter-pdfId').val().split("pdfs/")[1];
			  		}
			  	}
		        var epdfIsbn = $.trim($("#epdf-isbn-squid").val());
	            if(epdfIsbn != "false") {
	            	param += "&epdfIsbn="+$("#epdf-isbn-squid").val();
	            }
		        $(".print_page").attr('href', '/app/downloadpdf?'+param+'&print_page=true');
				$(".print_page").attr('target', '_blank');
				$(".print_page").attr('download', 'b-9781718219342'+'-'+lang+'.pdf');
				var OS = getMobileOperatingSystem();
				if (OS == "Android") {
					$(".print_page").attr('download', 'b-9781718219342'+'-'+lang+'.pdf');
				} else if (OS == "iOS") {
					$(".print_page").attr('href', '/app/downloadpdf.pdf?'+param+'&print_page=true');	
				}
				$(".print_waiting").addClass("hide");
		        $(".print_loading").addClass("hide");
		        $(".print_ready").removeClass("hide");
	        }else if ($(".pdf-content").length > 0) {
                $(".pdf-content").each(function(){
                    var pdfFileName = $(this).find(".pdf-file-name").val();
                    if(pdfFileName){
                        var pdfName = ~pdfFileName.indexOf("/")?pdfFileName.split("/")[1]:pdfFileName;
                        var downType = pdfName.split(".").pop();
                        param += "&type=" + doctype +"&chapterPdfId=" +pdfName+"&downloadType="+downType+ "&documentId=" + "b-9781718219342"+ "&downloadFrom=" + "print"+ "&currentTime=" + currPrintTime;
                        $(".print_page").attr('href', '/app/printPdfDownload?'+param+'&print_page=true');
                        $(".print_page").attr('target', '_blank');
                        $(".print_page").attr('download', pdfName);
                    }
                    $(".print_waiting").addClass("hide");
                    $(".print_loading").addClass("hide");
                    $(".print_ready").removeClass("hide");                   
                });
            }else if ($(".word-content").length > 0) {
                $(".word-content").each(function(){
                    var docName = $(this).find(".word-file-name").val();
                    if(docName){
	                    var id = ~docName.indexOf("/")?docName.split("/")[1]:docName;
	                    var downType = id.split(".").pop();
	                    param += "&type=" + doctype + "&id=" + id + "&downloadType="+downType+ "&documentId=" + "b-9781718219342"+ "&downloadFrom=" + "print"+ "&currentTime=" + currPrintTime;
	                    $(".print_page").attr('href', '/app/printPdfDownload?'+param+'&print_page=true');
	                    $(".print_page").attr('target', '_blank');
	                    $(".print_page").attr('download', id);
                    }
                    $(".print_waiting").addClass("hide");
                    $(".print_loading").addClass("hide");
                    $(".print_ready").removeClass("hide");
                });
            }else {
	        	xmlreq.send(param);
	        }
	    } catch (err) {
			console.log("Error in createFrame function::", err);	
		}		
    },
    doHashScroll: function() {
        try {
            var hashUrl = window.location.hash;
            if (hashUrl) {
                if (~hashUrl.indexOf("#")) {
                    hashUrl = hashUrl.split("#")[1];
                }
                if (~hashUrl.indexOf("&")) {
                    hashUrl = hashUrl.split("&")[0];
                }
                var jObject = $("*[id='"+hashUrl+"']");
                if (jObject.length > 0) {
                    jObject.css("display", "block");                    jObject[0].scrollIntoView();
                }
            }
        } catch (err) {
            console.log("Error in doHashScroll function::", err);    
        }
    },
                    bindImageViewerImageResize: function() {
        var self = this;
        $(window).resize(function(e){
            self.imageViewerImageResize("resize");
        });
        window.addEventListener('orientationchange', function(e){
            self.imageViewerImageResize("orientation");
        });
    },
    imageViewerImageResize: function(event) {
        var screenWidth = $(window).width();
        var currentChannel = isDesktop;
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || screenWidth <= 1024) {
                isDesktop = false;
        } else {
            isDesktop = true;
        }
        if (isfullscreen) {
            if (!(event == "resize" && (window.orientation == 90 || window.orientation == 0))) {
                $(".control-small-screen").click();
            }                
        }
        if (isDesktop) {
            $("#image-controls-fullscreen-toolbar").addClass("hide");
        } else {
            $("#image-controls-fullscreen-toolbar").removeClass("hide");
        }
        if (currentChannel != isDesktop) {
            var activeItem = $(".photo_gallery .prev-images .owl-item.active .sub-image");
            var activeId = activeItem.attr("id");
            var currentViewer = OpenSeadragon({id: activeId});
            currentViewer.destroy();
            var currentUrl = $("#selected-image-url").val();
            if ($('.building_galley').length>0) {
                var currentIndex = $("#selected-image-url").attr("data-index");
                loadContentImageViewer(activeId,previmagelist[currentIndex],isfullscreen);
            } else {
                loadpreviewimage(activeId,currentUrl,istwoview,isfullscreen);
            }
        }
    },
    loadImageSlider: function() {
        var arcadianslider = this.contentImageSlider;
        var screenWidth = $(window).width();
        var currentIndex=5;
        if (screenWidth >= 992) {
            currentIndex = 5;
        } else if (screenWidth >= 768) {
            currentIndex = 4;
        } else if (screenWidth >= 600) {
            currentIndex = 3;
        }else{
            currentIndex = 2;
        }
        var nextseconditem=false;
        var prevseconditem=false;
        var autoplay = false;
        if ($("#slider-transition-value").val() == "true") {
            autoplay = true;
        }
        if (arcadianslider.find('.item').length == 0) {
            $("#playtext-image-gallery").addClass('hide');
        } else if (arcadianslider.find('.item').length >= 3) {
            arcadianslider.find('.owl-carousel').owlCarousel({
                lazyLoad: false,
                loop: true,
                center: true,
                nav: true,
                margin: 20,
                mouseDrag: false,
                touchDrag:false,
                items:3,
                responsive: {
                    1200: {
                        items: 3
                    },
                    992: {
                        items: 3
                    },
                    768: {
                        items: 3
                    },
                    600: {
                        items: 2
                    },
                    320: {
                        items: 2
                    }
                },
                autoplay: autoplay,
                autoplayTimeout: 3000,
                autoplayHoverPause: true
            });
            arcadianslider.off('click').on('click', '.owl-item', function (e) {
                var current=$(this).index();
                var flag=currentIndex-current;
                if(current<currentIndex){
                   arcadianslider.find('.owl-prev').click();
                   if(flag==2){
                       prevseconditem=true;
                   }
                } else if(current>currentIndex){
                   arcadianslider.find('.owl-next').click();
                   if(flag==(-2)){
                       nextseconditem=true;
                    }
                }
            }).off('changed.owl.carousel').on('changed.owl.carousel', function (e) {
                currentIndex=e.item.index;
                if(nextseconditem) {
                    arcadianslider.find('.owl-next').click();
                    nextseconditem=false;
                }
                if(prevseconditem) {
                    arcadianslider.find('.owl-prev').click();
                    prevseconditem=false;
                }
                arcadianslider.find(".owl-item a").attr("tabindex", -1);
                //$(".playtext-image-slider .owl-item.active.center a").removeAttr("tabindex");
            });
            arcadianslider.find(".owl-item a").attr("tabindex", -1);
           // $(".playtext-image-slider .owl-item.active.center a").removeAttr("tabindex");
            
            $(".image-slider-layout .owl-controls .owl-nav div").attr("tabindex", "0").on("keyup", function(e){
                if (e.keyCode == 13) {
                    $(this).click();
                }
            }).on("click", function(e) {
                //playPause.find(".fa-play").addClass("hide");
                //playPause.find(".fa-pause").removeClass("hide");
            }).each(function(){
                if($(this).hasClass("owl-prev")) {
                    $(this).attr("title", "Previous Item");
                }
                if($(this).hasClass("owl-next")) {
                    $(this).attr("title", "Next Item");
                }
            });
            $(".image-slider-layout .owl-controls .owl-dots .owl-dot span").attr("tabindex", "0").on("keyup", function(e){
                if (e.keyCode == 13) {
                    $(this).click();
                }
            }).on("click", function(e) {
                //playPause.find(".fa-play").addClass("hide");
                //playPause.find(".fa-pause").removeClass("hide");
            }).each(function(index){
                $(this).attr("title", "Select Item "+(index+1))
            });
            //var playPause = $(".play-pause-indicator").clone();
            //playPause.appendTo(".image-slider-layout .owl-controls");
            //playPause.removeClass("hide");
            /*playPause.find('div').off().on("keyup click", function(e){
                e.stopImmediatePropagation();
                e.stopPropagation();
                if (e.type == "click" || e.keyCode == 13) {
                    if ($(this).hasClass("fa-pause")) {
                        arcadianslider.find('.owl-carousel').trigger("stop.owl.autoplay");    
                    } else {
                        arcadianslider.find('.owl-carousel').trigger("play.owl.autoplay", [3000]);
                    }
                    $(this).addClass("hide");
                    $(this).siblings().removeClass("hide");
                    $(this).siblings().focus();
                    arcadianslider.find(".owl-item .link-active").attr("tabindex","-1");
                }
            });*/
            arcadianslider.on("focusin", function(e){
                if (!$(e.target).hasClass("fa-pause") && !$(e.target).hasClass("fa-play")) {
                    arcadianslider.find('.owl-carousel').trigger("stop.owl.autoplay");
                    // arcadianslider.find(".owl-item.active.center .item").attr("tabindex", 0);
                }
            });
            arcadianslider.find(".owl-item").on("focusout", function(e){
                arcadianslider.find(".owl-item .item").attr("tabindex","-1");
                //arcadianslider.find('.owl-carousel').trigger("play.owl.autoplay", [3000]);
            }).on("keyup", function(e){
                if (e.keyCode == 13) {
                    $(this).click();
                }
            });
            arcadianslider.find(".owl-carousel").on("stop.owl.autoplay" , function(e){
                //playPause.find(".fa-pause").addClass("hide");
                //playPause.find(".fa-play").removeClass("hide");
            });
            arcadianslider.find(".owl-carousel").on("play.owl.autoplay" , function(e){
                //playPause.find(".fa-play").addClass("hide");
                //playPause.find(".fa-pause").removeClass("hide");
            });
            arcadianslider.find(".owl-item .item").on("keyup", function(e){
                if (e.keyCode == 13) {
                    e.preventDefault();
                    if ($(this).parent().hasClass("active") && $(this).parent().hasClass("center")) {
                        window.location.href = $(this).find(".right a").attr("href");
                    }
                }
            });    
        } else {
            arcadianslider.find('.owl-carousel').removeClass('loop owl-carousel').find('.item').addClass('singles');    
       }
    },
        imageViewerFullScreenKeyup: function() {
        $(document).on("keyup",".control-small-screen,.control-full-screen", function(e) {
            if (e.keyCode == 13) {
                $(this).click();
            }
        });
    },
    imageViewerControlIconsFocus: function() {
        $(document).on("focusin",".image-viewer-controls .control-icon>span", function(e) {
            $(this).parent().attr("style", "background: rgba(255, 255, 255, 1);");
        });
        $(document).on("focusout",".image-viewer-controls .control-icon>span", function(e) {
            $(this).parent().removeAttr("style");
        });
    },
    bindPdfViewerResize: function() {
        var self = this;
        $(window).resize(function(e){
            self.pdfViewerResize("resize");
        });
        window.addEventListener('orientationchange', function(e){
            self.pdfViewerResize("orientation");
        });
    },
    pdfViewerResize: function(event) {
        var screenWidth = $(window).width();
        var currentChannel = true;
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || screenWidth <= 1024) {
            currentChannel = false;
        } else {
               currentChannel = true;
        }
        var iframeHeight = "100%";
        if (!currentChannel) {
               iframeHeight = "450px";
        }
        $("#pdf-content iframe").attr("height", iframeHeight);
    },
    transcriptUpdate: function() {
        try {
            var currentUrl = window.location.href;
            if (~currentUrl.indexOf('&s=') || ~currentUrl.indexOf('&e=')) {
                var visibleTranscript = [];
                var startpoint = $.urlParam("s");
                var endpoint = $.urlParam("e");
                startpoint = !isNaN(parseInt(startpoint))?parseInt(startpoint)*1000:0;
                endpoint = !isNaN(parseInt(endpoint))?parseInt(endpoint)*1000:0;
                $(".p3sdk-interactive-transcript-content p").each(function(){
                  var millisecondstart = parseInt($(this).find("span:first").attr("m"));
                  var millisecondend = parseInt($(this).find("span:last").attr("m"));
                  millisecondstart = !isNaN(millisecondstart)?millisecondstart:0;
                  millisecondend = !isNaN(millisecondend)?millisecondend:0;
                  if (millisecondend < startpoint || (millisecondstart > endpoint && endpoint != 0)) {
                    $(this).css("display", "none");
                  } else {
                      visibleTranscript.push($(this));
                  }
                });
                if (visibleTranscript.length > 0) {
                    var prevElement = visibleTranscript[0].prev();
                    let nextElement =(visibleTranscript[visibleTranscript.length - 1]).next();
                    if (prevElement.length > 0) {
                      prevElement.css("display", "block");
                    }
                    if (nextElement.length > 0) {
                      nextElement.css("display", "block");
                    }
                }
            }
        } catch (err) {
            console.log("Error in transcriptUpdate function::", err);    
        }
    },
    imageDownloadEnable: function() {
        try {
            if ($("#image-download-flag").length > 0) {
                if ($("#image-download-flag").val() == "true") {
                    $("#download").parent().removeClass("hide");
                }
            }
        } catch (err) {
            console.log("Error in imageDownloadEnable function::", err);
        }
    },
    showStudioContent: function() {
        try {
            if ($("#volume-studio-content li").length > 0) {
                $("#volume-studio-content").removeClass("hide");
            } else {
                $("#volume-studio-content").addClass("hide");
            }
        } catch(err) {
            console.log("Error in showStudioContent function::", err);
        }
    },
    loadStudioQuiz: function() {
        try {
            if ($("#studio-quiz-id").length > 0 && $("#quizContent").length > 0) {
                var studioQuizId = $("#studio-quiz-id").val();
                
                $('#quizContent').load("/app/qzmaker?quizid="+studioQuizId+"&actionType=load #quizFullContent", function() {
                      setTimeout(function() {
				   	$("#quizFullContent").removeAttr("aria-hidden");
					$("#qz-section-heading").attr("tabindex","-1").focus();
					enhanceExternalLinks();
	  				}, 50);
                });
                
                
                 $(document).on("mouseover", ".tooltip-button", function () {
		const btn = this;
		const tooltip = document.getElementById(btn.dataset.tooltipId);
		showTooltip(btn, tooltip);
	  });

	  $(document).on("mouseout", ".tooltip-button", function () {
		const btn = this;
		const tooltip = document.getElementById(btn.dataset.tooltipId);
		hideTooltip(btn, tooltip);
	  });

	  $(document).on("click", ".tooltip-button", function (event) {
		event.preventDefault();
		const btn = this;
		const tooltip = document.getElementById(btn.dataset.tooltipId);
		toggleTooltip(btn, tooltip);
	  });	
                
                $(document).on('submit', '#quiz_data_form', function(event) {
                    event.preventDefault();
                    var quizSubmission = $(this).serializeArray();
                    var quizPostData = {};
                    for(var x=0;x<quizSubmission.length;x++) {
                        var objectName = quizSubmission[x].name;
                        var objectValue = quizSubmission[x].value;
                        quizPostData[objectName] = objectValue;
                    }

                    $.ajax({
                        url: "/app/qzmaker",
                        type: "POST",
                        data: "quizData="+JSON.stringify(quizPostData),
                        success: function(data) {
                            $("#quizQResults").html(data);
                            $('#quizQContent').html("&nbsp;");
                             if ($("#printFrame").length > 0) {
                                $("#printFrame")[0].contentWindow.postMessage(data, "*");
                            } else {
                                window.quizPrintUpdate = data;
                            }
                            $("#quizQResults .container div .row:first b:last").append('<a title="Email your score and quiz results" href="javascript:void(0);" id="email-quiz-results" class="ml-10"><span class="glyphicon glyphicon-envelope" aria-hidden="true"></span> Email</a>');
                            //document.querySelector('#quizContent').scrollIntoView({behavior: 'smooth'});
                            const heading = document.getElementById("qz-heading");
                            if (heading) {
                                heading.scrollIntoView({ behavior: "smooth", block: "start" });
                            }
                            
                            
                           setTimeout(function() {
							var scoreText = $("#qz-score").text(); 
							var announcement = "Quiz Submitted Results. " + scoreText + ". ";
							$("#aria-status").text(""); // clear first
							setTimeout(function() {
								$("#aria-status").text(announcement);
							}, 50);						
							$("#quizFullContent").removeAttr("aria-hidden");
							$("#qz-section-heading").attr("tabindex","-1").focus();
							enhanceExternalLinks();
						}, 50);
                        },
                        error: function(error) {
                            hideProgress();
                        }
                    });
                });

                /*$(document).on("click", "#qzsubbutton", function(event){
                    event.preventDefault();
                    $.post("/qzmaker/public/quiz-results-ajax", 
                           $("#quiz_data_form").serialize(), 
                           function(data) {
                                $("#quizQResults").html(data);
                                $('#quizQContent').html("&nbsp;");
                                const heading = document.getElementById("qz-heading");
                                if (heading) {
                                    heading.scrollIntoView({ behavior: "smooth", block: "start" });
                                }
                                $("#quizQResults").focus();
                    });
                });*/    
                
                $(document).on("click", "#qzsubbutton", function(event){
					event.preventDefault();
				$.post("/qzmaker/public/quiz-results-ajax", 
		       $("#quiz_data_form").serialize(), 
			   function(data) {
					$("#quizQResults").html(data);
					$('#quizQContent').html("&nbsp;");
					setTimeout(function() {
							var scoreText = $("#qz-score").text(); 
							var announcement = "Quiz Submitted Results. " + scoreText + ". ";
							$("#aria-status").text(""); // clear first
							setTimeout(function() {
								$("#aria-status").text(announcement);
							}, 50);					
							$("#quizFullContent").removeAttr("aria-hidden");
							$("#qz-section-heading").attr("tabindex","-1").focus();
							enhanceExternalLinks();							
						}, 50);	
		});
	});

                $(document).on("click", "#quizContent .btn", function(e){
                    e.preventDefault();
                    $('#quiz_data_form').submit();
                });     
                $(document).on("click", "#email-quiz-results", function(){
                    $('#quiz-mail-modal').modal('show');
                });
                $(document).on("click", "#quiz-email-btn", function(){
                    if (!$(this).hasClass('disabled-btn')) {
                        var toFlag = false;
                        var yourFlag = false;
                        var yourEmail = $("#quiz-mail-modal #quiz-your-email").val();
                        if (!ValidateEmail(yourEmail)) {
                            $("#quiz-mail-modal #quiz-your-email").css("border", "solid red 1px").siblings("span").removeClass("hide");
                            $("#quiz-mail-modal #quiz-your-email").focus();
                        }
                        else {
                            $("#quiz-mail-modal #quiz-your-email").css("border", "solid #ccc 1px").siblings("span").addClass("hide");
                            yourFlag = true;
                        }
                        var toEmail = $("#quiz-mail-modal #quiz-to-email").val();
                        if (!ValidateEmail(toEmail)) {
                            $("#quiz-mail-modal #quiz-to-email").css("border", "solid red 1px").siblings("span").removeClass("hide");
                            $("#quiz-mail-modal #quiz-to-email").focus();
                        }
                        else {
                            $("#quiz-mail-modal #quiz-to-email").css("border", "solid #ccc 1px").siblings("span").addClass("hide");
                            toFlag = true;
                        }
                        if (toFlag && yourFlag) {
                            showProgress();
                            $('#quiz-mail-modal').modal('hide');
                            setQuizContent();
                            var newArr = $("#quiz-mail-form").serializeArray();
                            var newObj = {};
                            $.each(newArr, function(index, value){
                                if (value.value) {
                                    newObj[value.name] = value.value;
                                }
                            });
                            window.formObj = newObj;
                            setTimeout(function() {
                                /* $("#share-via-form").submit(); */
                                $.ajax({
                                    url: "/app/contentemail",
                                    data: newObj,
                                    type: "POST",
                                    success: function (response) {
                                        hideProgress();
                                        $('#quiz-mail-modal').find("input[type='text'],textarea").val("");
                                        $('#share_success_modal').modal('show');
                                    },
                                    error: function (error) {
                                        hideProgress();
                                        //console.log("Service Error");
                                    }
                                });
                            }, 300);
                        }
                    }
                });
                $(document).on("input", "#quiz-mail-modal input, #quiz-mail-modal textarea", function(){
                    enableSendButton();
                });
                function enableSendButton() {
                    var enableFlag = true;
                    $("#quiz-mail-modal input[type='text']").each(function(){
                        if (!$(this).val()) {
                            enableFlag = false;
                        }
                    });
                    if (enableFlag) {
                        $("#quiz-email-btn").removeClass("disabled-btn");
                    } else {
                        $("#quiz-email-btn").addClass("disabled-btn");
                    }
                }
                function setQuizContent() {
                    var quizList = $("#quizQResults .row");
                    var questionContent = "";
                    var answerContent = "";
                    var selectedAnswer = "";
                    var correctAnswer = "";
                    var scoreContent = "";
                    var questionNum = 0;
                    quizList.each(function(index){
                        if ($(this).find('video').length > 0 || $(this).find('img').length > 0 || !$.trim($(this).text())){
                        } else if (~$(this).text().indexOf("Your Score")){
                            scoreContent += $.trim($(this).text());
                        } else if (~$(this).text().indexOf("Question ")) {
                            questionNum++;
                            questionContent += questionNum + ". " + $(this).find('label').text() + "~~";
                        } else if ($(this).find('input').length > 0) {
                            var currentLabels = $(this).find('label');
                            currentLabels.each(function(index){
                                answerContent += $.trim($(this).text());
                                if (index != (currentLabels.length - 1)) {
                                    answerContent += ' | ';
                                }
                            });
                            var thisAnswer = " ";
                            if ($(this).find('input:checked').length > 0) {
                                thisAnswer = $.trim($(this).find('input:checked').parent().text());
                            }
                            var thisCorrectAnswer = " ";
                            if ($(this).find('span') && ~$(this).find('span').text().indexOf('incorrect')) {
                                var cloneElement = $(this).clone();
                                cloneElement.find('label').remove();
                                cloneElement.find('span').remove();
                                //cloneElement.find('b').remove();
                                var cloneHtml = cloneElement.html();
                                cloneHtml.split("<br>").forEach(function(value){
                                    if (~value.indexOf("Correct") && value.split("</b>").length > 1) {
                                        thisCorrectAnswer = value.split("</b>")[1].trim();
                                    }
                                });
                                //thisCorrectAnswer += $.trim(cloneElement.text());
                            } else {
                                thisCorrectAnswer = thisAnswer;
                            }
                            answerContent += "~~";
                            thisAnswer += "~~";
                            thisCorrectAnswer += "~~";
                            correctAnswer += thisCorrectAnswer;
                            selectedAnswer += thisAnswer;
                        }
                    });
                    $("input[name='quizQuestions']").val(questionContent.length > 2?questionContent.substring(0,questionContent.length - 2):questionContent);
                    $("input[name='quizAnswers']").val(answerContent.length > 2?answerContent.substring(0,answerContent.length - 2):answerContent);
                    $("input[name='selectedAnswers']").val(selectedAnswer.length > 2?selectedAnswer.substring(0,selectedAnswer.length - 2):selectedAnswer);
                    $("input[name='correctAnswers']").val(correctAnswer.length > 2?correctAnswer.substring(0,correctAnswer.length - 2):correctAnswer);
                    $("input[name='quizScore']").val(scoreContent);
                    $("input[name='quizTitle']").val($.trim($(".studio-title").text()).replaceAll("\n", ""));
                    $("input[name='chapterTitle']").val($.trim($("#title").text()));
                }
               }
        } catch(err) {
            console.log("Error in loadStudioQuiz function::", err);
        }
    },
    loadStudioFlashCards: function() {
        try {
            if ($("#studio-flash-id").length > 0 && $("#flashcardContent").length > 0) {
                var studioFlashId = $("#studio-flash-id").val();
                $('#flashcardContent').load("/app/fcmaker?deckId="+studioFlashId+"&actionType=load #quizFullContent", function(){
                    LoadCards();
                    $("#quizQContent").focus();
                }); 
               }
        } catch(err) {
            console.log("Error in loadStudioFlashCards function::", err);
        }
    },
    hidePrint: function() {
        try {
            if ($("#hide-print").length > 0) {
                $("#print_page").parent().addClass('hide');
               }
        } catch(err) {
            console.log("Error in hidePrint function::", err);
        }
    },
    setMainHeadingForScreenReader: function() {
        try {
            var labelText = "Main Title " + $("#title").text();
            $("#title").attr("aria-label", labelText);
        } catch(err) {
            console.log("Error in setMainHeadingForScreenReader function::", err);
        }
    },
    getSourceMessages: function(site) {
        var self=this;
        try {
            $.ajax({
                url: 'api/searchresult/sourceMessages/'+ site + '/' + this.tocid,
                type: 'GET',
                success: function (response) {
                    if (response) {
                        var stringResponse = response.replaceAll("!amp!", "&");
                        $("#institution-message").find("div").append(stringResponse);
                        if ($("#institution-message").find("div").text()) {
                            $("#institution-message").removeClass("hide");
                        } else {
                            $("#institution-message").find("div").empty();
                            $("#institution-message").addClass("hide");    
                        }
                    } else {
                        $("#institution-message").find("div").empty();
                        $("#institution-message").addClass("hide");
                    }
                }
            });
        } catch(err) {
            console.log("Error in setMainHeadingForScreenReader function::", err);
        }
    },
    getViewAndDownloadCount: function() {
        var self=this;
        try {
            var vdCount;
            var viewCount;
            var downloadCount;
                        var docId = "b-9781718219342";
                                    var tocId = "b-9781718219342-chapter14";
                        tocId = tocId ? tocId: "tocId";
            if($("#openAccess_Id ").val() == 'true'){
                $.ajax({
                    url: 'api/searchresult/getViewDownloadCount/'+ docId + '/'+tocId+ '/'+'true',
                    type: 'GET',
                    success: function (response) {
                        if (response != "") {
                            vdCount = response.split(",");
                            viewCount = vdCount[0]+ " views"
                            downloadCount = vdCount[1]+" downloads";
                            if($("#label-ViewCount")) {
                                $("#label-ViewCount").text(viewCount);
                            }
                            if($("#label-DownloadCount")) {
                                $("#label-DownloadCount").text(downloadCount);
                            }
                            if($(".book-download-count")) {
                                $(".book-download-count").text(vdCount[1]);   
                            }
                        } 
                    }
                });
            }
        } catch(err) {
            console.log("Error in getViewAndDownloadCount function::", err);
        }
    },
    registerTryBoxEvents: function(site) {
        var self=this;
        try {
            var clipboard = new Clipboard('.copy-try');
            clipboard.on('success', function (e) {
                /* IE --- Select Method is not working in IE. Hence, workaround for IE  */
                if (window.clipboardData !== undefined && window.clipboardData !== null) {
                    if (typeof window.clipboardData.setData == 'function') {
                        var elementToCopy = $(e.trigger).parent().parent().find('.surname-section');
                        var contentToCopy = $(elementToCopy).text();
                        window.clipboardData.setData('Text', contentToCopy);
                    }
                }
                /* ---------------------IE fix ends-------------------------------------*/

                //$('.copy-error').css('display', 'none');
                var copySuccess = $(e.trigger).parent().parent().parent().find('.copy-success-text');
                copySuccess.removeClass('hide');
                setTimeout(function(){
                    copySuccess.addClass('hide');
                }, 7000);
            });
            clipboard.on('error', function (e) {
                e.clearSelection();
                $(e.trigger).parent().parent().parent().find('.copy-success-text').addClass('hide');
            });
            
            $(".copy-try").on('click', function(e){
            	dataLayer.push({
                	'event' : 'citation_editor',
                	'interaction_type' : 'Copy'
                });
            });

            $(".italicise-try").on('click', function(e){
                document.execCommand('italic',false,null);
                dataLayer.push({
                	'event' : 'citation_editor',
                	'interaction_type' : 'Italicise'
                });
            });
            
            $(".surname-section").on("keydown", function (e) {
                if (e.keyCode == 73 && (e.metaKey)) {
                    e.preventDefault();
                    document.execCommand('italic',false,null);
                }
            });
            
            var oldYouTryValue = $(".surname-section").text();
            $(".surname-section").on('blur', function () {
            	var newYouTryValue = $(this).text();
                if( newYouTryValue !== oldYouTryValue ) {
                	dataLayer.push({
                    	'event' : 'citation_editor',
                    	'interaction_type' : 'Edit'
                    });
                }
                oldYouTryValue = newYouTryValue;
            });
            
            $(".email-try").on("click", function(e) {
            	
            	dataLayer.push({
                	'event' : 'citation_editor',
                	'interaction_type' : 'Email'
                });
                var copyText = $(this).parent().prev().prev().text();
                var copyHtml = $(this).parent().prev().prev().html();
                //copyHtml = copyHtml.replaceAll("&nbsp;","");
                $("#reference-text-area-hidden").val(copyHtml.replaceAll("<","~s~").replaceAll(">","~e~"));
                $("#reference-text-area").html(copyHtml);
                $("#email-subject-reference").val("You try - "+$("#title").text());
                $("#reference-mail-modal").modal("show");
            });
            $("#ref-share-btn").on("click", function(e){
                $("#reference-text-area-hidden").val($("#reference-text-area").html().replaceAll("<","~s~").replaceAll(">","~e~"));
                var newArr = $("#email-reference-form").serializeArray();
                var newObj = {};
                $.each(newArr, function(index, value){
                    if (value.value) {
                        newObj[value.name] = value.value;
                    }
                });
                var toEmail = $("#to-email-reference").val();
                var toFlag = false;
                if (!ValidateEmail(toEmail)) {
                    $("#to-email-reference").css("border", "solid red 1px").siblings("span").removeClass("hide");
                    $("#to-email-reference").focus();
                } else {
                    $("#to-email").css("border", "solid #ccc 1px").siblings("span").addClass("hide");
                    toFlag = true;
                }
        
                if (!$(this).hasClass('disabled-btn') && toFlag) {
                    $.ajax({
                        url: "/app/contentemail",
                        data: newObj,
                        type: "POST",
                        success: function (response) {
                            hideProgress();
                            $('#reference-mail-modal').modal('hide');
                            $('#share_success_modal').modal('show');
                        },
                        error: function (error) {
                            hideProgress();
                            $('#reference-mail-modal').modal('hide');
                        }
                    });
                }
            });
            $("#email-reference-form").find('input,textarea').on('input', function(e){
                referenceFormValidation();
            });
            $("#reference-mail-modal").on('hidden.bs.modal', function (e) {
                $("#reference-text-area-hidden").val("");
                $("#reference-text-area").val("");
                $("#email-subject-reference").val("");
                $("#to-email-reference").val("").css("border", "solid #ccc 1px").siblings("span").addClass("hide");
            });
            $(".not-sure-link").on("click", function(){
                $("#reference-help-modal").modal("show");
            }).on("keyup", function(e){
                if (e.keyCode == 13) {
                    $(this).click();
                }
            });
            function referenceFormValidation() {
                var enabledFlag = true;
                $("#email-reference-form").find("input,textarea").each(function () {
                    if (!$(this).val()) {
                        enabledFlag = false;
                    } 
                });
                if (enabledFlag) {
                    $("#ref-share-btn").removeClass('disabled-btn');
                } else {
                    $("#ref-share-btn").addClass('disabled-btn');
                }
            }
            $("#atr").selectpicker();
            function adjustInnerPopup() {
                var popupHeight = $('.library-inner-popup').height();
                var imageHeight = popupHeight + 90;
                $('.library-img').height(imageHeight);
            }
            $(window).resize(function(){
                adjustInnerPopup();
            });
            adjustInnerPopup();
            $("#atr").on("change.bs.select", function(e){
                var refStyle = $(this).selectpicker('val');
                var selectedOption = $(this).find('option[value="'+refStyle+'"]');
                if (selectedOption.length > 0) {
                    window.location.href = selectedOption.attr('data-href');
                }
            });
        } catch(err) {
            console.log("Error in setMainHeadingForScreenReader function::", err);
        }
    },
     
    multiplecheckboxAction:function(){
        
        var listOfSeriesCheckBoxIds = [];
        var listOfFileCheckBoxIds = [];
        var customSort = function (a, b) {
            return (Number(a.match(/(\d+)/g)[0]) - Number((b.match(/(\d+)/g)[0])));
        }
        var JsonObject = null;
        //check local storage functionality for enabling checkboxs
        if(localStorage.getItem("selectedCheckBoxItem") != 'null' && localStorage.getItem("selectedCheckBoxItem") != "") {
            JsonObject = JSON.parse(localStorage.getItem("selectedCheckBoxItem"));
            if(JsonObject != null && JsonObject.searchBrowse == true){
                JsonObject =null;
                localStorage.setItem("selectedCheckBoxItem", null);
                localStorage.setItem("EnabledCheckBoxs",false);
                localStorage.setItem("EnabledCheckBoxsAt", "encyclopedia-chapter");
            }else if(JsonObject != null && "encyclopedia-chapter" == "catalogue" && localStorage.getItem("EnabledCheckBoxsAt")== 'fileCatalogue' && JsonObject.searchBrowse == false) {
                JsonObject =null;
                localStorage.setItem("selectedCheckBoxItem", null);
                localStorage.setItem("EnabledCheckBoxs",false);
                localStorage.setItem("EnabledCheckBoxsAt", 'seriesCatalogue');
            }else if(JsonObject != null && "encyclopedia-chapter" == "catalogue-file" && localStorage.getItem("EnabledCheckBoxsAt") == 'seriesCatalogue' && JsonObject.searchBrowse == false) {
                JsonObject =null;
                localStorage.setItem("selectedCheckBoxItem", null);
                localStorage.setItem("EnabledCheckBoxs",false);
                localStorage.setItem("EnabledCheckBoxsAt", 'fileCatalogue');
            }
            if(JsonObject != null && JsonObject.searchBrowse == false) {
                $.each(JsonObject.details,function (i, val){
                    if(val.level == "item") {
                        if (listOfFileCheckBoxIds.indexOf(val.id) === -1 && val.id !== '') {
                            listOfFileCheckBoxIds.push(val.id);
                            if (listOfFileCheckBoxIds.length > 0) {
                                $(".file-catalogue").removeClass("hide");
                                $.each(listOfFileCheckBoxIds,function (i, val){
                                    $("#"+val).prop('checked', true);
                                    $("#select-file-multiple-id").val('View Selected Items');
                                    if($("#select-file-multiple-id").val() == "View Selected Items") {
                                        $("#select-file-second-multiple-id").removeClass("hide");
                                        $(".multiple-file-item-close").removeClass("hide");
                                    }
                                });
                            }
                        }
                    }else if(val.level == "file") {
                        if (listOfSeriesCheckBoxIds.indexOf(val.id) === -1 && val.id !== '') {
                            listOfSeriesCheckBoxIds.push(val.id);
                            if (listOfSeriesCheckBoxIds.length > 0) {
                                $(".series-catalogue").removeClass("hide");
                                $.each(listOfSeriesCheckBoxIds,function (i, val){
                                    $("#"+val).prop('checked', true);
                                    $("#select-multiple-id").val('View Selected Items');
                                    if($("#select-multiple-id").val() == "View Selected Items") {
                                        $("#select-second-multiple-id").removeClass("hide");
                                        $(".multiple-item-close").removeClass("hide");
                                    }
                                });
                            }
                        }
                        if (listOfFileCheckBoxIds.indexOf(val.id) === -1 && val.id !== '') {
                            listOfFileCheckBoxIds.push(val.id);
                            if (listOfFileCheckBoxIds.length > 0) {
                                $(".file-catalogue").removeClass("hide");
                                $.each(listOfFileCheckBoxIds,function (i, val){
                                    $("#"+val).prop('checked', true);
                                    $("#select-file-multiple-id").val('View Selected Items');
                                    if($("#select-file-multiple-id").val() == "View Selected Items") {
                                        $("#select-file-second-multiple-id").removeClass("hide");
                                        $(".multiple-file-item-close").removeClass("hide");
                                    }
                                });
                            }
                        }
                    }
                });
            }
        }else if(localStorage.getItem("selectedCheckBoxItem") == 'null' && localStorage.getItem("EnabledCheckBoxs") == 'true' && localStorage.getItem("EnabledCheckBoxsAt") == 'searchResultPage'){
        	localStorage.setItem("EnabledCheckBoxs",false);
        	localStorage.getItem("EnabledCheckBoxsAt","encyclopedia-chapter");
        }else if(localStorage.getItem("selectedCheckBoxItem") == 'null' && localStorage.getItem("EnabledCheckBoxs") == 'true' && localStorage.getItem("EnabledCheckBoxsAt") == 'seriesCatalogue' && "encyclopedia-chapter" == "catalogue" ) {
            $("#select-multiple-id").val('View Selected Items');
            $('#select-multiple-id').addClass("disabled-btn");
            $(".series-catalogue").removeClass("hide");
            $(".multiple-item-close").removeClass("hide");
        }else if(localStorage.getItem("selectedCheckBoxItem") == 'null' && localStorage.getItem("EnabledCheckBoxs") == 'true' && localStorage.getItem("EnabledCheckBoxsAt") == 'fileCatalogue' && "encyclopedia-chapter" == "catalogue-file") {
            $(".file-catalogue").removeClass("hide");
            $("#select-file-multiple-id").val('View Selected Items');
            $('#select-file-multiple-id').addClass("disabled-btn");
            $(".multiple-file-item-close").removeClass("hide");
        }else {
            localStorage.setItem("EnabledCheckBoxs",false);
        }
        
        //select-multiple-id btn functionality for catalogue content type
        $("#select-multiple-id").on("click", function(){
            if($("#select-multiple-id").val() == "View Selected Items") {
                if(localStorage.getItem("selectedCheckBoxItem") != null && localStorage.getItem("selectedCheckBoxItem") != "") {
                    JsonObject = JSON.parse(localStorage.getItem("selectedCheckBoxItem"));
                    if(JsonObject != null && JsonObject.searchBrowse == false ) {
                        $.each(JsonObject.details, function (i, val){
                            if(i == 0) {
                                var identifier = val.identifier.split("~")[0];
                                window.location.href = "/catalogue-bookmark-viewer?docid="+identifier;
                            }
                        });
                    }
                }
            }
            if(localStorage.getItem("EnabledCheckBoxs") == 'false') {
                $(".series-catalogue").removeClass("hide");
                $("#select-multiple-id").val('View Selected Items');
                $('#select-multiple-id').addClass("disabled-btn");
                $(".multiple-item-close").removeClass("hide");
                localStorage.setItem("EnabledCheckBoxs",true);
                localStorage.setItem("EnabledCheckBoxsAt",'seriesCatalogue');
            }
        });
        
        //select-file-multiple-id btn functionality for catalogue content type
        $("#select-file-multiple-id").on("click", function(){
            if($("#select-file-multiple-id").val() == "View Selected Items") {
                if(localStorage.getItem("selectedCheckBoxItem") != null && localStorage.getItem("selectedCheckBoxItem") != "") {
                    JsonObject = JSON.parse(localStorage.getItem("selectedCheckBoxItem"));
                    if(JsonObject != null && JsonObject.searchBrowse == false ) {
                        $.each(JsonObject.details, function (i, val){
                            if(i == 0) {
                                var identifier = val.identifier.split("~")[0];
                                window.location.href = "/catalogue-bookmark-viewer?docid="+identifier;
                            }
                        });
                    }
                }
            }
            if(localStorage.getItem("EnabledCheckBoxs") == 'false') {
                $(".file-catalogue").removeClass("hide");
                $("#select-file-multiple-id").val('View Selected Items');
                $('#select-file-multiple-id').addClass("disabled-btn");
                $(".multiple-file-item-close").removeClass("hide");
                localStorage.setItem("EnabledCheckBoxs",true);
                localStorage.setItem("EnabledCheckBoxsAt",'fileCatalogue');
            }
        });

        //select-second-multiple-id btn functionality for catalogue content type
        $("#select-second-multiple-id").on("click", function(){
            if(localStorage.getItem("selectedCheckBoxItem") != null && localStorage.getItem("selectedCheckBoxItem") != "") {
                JsonObject = JSON.parse(localStorage.getItem("selectedCheckBoxItem"));
                if(JsonObject != null && JsonObject.searchBrowse == false ) {
                    $.each(JsonObject.details, function (i, val){
                        if(i == 0) {
                            var identifier = val.identifier.split("~")[0];
                            window.location.href = "/catalogue-bookmark-viewer?docid="+identifier;
                        }
                    });
                }
            }
        });
        
      //select-file-second-multiple-id btn functionality for catalogue content type
        $("#select-file-second-multiple-id").on("click", function(){
            if(localStorage.getItem("selectedCheckBoxItem") != null && localStorage.getItem("selectedCheckBoxItem") != "") {
                JsonObject = JSON.parse(localStorage.getItem("selectedCheckBoxItem"));
                if(JsonObject != null && JsonObject.searchBrowse == false ) {
                    $.each(JsonObject.details, function (i, val){
                        if(i == 0) {
                            var identifier = val.identifier.split("~")[0];
                            window.location.href = "/catalogue-bookmark-viewer?docid="+identifier;
                        }
                    });
                }
            }
        });
        
        var jArray = [];
        //series checkbox click functionality for catalogue content type
        $(".series-catalogue input").on("click", function(){
            if(localStorage.getItem("selectedCheckBoxItem") != null && localStorage.getItem("selectedCheckBoxItem") != "") {
                JsonObject = JSON.parse(localStorage.getItem("selectedCheckBoxItem"));
                if(JsonObject != null && JsonObject.searchBrowse == false) {
                    $.each(JsonObject.details,function (i, val){
                        if(val.level == "file") {
                            if (listOfSeriesCheckBoxIds.indexOf(val.id) === -1 && val.id !== '') {
                                listOfSeriesCheckBoxIds.push(val.id);
                            }
                        }else {
                            JsonObject = null;
                            return false;
                        }
                    });
                }else {
                    JsonObject = null;
                }
            }
            var selectedCheckBoxId = $(this).attr("id");
            if ($(this).is(':checked')) {
                var JsonArrayString = null;
                if (listOfSeriesCheckBoxIds.indexOf(selectedCheckBoxId) === -1 && selectedCheckBoxId !== '') {
                    listOfSeriesCheckBoxIds.push(selectedCheckBoxId);
                    listOfSeriesCheckBoxIds.sort(customSort);
                    if(listOfSeriesCheckBoxIds.length > 0 && JsonObject != null) {
                        jArray = [];
                        var count = 0;
                        $.each(listOfSeriesCheckBoxIds, function (i, arrId){
                            $.each(JsonObject.details,function (j, arrObj){
                                if(arrId === arrObj.id) {
                                    jArray.push(arrObj);
                                }else if(arrId == selectedCheckBoxId && count === 0){
                                    var identiValue = $("#"+selectedCheckBoxId).attr("name");
                                    var catalogueLevel = $("#"+selectedCheckBoxId).val();
                                    var xmlSource = "9781718219342_txt_xml.xml";
                                    var jsonObj = {
                                            "id" : selectedCheckBoxId,
                                            "identifier" : identiValue,
                                            "level" : catalogueLevel,
                                            "xmlsource" : xmlSource
                                    };
                                    jArray.push(jsonObj);
                                    count++;
                                }
                            });
                        });
                    }else {
                        jArray = [];
                        var identiValue = $("#"+selectedCheckBoxId).attr("name");
                        var catalogueLevel = $("#"+selectedCheckBoxId).val();
                        var xmlSource = "9781718219342_txt_xml.xml";
                        var jsonObj = {
                                "id" : selectedCheckBoxId,
                                "identifier" : identiValue,
                                "level" : catalogueLevel,
                                "xmlsource" : xmlSource
                        };
                        jArray.push(jsonObj);
                    }
                    var JsonObjectFinal = {
                            searchBrowse : false,
                            details : jArray
                    };
                    JsonArrayString = JSON.stringify(JsonObjectFinal);
                }
                localStorage.setItem("selectedCheckBoxItem", JsonArrayString);
                $("#select-multiple-id").val('View Selected Items');
                if($("#select-multiple-id").hasClass('disabled-btn')) {
                    $('#select-multiple-id').removeClass("disabled-btn");
                    $("#select-second-multiple-id").removeClass("hide");
                    $("#select-second-multiple-id").val('View Selected Items');
                }
            }else{
                jArray = [];
                var JsonArrayString = null;
                listOfSeriesCheckBoxIds = listOfSeriesCheckBoxIds.filter(item => item !== selectedCheckBoxId)
                if(listOfSeriesCheckBoxIds.length > 0 && JsonObject != null) {
                    listOfSeriesCheckBoxIds.sort(customSort);
                    $.each(listOfSeriesCheckBoxIds, function (i, arrId){
                        $.each(JsonObject.details,function (j, arrObj){
                            if(arrId === arrObj.id) {
                                jArray.push(arrObj);
                            }
                        });
                    });
                    var JsonObjectFinal = {
                            searchBrowse : false,
                            details : jArray
                    };
                    JsonArrayString = JSON.stringify(JsonObjectFinal);
                }
                localStorage.setItem("selectedCheckBoxItem", JsonArrayString);
            }
            if(listOfSeriesCheckBoxIds.length == 0) {
                $("#select-multiple-id").val('View Selected Items');
                $('#select-multiple-id').addClass("disabled-btn");
                if($("#select-multiple-id").hasClass('disabled-btn') && $("#select-multiple-id").val() == "View Selected Items") {
                    $("#select-second-multiple-id").addClass("hide");
                }
            }
        });
        
        //file checkbox click functionality for catalogue content type
        var jsonArray = [];
        $(".file-catalogue input").on("click", function(){
            if(localStorage.getItem("selectedCheckBoxItem") != null && localStorage.getItem("selectedCheckBoxItem") != "") {
                JsonObject = JSON.parse(localStorage.getItem("selectedCheckBoxItem"));
                if(JsonObject != null && JsonObject.searchBrowse == false) {
                    $.each(JsonObject.details,function (i, val){
                    	 if (listOfFileCheckBoxIds.indexOf(val.id) === -1 && val.id !== '') {
                             listOfFileCheckBoxIds.push(val.id);
                         }
                    });
                }else {
                    JsonObject = null;
                }
            }
            var selectedCheckBoxId = $(this).attr("id");
            if ($(this).is(':checked')) {
                var JsonArrayString = null;
                if (listOfFileCheckBoxIds.indexOf(selectedCheckBoxId) === -1 && selectedCheckBoxId !== '') {
                    listOfFileCheckBoxIds.push(selectedCheckBoxId);
                    listOfFileCheckBoxIds.sort(customSort);
                    if(listOfFileCheckBoxIds.length > 0 && JsonObject != null) {
                        jsonArray = [];
                        var count = 0;
                        $.each(listOfFileCheckBoxIds, function (i, arrId){
                            $.each(JsonObject.details,function (j, arrObj){
                                if(arrId === arrObj.id) {
                                    jsonArray.push(arrObj);
                                }else if(arrId == selectedCheckBoxId && count === 0){
                                    var identiValue = $("#"+selectedCheckBoxId).attr("name");
                                    var catalogueLevel = $("#"+selectedCheckBoxId).val();
                                    var xmlSource = "9781718219342_txt_xml.xml";
                                    var jsonObj = {
                                            "id" : selectedCheckBoxId,
                                            "identifier" : identiValue,
                                            "level" : catalogueLevel,
                                            "xmlsource" : xmlSource
                                    };
                                    jsonArray.push(jsonObj);
                                    count++;
                                }
                            });
                        });
                    }else {
                        jsonArray = [];
                        var identiValue = $("#"+selectedCheckBoxId).attr("name");
                        var catalogueLevel = $("#"+selectedCheckBoxId).val();
                        var xmlSource = "9781718219342_txt_xml.xml";
                        var jsonObj = {
                                "id" : selectedCheckBoxId,
                                "identifier" : identiValue,
                                "level" : catalogueLevel,
                                "xmlsource" : xmlSource
                        };
                        jsonArray.push(jsonObj);
                    }
                    var JsonObjectFinal = {
                            searchBrowse : false,
                            details : jsonArray
                    };
                    JsonArrayString = JSON.stringify(JsonObjectFinal);
                }
                localStorage.setItem("selectedCheckBoxItem", JsonArrayString);
                $("#select-file-multiple-id").val('View Selected Items');
                if($("#select-file-multiple-id").hasClass('disabled-btn')) {
                    $('#select-file-multiple-id').removeClass("disabled-btn");
                    $("#select-file-second-multiple-id").removeClass("hide");
                    $("#select-file-second-multiple-id").val('View Selected Items');
                }
            }else{
                jsonArray = [];
                var JsonArrayString = null;
                listOfFileCheckBoxIds = listOfFileCheckBoxIds.filter(item => item !== selectedCheckBoxId)
                if(listOfFileCheckBoxIds.length > 0 && JsonObject != null) {
                    listOfFileCheckBoxIds.sort(customSort);
                    $.each(listOfFileCheckBoxIds, function (i, arrId){
                        $.each(JsonObject.details,function (j, arrObj){
                            if(arrId === arrObj.id) {
                                jsonArray.push(arrObj);
                            }
                        });
                    });
                    var JsonObjectFinal = {
                            searchBrowse : false,
                            details : jsonArray
                    };
                    JsonArrayString = JSON.stringify(JsonObjectFinal);
                }
                localStorage.setItem("selectedCheckBoxItem", JsonArrayString);
            }
            if(listOfFileCheckBoxIds.length == 0) {
                $("#select-file-multiple-id").val('View Selected Items');
                $('#select-file-multiple-id').addClass("disabled-btn");
                if($("#select-file-multiple-id").hasClass('disabled-btn') && $("#select-file-multiple-id").val() == "View Selected Items") {
                    $("#select-file-second-multiple-id").addClass("hide");
                }
            }
        });

        //multiple-item-close functionality of series catalogue index pages
        $(".multiple-item-close").on("click", function(){
            if($(".multiple-item-close").attr("name") == "series-close") {
                $(".series-catalogue input").prop("checked", false);
                listOfSeriesCheckBoxIds = [];
                JsonObject = null;
                localStorage.setItem("selectedCheckBoxItem", null);
                localStorage.setItem("EnabledCheckBoxs",false);
                $("#select-multiple-id").val('Select Multiple Items');
                if($("#select-multiple-id").val() == "Select Multiple Items") {
                    $('#select-multiple-id').removeClass("disabled-btn");
                    $("#select-second-multiple-id").addClass("hide");
                    $(".multiple-item-close").addClass("hide");
                    $(".series-catalogue").addClass("hide");
                }
            }
        });

        //multiple-file-item-close functionality of series/file catalogue index pages
        $(".multiple-file-item-close").on("click", function(){
            if($(".multiple-file-item-close").attr("name")  == "file-close") {
                $(".file-catalogue input").prop("checked", false);
                jsonArray = [];
                listOfFIleCheckBoxIds = [];
                JsonObject = null;
                localStorage.setItem("selectedCheckBoxItem", null);
                localStorage.setItem("EnabledCheckBoxs",false);
                $("#select-file-multiple-id").val('Select Multiple Items');
                if($("#select-file-multiple-id").val() == "Select Multiple Items") {
                    $('#select-file-multiple-id').removeClass("disabled-btn");
                    $("#select-file-second-multiple-id").addClass("hide");
                    $(".multiple-file-item-close").addClass("hide");
                    $(".file-catalogue").addClass("hide");
                }
            }
        });
    },
    hideClipButtonFairchild: function () {
    	setTimeout(function(){
    		$(".vua-clip-button").addClass('hide');
    	}, 1000);
    },
    fairchildHideAuthorName: function(){
    	$(".author-alias a").attr("style", "pointer-events:none;color: #000 !important");
    },
    blankTargetVulnerabilityFix: function() {
        $('a[target="_blank"]').each(function(){
            $(this).attr("rel", "noopener noreferrer");
        });
    },
    changeDescHeight : function(){
    	$(".catalogue-image img").on("load", function() {
    		var altheight=$(this).closest(".row").find(".alt-col").length>0?parseInt($(this).closest(".row").find(".alt-col").height()):0;
    	    var descheight=$(this).closest(".row").find(".desc-col").length>0?parseInt($(this).closest(".row").find(".desc-col").height()):0;
    	    var totalheight=altheight+descheight;
    	    var lineheight = parseInt($(this).closest(".row").find(".catalogue-desc").css("line-height"));
    	    var imageheight=parseInt($(this).height());
    	    if(totalheight>imageheight){
    	    	if(altheight>imageheight){
        	        $(this).closest(".row").find(".catalogue-desc").css({"max-height": altheight, "overflow": "hidden"});
    	    	}else{
        	        $(this).closest(".row").find(".catalogue-desc").css({"max-height": lineheight * Math.floor(imageheight/lineheight)+lineheight/4, "overflow": "hidden"});
    	    	}
    	        if(descheight>0){
        	        $('<a href="javascript:void(0);" class="view-catalogue-desc">View more</a>').insertAfter($(this).closest(".row").find(".catalogue-desc"));
    	        }
    	    }
    	});
    	
    	$(".row").on("click", ".view-catalogue-desc" ,function(){
    		var text= $(this).text();
    		if(text=="View more"){
    			$(this).closest(".row").find(".catalogue-desc").css({"max-height": "none", "overflow": "visible"});
    			$(this).text("View less");
    		}
    		if(text=="View less"){
    			var altheight=$(this).closest(".row").find(".alt-col").length>0?parseInt($(this).closest(".row").find(".alt-col").height()):0;
        	    var descheight=$(this).closest(".row").find(".desc-col").length>0?parseInt($(this).closest(".row").find(".desc-col").height()):0;
        	    var totalheight=altheight+descheight;
        	    var lineheight = parseInt($(this).closest(".row").find(".catalogue-desc").css("line-height"));
        	    var imageheight=parseInt($(this).closest(".row").find(".catalogue-image").height());
        	    if(altheight>imageheight){
        	        $(this).closest(".row").find(".catalogue-desc").css({"max-height": altheight, "overflow": "hidden"});
    	    	}else{
        	        $(this).closest(".row").find(".catalogue-desc").css({"max-height": lineheight * Math.floor(imageheight/lineheight)+lineheight/4, "overflow": "hidden"});
    	    	}
    			$(this).text("View more");
    		}
    	})
    },
    googleAnalyticsTrack: function() {
        try {
            var options = {};
            options.page_type = "xml-generated";
            if ($("#territory-restricted:visible").length > 0) {
                options.content_availability = "territory-restricted";
                options.user_content_availability = "unavailable";
            } else if ($(".open-access").length > 0) {
                options.content_availability = "open access";
                options.user_content_availability = "available";
            } else if ($(".conent_locked:visible").length > 0 || $(".subsciption_req:visible").length > 0) {
                options.content_availability = "authentication required";
                options.user_content_availability = "unavailable";
            } else if ($("#checkForLogout") > 0) {
                options.content_availability = "free content";
                options.user_content_availability = "available";
            } else {
                options.content_availability = "authentication required";
                options.user_content_availability = "available";
            }
            if ($("#squid-author").length > 0 && $("#squid-author").val()) {
                options.content_author = $("#squid-author").val().trim();
            }
                        if ($("#chapter-title-squid").length > 0 && $("#chapter-title-squid").val()) {
                options.content_chapter = $("#chapter-title-squid").val().trim();
            }   
                        if ($("#isbn-squid").length > 0) {
                options.content_isbn = $("#isbn-squid").val();
            }
            if ($("#doi-squid").length > 0) {
                options.content_doi = $("#doi-squid").val();
            }
            var tocId = $.urlNewParam("tocid");
            var docId = $.urlNewParam("docid");
            var actId = $.urlNewParam("actid");
            var studioId = $.urlNewParam("studioid");
            if (actId) {
                options.content_id = actId;
            } else if (studioId) {
                options.content_id = studioId;
            } else if (tocId) {
                options.content_id = tocId;
            } else if (docId) {
                options.content_id = docId;
            }
            if ($("#publisherName").length > 0) {
                options.content_publisher = $.trim($("#publisherName").val());
            }
            if ($("#book-title-squid").length > 0) {
                options.content_title = $.trim($("#book-title-squid").val());
            }
            if ($("#volume-title").length > 0) {
                options.content_volume = $.trim($("#volume-title").val());
            }
            if ($("#workTitle").length > 0) {
                options.content_work = $.trim($("#workTitle").val());
            }
            if ($("#seriesTitle").length > 0) {
                   options.content_series = $.trim($("#seriesTitle").text()) || $.trim($("#seriesTitle").val());
            }
            if ($("#pubdate-squid").length > 0) {
                options.content_published_date_biblio = $.trim($("#pubdate-squid").val());
            }
            if ($("#online-pubdate").length > 0) {
                options.content_published_date_online = $.trim($("#online-pubdate").val());
            }
            if ($("#taxonomy-subjects").length>0 || window.location.pathname=="/person") {
                var taxonomySubject = {};
                $("*[id='taxonomy-subjects']").each(function(){
                    var subLinks = $(this).find('p').text();
                    var contentKey = $(this).find('h3').data("ganame");
                    if (subLinks && contentKey) {
						subLinks = subLinks.replace(/\n/g, '').trim().replace(/\s+/g, ' ');
						taxonomySubject[contentKey] = subLinks;
					}
                });
                if(window.location.pathname=="/person"){
	                $(".subjects-data li").each(function(){
	                    var subLinks = $(this).find('.cat_tab2').text();
	                    var contentKey = $(this).find('.cat_tab1').data("ganame");
	                    if (subLinks && contentKey) {
	                        subLinks = subLinks.replace(/\n/g, '').trim().replace(/\s+/g, ' ');
	                        taxonomySubject[contentKey] = subLinks;
	                    }
	                })
                }
                options.taxonomy_subjects = [];
                options.taxonomy_subjects.push(taxonomySubject);
            }
            googleAnalyticsPageLoad(options);
        } catch(err) {
            console.log("Error in googleAnalyticsTrack function::", err);
        }
    },    
    initImageControlsGA : function(){
    	try{
    		$(document).on('click','.control-icon', function(){
    			var imageControlObj={};
    			var title= $(this).attr("title");
    			imageControlObj.event="image_interaction";
    			if(title == "Zoom in" || title == "Zoom out"){
    				imageControlObj.interaction_type= "Zoom";
    			}
    			if(title == "Go home"){
    				imageControlObj.interaction_type= "Go home";
    			}
    			if(title == "Rotate left" || title == "Rotate right"){
    				imageControlObj.interaction_type= "Rotate";
    			}
    			if(title == "Toggle full screen"){
    				imageControlObj.interaction_type= "Toggle full screen";
    			}
    			if(title == "Single View" || title == "Multi View"){
    				imageControlObj.interaction_type= "Toggle single/double page layout";
    			}
    		dataLayer.push(imageControlObj);
    		})
    	}catch(err){
    		console.log("Error in Image Controls GA function::", err);
    	}
    },
   initCounterUrl : function()
    {   
    	var usagemetricsElement = '';
    	var usagemetricsDownload = '';
    	var downloadPdfCounter = '';
    	var chapterViewLearn = '';
    	var chapterDownloadLearn = '';
    	var volumeDownloadLearn = '';
    	var hiddenCounterUrl = document.getElementById('counterhiddenInput');
    	var counterUrl = hiddenCounterUrl.value;
    	usagemetricsElement = document.getElementById('usagemetrics');
    	if(usagemetricsElement!=null) {
    	usagemetricsElement.setAttribute('href', counterUrl);
    	}
    	usagemetricsDownload = document.getElementById('usagemetricsdownload');
    	if(usagemetricsDownload!=null) {
    	usagemetricsDownload.setAttribute('href', counterUrl);
    	}
    	downloadPdfCounter = document.getElementById('downloadpdfcounter');
    	if(downloadPdfCounter!=null) {
    		downloadPdfCounter.setAttribute('href', counterUrl);
    	}
    	chapterViewLearn = document.getElementById('chapterviewlearn');
    	if(chapterViewLearn!=null) {
    		chapterViewLearn.setAttribute('href', counterUrl);
    	}
    	chapterDownloadLearn = document.getElementById('chapterdownloadlearn');
    	if(chapterDownloadLearn!=null) {
    		chapterDownloadLearn.setAttribute('href', counterUrl);
    	}
    	volumeDownloadLearn = document.getElementById('volumedownloadlearn');
    	if(volumeDownloadLearn!=null) {
    		volumeDownloadLearn.setAttribute('href', counterUrl);
    	}
    },
    initDownloadPdfTooltip : function() {
        try {
            $(".chapter_pdf,.book_full_pdf,.learn_metrics").popover({
            html: true,
            placement: 'bottom',
            trigger: 'manual',
            content: function () {
                return $(this).attr("title");
                }
            }).on('focus', function() {
                $(this).popover('toggle');
            }).on('blur', function() {
                $(this).popover('hide');
            }).on('mouseenter', function() {
                $(this).popover('show');
            }).on('mouseleave', function() {
                $(this).popover('hide');
            });
        }
         catch (err) {
            console.log("Error in initDownloadPdfTooltip function::", err);    
        }
       
    },
    relatedMediaandContentsonKeyAction : function() {
        try {
          $(".cld-related-images").off().on("keyup", function(e) {
  			 if (e.keyCode == 13) {
    			$(this).click(); 
  				} 
			 });
        }
         catch (err) {
            console.log("Error in relatedMediaandContentsonKeyAction function::", err);    
        }
       
    },    
    initLoginBox : function(){
    	if($(".login_page").length) {
			$(".login_page").append($("#login-left-hidden").children().clone());
    		    		$(".login_page").on('click', "#instloginbtn", function() {
    		    window.location.href="https://sp.sams-sigma.com/shib?dest=https%3A%2F%2Fwww.humankineticslibrary.com%2Flogin%3FrecentUrl%3D%2Fencyclopedia-chapter%3Fdocid%3Db-9781718219342%26tocid%3Db-9781718219342-chapter14";
    		});
    		
    		$(".login_page").find("#login-username,#login-password").on('change',function(){
    		    validateLoginInput();
    		});
    		function validateLoginInput(){
    			if($(".login_page").find("#login-username").val().trim().length>0 && $(".login_page").find("#login-password").val().trim().length>0){
    				$(".login_page").find("#loginbtn").removeClass("disabled-btn").addClass("login-success-btn");
    			}
    			else{
    				$(".login_page").find("#loginbtn").addClass("disabled-btn").removeClass("login-success-btn");
    			}
    		}
    		$(".login_page").find("#login-username,#login-password").on('keyup',function(e){
    		    validateLoginInput();
   				if($(".login_page").find("#login-username").val() == ""){
   					$(".login_page").find("#login-username").css("border","1px solid #ccc");
   				}
   				if($(".login_page").find("#login-password").val() == ""){
   					$(".login_page").find("#login-password").css("border","1px solid #ccc");
   				}
   				if(!$(".login_page").find("#loginbtn").hasClass('disabled-btn')){
	   		      	if(e.keyCode=="13"){
	   		      		$.cookie('loginbtnflag', 'true');
	   		      		$.cookie('librarylogin', 'false');
	   			        showProgress();
	   			        $(".login_page").find("#loginform").submit();
	   		      	}
    			}
    		});
    		function validateLibraryLoginInput(){
    			if($(".login_page").find("#login-librarycard").val().trim().length>0){
    				$(".login_page").find("#libraryloginbtn").removeClass("disabled-btn");
			  	}else{
			  		$(".login_page").find("#libraryloginbtn").addClass("disabled-btn");
				}
			}
    		$(".login_page").find("#login-librarycard").on("keyup",function(e){
    			validateLibraryLoginInput();
    		    if($(".login_page").find("#login-librarycard").val() == ""){
    		    	$(".login_page").find("#login-librarycard").css("border","1px solid #ccc");
    		    }
    		    if(!$(".login_page").find("#libraryloginbtn").hasClass('disabled-btn')){
    		    	if(e.keyCode=="13"){
	    		    	var loginUserName = $(".login_page").find("#login-librarycard").val().trim();
	    		        if(validateAlphanumericAdv(loginUserName)) {
	    		        	showProgress();
	    		            $.cookie('librarylogin', 'true');
	    		            $(".login_page").find("#libraryloginform").submit();
	    		        }else {
	    		        	$(".login_page").find("#login-librarycard").css("border","1px solid red");
	    		        }
    		      	}
    		    }
			});
    		$(".login_page").on('click', "#loginbtn", function() {
	   			if(!$(this).hasClass('disabled-btn')){
	   		        var loginUserName = $(".login_page").find("#login-username").val().trim();
	   		        if (validateAlphanumericAdv(loginUserName)) {
	   		    		$.cookie('loginbtnflag', 'true');
	   		            $.cookie('librarylogin', 'false');
	   		    		showProgress();
	   		    		$(".login_page").find("#loginform").submit();
	   		        } else {
	   		        	$(".login_page").find("#login-username").css("border","1px solid red");
	   		        }
	   			}
    		});
    		$(".login_page").on('click', "#libraryloginbtn", function() {
    			if(!$(this).hasClass('disabled-btn')){
   			    var loginUserName = $(".login_page").find("#login-librarycard").val().trim();
   			    if (validateAlphanumericAdv(loginUserName)) {
   			        showProgress();
   			        $.cookie('librarylogin', 'true');
   			     	$(".login_page").find("#libraryloginform").submit();
   			    } else {
   			    	$(".login_page").find("#login-librarycard").css("border","1px solid red");
   			    }
   			  }
   			});
    		function validateAlphanumericAdv(str) {
    		    var testFlag = true;
    		    var blockedChars = ["<", ">", "javascript", "alert(", "confirm(", "document.location", "window.location", "oneerror="];
    		    $.each(blockedChars, function(index,value){
    		        if (~str.indexOf(value)) {
    		            testFlag = false;
    		        }
    		    });
    		    return testFlag;
    		}
    	}
    },
        hideToolBar : function(){
    	var bookType = $("#legalContentType").val();
    	if(bookType === "legislation" || bookType === "precedents"){
    		$("#citation-btn").parent().hide();
    	}
    },
        highlightProfessionalTOC : function(){
    	if($(".no-link-active")){
	    	$(".no-link-active").attr('style', 'color :#000000 !important;');
    	}
    },
    playDictSearch : function(){
    	if($(".dictSearch-inp")){
    		var suggestionOpen = false;
    		$(".dictSearch-inp:visible").autocomplete({
    	        source: dictionarySearchAjax,
    	        minLength: 3,       
    	        delay: 100,         
    	        autoFocus: false,
    	        open: function(event, ui) {
    	        	const inputWidth = $(this).outerWidth();
    	            $(".ui-autocomplete").css("width", inputWidth + "px");
    	        },
    	        focus: function(event, ui) {
    	            return false;
    	        },
    	        select: function (event, ui) {
    	        	$(this).val(ui.item.title);
    	        	let data = {tocId:ui.item.identifier, xmlSource: ui.item.xmlSource}
    	        	$('.tempSearch:visible').empty();
    	        	$('.tempSearch:visible').html("<b>"+ui.item.title+"</b>");
    	        	suggestionOpen = true;
    	        	dictionaryContentAjax(data);
    	        	return false;
    	        }
    	        
    	      }).autocomplete("instance")._renderItem = function( ul, item ) {
    			return $("<li>")
                .append($("<div>").text(item.title))
                .appendTo(ul);
    	      };
    		
    		$(".dictSearch-inp:visible").on("input",function(){
        		let txt = $(this).val().trim();
    			if(txt.length > 2){
    				$(".dictSearch-btn:visible").removeClass("disabled-btn");
    				$(".dictSearch:visible .err-msg").addClass("hide");
    			}
    		})
    		
    		$('.dictSearch-inp:visible').on('keydown', function(event) {
    			if (event.key === 'Enter' || event.keyCode === 13) {
    				$(this).autocomplete('close')
    				if(!suggestionOpen){
	    		    	$(".dictSearch-btn:visible").click();
    				}
    				suggestionOpen = false;
    		    }
    		});
    		    
    	}
    	
    	$(".dictSearch-btn:visible").on("click",function(){
    		if(!$(this).hasClass("disabled-btn")){
    			dictionarySearchAjax("");
    		}
    	})
    	
    	$(document).on("click",".tempSearch:visible a",function(){
    		const tocId = $(this).data("tocid");
    		const xmlsource = $(this).data("xmlsource");
    		const data = {tocId:tocId, xmlSource: xmlsource}
        	$('.tempSearch:visible').empty().html("<b>"+$(this).text()+"</b>");
        	dictionaryContentAjax(data);
    	})
    	
    	function dictionarySearchAjax(request,response){
    		const $div = $('.tempSearch:visible');
    		let txt = $(".dictSearch-inp:visible").val().trim();
			let dictRefId = $(".dictSearch-inp:visible").data("dic-id");
			let data = {queryText:txt, dictRefId:dictRefId}
    		$.ajax({
	            type: "GET",
	            url: "/app/dictionarySearch",
	            data: data,
	            dataType: 'json',
	            success: function(data, textStatus, jqXHR) {
	            	if(typeof response === "function"){
			            response(data);
	            	}else{
	            		$(".dictSearch:visible").find(".meaningContent, .linkContent").addClass("hide");
	            		$div.empty();
	            		if(data.length == 1){
	            			const tocId = data[0].identifier;
	                		const xmlsource = data[0].xmlSource;
	                		const param = {tocId:tocId, xmlSource: xmlsource};
	                		$('.tempSearch:visible').html("<b>"+data[0].title+"</b>");
	                    	dictionaryContentAjax(param);
	            		}else{
		            		data.forEach(function(item){
		            			const $a = $('<a></a>').text(item.title)
		            			.attr('href', 'javascript:void(0)') 
	                            .attr('data-tocid', item.identifier)
	                            .attr('data-xmlsource', item.xmlSource)
	                            .css('display', 'block');
		                        $div.append($a);
		            		})
	            		}
	            	}
	            },error : function(data, textStatus, jqXHR){
	            	if(typeof response === "function"){
	            		response([]);
	            	}            	
	            	$(".dictSearch:visible .err-msg").removeClass("hide");
	            }
			});
    	}
    	
    	function dictionaryContentAjax(data){
    		$(".dictSearch:visible").find(".meaningContent, .linkContent").empty().removeClass("hide");
    		showAjaxLoader('.meaningContent:visible');
    		$.ajax({
	            type: "GET",
	            url: "/app/dictionaryContent",
	            dataType: 'html',
	            data: data,
	            success: function(data, textStatus, jqXHR) {
	            	const $meaningContent = $(data).filter("#meaning-content"); 
	            	const $linkContent = $(data).filter("#link-content");
	            	hideAjaxLoader('.meaningContent:visible');
	            	$(".dictSearch:visible .meaningContent").html($meaningContent);
	            	$(".dictSearch:visible .linkContent").html($linkContent);
	            	addBorders();
	            }
			});
    	}
    	
    	function addBorders(){
    		if($(".dictSearch:visible .meaningContent").innerHeight() > window.innerHeight * 0.39){
    			$(".meaningContent:visible").css({"border-top":"1px solid #ccc","border-bottom":"1px solid #ccc"});
    		}else{
    			$(".meaningContent:visible").css('border', 'none')
    		}
    	}
    	var $header = $(".dictSearch:visible");
    	if ($header.length > 0 && $(window).width() > 768) {
    		var originalTop = $header.offset().top;
    		var originalWidth = $header.outerWidth();
			$(window).on("scroll", function () {
				var scrollTop = $(window).scrollTop();
				if (scrollTop > originalTop) {
					$header.css({"width":originalWidth,"position": "fixed","top": "0"});
				} else {
			        $header.css({"top": originalTop,"position": ""});
			    }
			});
    	}
    }
};
</script>			<input type="hidden" id="collapseallsec" name="collapseall" value="Collapse All Sections"/>
			<input type="hidden" id="expandallsec" name="expandall" value="Expand All Sections"/>
			<input type="hidden" id="recentdocid"  value="b-9781718219342">
			<input type="hidden" id="recentcontenttype"  value="encyclopedia">
			<input type="hidden" id="showrecentlyview" value="yes"/>
			<div class="container article_template content_unlocked" id="mycontent" role="main">
				


	<!-- Buy Item Feature -->
	
	<!-- Buy Item Feature -->

<style>	
	.justify-content-s-around {
    	justify-content: space-around;
	}
</style>


<div id="content" class="toolbar">
<input type="hidden" id="view-more" name="more" value="View More"/>
<input type="hidden" id="view-less" name="less" value="View Less"/>
	<ul role="list">
						    			<li class="$saveHidden">
				

				<button aria-label="Save" title="Save" id="favorite-dwnld" data-toggle="modal" data-target="#signin_modal" type="button" >
                  <span class="icon-Fav1 adjust-icons" aria-hidden="true"></span>
                  <div class="hidden-xs" aria-hidden="true">Save</div>
                </button>

			</li>
							
														<li class="hide"><a id="download" data-toggle="modal" class="chapter_pdf downloadcontentpdf"  href="javascript:;" title="Download Chapter PDF" aria-label="Download Chapter PDF" role="button"><span class="icon-download"></span><div class="hidden-xs" aria-hidden="true">Download</div></a></li>
										<input type="hidden" id="allowDownload" value="false"/>
		        
		
		<li>
		    

		    <button id="print_page_pre" title="Print" aria-label="Print" type="button" role="button">
                <span class="icon-Print adjust-icons" aria-hidden="true"></span>
                <div class="hidden-xs" aria-hidden="true">Print</div>
            </button>

		</li>
						<li class="">
			

			<button id="citation-btn" title="Citation" aria-label="Citation" data-toggle="modal" data-target="#citation-modal" type="button" role="button">
                <span class="icon-citation adjust-icons" aria-hidden="true"></span>
                <div class="hidden-xs" aria-hidden="true">Citation</div>
            </button>

		</li>
			</ul>
</div>

<div role="dialog" aria-modal="true" aria-labelledby="delete-folder-common" aria-describedby="delete-folder-common-description" class="modal fade" id="delete-folder-common" tabindex="-1" data-backdrop="static" data-keyboard="true">
    <div class="vertical-alignment-helper">
		<div class="modal-dialog share_modal library_modal vertical-align-center" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<div class="signin_close">
					    <button type="button" data-dismiss="modal" tabindex="0" role="button" aria-label="Close">
                            <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="Close" role="presentation">
                        </button>
	                </div>
					              

					<form method="post" id="delete_folder" tabindex="0">
					<h2 id="mylibrary-del" tabindex="0" aria-labelledby="mylibrary-del">Delete This?</h2>
						<p id="content-confirm-common" tabindex="0" aria-labelledby="content-confirm">
							Are you sure you want to remove the page from "My Saved Items"?	
						</p>

						<div class="share_btns">
							<input type="button" id="deletefolder" class="primary_btn" value="Yes">
							<input type="button" class="secondary_btn" data-dismiss="modal" value="No" >
						</div>
					</form>
				</div>
			</div>
		</div>
    </div>
</div>

	
<div role="dialog" aria-modal="true" aria-labelledby="subscription-modal" aria-describedby="subscription-modal-description" class="modal fade" id="subscription-modal" tabindex="-1" data-backdrop="static" data-keyboard="true">
      <div class="vertical-alignment-helper">
         <div class="modal-dialog citation_modal vertical-align-center subs-modal" role="document" data-backdrop="static" data-keyboard="true">
            <div class="modal-content">
               <div class="modal-body">
                  <div class="signin_close">
                      <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                           <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                      </button>
                  </div>
                  <h2 class="signin-head" id="commontool-Subscription" tabindex="0" aria-labelledby="commontool-Subscription">Subscription Required</h2>
                  <p id="commontool-Subscriptiondescr" tabindex="0" aria-labelledby="commontool-Subscriptiondescr">This item is only available to the members of institutions that have purchased access. If you belong to such an institution please <a href="login?recentUrl=/encyclopedia-chapter?docid=b-9781718219342&tocid=b-9781718219342-chapter14" tabindex="0">Log In</a></p>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div role="dialog" aria-modal="true" aria-labelledby="table-modal" aria-describedby="table-modal-description" class="modal fade" id="table-modal" tabindex="-1" data-backdrop="static" data-keyboard="true">
      <div class="vertical-alignment-helper">
         <div class="modal-dialog citation_modal table_modal vertical-align-center subs-modal" role="document" data-backdrop="static" data-keyboard="true">
            <div class="modal-content">
               <div class="modal-body">
                 <div class="signin_close">
                    <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
                 </div>
				 <div class="table-content">
				 </div>
				<div class="modal-footer">
					<a id="download-table" class="disabled-btn"><input type="button" class="primary_btn" value="Download XLS file"></a>
				</div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div role="dialog" aria-modal="true" aria-labelledby="image-download-modal" aria-describedby="image-download-modal-description" class="modal fade" id="image-download-modal" tabindex="-1" data-backdrop="static" data-keyboard="true">
      <div class="vertical-alignment-helper">
         <div class="modal-dialog citation_modal vertical-align-center subs-modal" role="document" data-backdrop="static" data-keyboard="true">
            <div class="modal-content image-download-modal">
               <div class="modal-body">
                 <div class="signin_close">
                    <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
                 </div>
				 <div class="table-content">
				 
				 </div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div role="dialog" aria-modal="true" aria-labelledby="download-modal" aria-describedby="download-modal-description" class="modal fade" id="download-modal" tabindex="-1" data-backdrop="static" data-keyboard="true">
      <div class="vertical-alignment-helper">
         <div class="modal-dialog citation_modal vertical-align-center subs-modal" role="document" data-backdrop="static" data-keyboard="true">
            <div class="modal-content">
               <div class="modal-body">
                  <div class="signin_close">
                   <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
                  </div>
                  <h2 id="commontool-signin" tabindex="0" aria-labelledby="commontool-signin">SIGN in to your personal account</h2>
                  <p id="commontool-signinarticle" tabindex="0" aria-labelledby="commontool-signinarticle">Use your personal account to save  'favourite' articles, chapters and books. <a href="javascript:;" class="article-signin favourite-signin" data-toggle="modal" data-target="#signin_modal" tabindex="0">Sign In now</a></p>
                  <p id="commontool-accountyet" tabindex="0" aria-labelledby="commontool-accountyet">Don't have a personal account yet?  <a href="sign-up" title="Sign Up now" tabindex="0">Sign Up now</a></p>
               </div>
            </div>
         </div>
      </div>
   </div>

<div role="dialog" aria-modal="true" aria-labelledby="citation-modal" aria-describedby="citation-modal-description" class="modal fade" id="citation-modal" tabindex="-1" data-backdrop="static" data-keyboard="true">
   <div class="vertical-alignment-helper">
      <div class="modal-dialog citation_modal vertical-align-center" role="document">
         <div class="modal-content">
            <div class="modal-body">
               <div class="signin_close">
                   <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
               </div>
               <h2 id="commontool-citeopt" tabindex="0" aria-labelledby="commontool-citeopt">Citation Options</h2>
               <ul class="nav nav-tabs responsive-tabs citation-modal-tab" role="tablist">
                  <li role="APA" class="active"><a href="#tab1" aria-controls="APA" role="tab" data-toggle="tab" title="APA">APA</a></li>
                  <li role="MLA"><a href="#tab2" aria-controls="MLA" role="tab" data-toggle="tab">MLA</a></li>
                  <li role="Chicago"><a href="#tab3" aria-controls="Chicago" role="tab" data-toggle="tab">Chicago</a></li>
                   
               </ul>
               <div class="tab-content">
                   <div role="tabpanel" class="tab-pane active" id="tab1">
            			            				            				            				            				<p id="bar" class="citation_apa" tabindex="0" aria-label="$articlecitations.apa.replace("Date", "$date.full_date")"></p>
            				<div align="center" class="tabs_btns">
    						    <input type="button" class="btn primary_btn" data-clipboard-action="copy" data-clipboard-target="#bar" value="Copy to Clipboard" autocomplete="off">
    						        						        						        						   	    <a href="app/getris?doctype=encyclopedia&docid=b-9781718219342-chapter14&xmlSource=9781718219342_txt_xml.xml" data-citationtype ="apa"  download="b-9781718219342.ris"><input type="button" class="secondary_btn export_RIS_btn" value="Export RIS file"></a>
    						            				    </div>
        				    <div id="commontool-apa-copyclipboard1" class="copy-error" style="display:none;" tabindex="0" aria-labelledby="commontool-apa-copyclipboard1">Copy to clipboard is not supported by your browser. Please update your browser version or manually copy the content.</div>
            			                  </div>
                  <div role="tabpanel" class="tab-pane" id="tab2"> 
																													<p id="bar1" class="citation_mla" tabindex="0" aria-label="$articlecitations.mla.replace("Date", "$date.full_date")">$articlemlacitations</p>
                        <div align="center" class="tabs_btns">
                            <input type="button" class="btn primary_btn" data-clipboard-action="copy" data-clipboard-target="#bar1" value="Copy to Clipboard" autocomplete="off">
                            						    						    						    	<a href="app/getris?doctype=encyclopedia&docid=b-9781718219342-chapter14&xmlSource=9781718219342_txt_xml.xml" data-citationtype ="mla"  download="b-9781718219342.ris"><input type="button" class="secondary_btn export_RIS_btn" value="Export RIS file"></a>
						                            </div>
					    <div id="commontool-mla-copyclipboard1" class="copy-error" style="display:none;" tabindex="0" aria-labelledby="commontool-mla-copyclipboard1">Copy to clipboard is not supported by your browser. Please update your browser version or manually copy the content.</div>
					                  </div>
                  <div role="tabpanel" class="tab-pane" id="tab3">
																													<p id="bar2" class="citation_chicago" tabindex="0" aria-label="$articlecitations.chicago.replace("Date", "$date.full_date")"></p>
						<div align="center" class="tabs_btns">
    						<input type="button" class="btn primary_btn" data-clipboard-action="copy" data-clipboard-target="#bar2" value="Copy to Clipboard" autocomplete="off">
    						                                                             				        	<a href="app/getris?doctype=encyclopedia&docid=b-9781718219342-chapter14&xmlSource=9781718219342_txt_xml.xml" data-citationtype ="chicago"   download="b-9781718219342.ris"><input type="button" class="secondary_btn export_RIS_btn" value="Export RIS file"></a>
    				        				        </div>
				        <div id="commontool-chicago-copyclipboard1" class="copy-error" style="display:none;" tabindex="0" aria-labelledby="commontool-chicago-copyclipboard1">Copy to clipboard is not supported by your browser. Please update your browser version or manually copy the content.</div>
					                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

<div role="dialog" aria-modal="true" aria-labelledby="print-dialog" aria-describedby="print-dialog-description" class="modal fade" id="print-dialog" tabindex="-1" data-backdrop="static" data-keyboard="true">
   <div class="vertical-alignment-helper">
      <div class="modal-dialog citation_modal vertical-align-center" role="document">
         <div class="modal-content">
            <div class="modal-body">
               <div class="signin_close">
                    <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
               </div>
               <div class="text-center print-content">
			   <img class="print_loading" src="/bloomsbury_assets/bloomsbury/images/loader.gif" tabindex="0" role="img" aria-label="Loader">
				<h3 class="print_waiting">Getting your document ready for printing...</h3>
			   <h3 class="print_ready hide">Your document is ready.  <a href="#" class="print_page" title="Print your document">Print your document</a>.</h3>
			   </div>
             
               </div>
            </div>
         </div>
      </div>
   </div>
   <div role="dialog" aria-modal="true" aria-labelledby="print-catalog" aria-describedby="print-dialog-description" class="modal fade" id="print-catalog" tabindex="-1" data-backdrop="static" data-keyboard="true">
   	<div class="vertical-alignment-helper">
      <div class="modal-dialog citation_modal vertical-align-center" role="document">
         <div class="modal-content">
         	<div class="modal-header d-flex justify-content-s-bet">
	         	<div class="bc-h3">Print Options</div>
	         	<div class="signin_close ml-auto">
	         	    <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
	         	</div>
         	</div>
            <div class="modal-body">
	            <div class="radio d-flex">
					<input id="range-check" name="print-type" type="radio" value="range" >
					<label for="range-check">
						Image range
					</label>
					<div class="ml-10">
						From : <input id="print-from" type="number" min="1" max="1000" disabled>
						To : <input id="print-to" type="number" min="1" max="1000" disabled>
					</div>
				</div>
				<span class="err-msg hide fromto-missing">Enter values for from and to</span>
				<span class="err-msg hide fromto-invalid">From value should be less than to value</span>
				<span class="err-msg hide available-limit"></span>
				<div class="radio">
					<input id="current-check" name="print-type" type="radio" value="current" checked="true">
					<label for="current-check">
						Current image
					</label>
				</div>
				<div class="text-center print-content">
				   <h3 class="print_ready hide">Your document is ready.  <a href="#" class="print_page" title="Print your document">Print your document</a>.</h3>
			   	</div>
            </div>
            <div class="modal-footer d-flex justify-content-s-bet">
	         	<input type="button" class="btn secondary_btn ml-auto" value="Cancel" data-dismiss="modal">
	         	<input type="button" class="btn primary_btn"  value="Print" id="catalogue_print" >
         	</div>
           </div>
         </div>
      </div>
   </div>
   
   <div role="dialog" aria-modal="true" aria-labelledby="download-catalog" aria-describedby="download-catalog-description" class="modal fade" id="download-catalog" tabindex="-1" data-backdrop="static" data-keyboard="true">
   	<div class="vertical-alignment-helper">
      <div class="modal-dialog citation_modal vertical-align-center" role="document">
         <div class="modal-content">
         	<div class="modal-header d-flex justify-content-s-bet">
	         	<div class="bc-h3">Download Options</div>
	         	<div class="signin_close ml-auto">
	         	    <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
	         	</div>
         	</div>
            <div class="modal-body">
            	<div class="radio d-flex">
					<input id="range-download" name="download-type" type="radio" value="range" >
					<label for="range-download">
						Image range
					</label>
					<div class="ml-10">
						From : <input id="download-from" type="number" min="1" max="1000" disabled>
						To : <input id="download-to" type="number" min="1" max="1000" disabled>
					</div>
				</div>
				<span class="err-msg hide fromto-missing">Enter values for from and to</span>
				<span class="err-msg hide fromto-invalid">From value should be less than to value</span>
				<span class="err-msg hide available-limit"></span>
				<div class="radio">
					<input id="current-download" name="download-type" type="radio" value="current" checked="true">
					<label for="current-download">
						Current image
					</label>
				</div>
				<div class="text-center print-content">
				   <h3 class="download_start hide">Your download is in progress and will appear in your browser shortly</h3>
			   	</div>
            </div>
            <div class="modal-footer d-flex justify-content-s-bet">
	         	<input type="button" class="btn secondary_btn ml-auto" value="Cancel" data-dismiss="modal">
	         	<input type="button" class="btn primary_btn" value="Download" id="catalogue_download">
         	</div>
           </div>
         </div>
      </div>
   </div>
   
   

<div role="dialog" aria-modal="true" aria-labelledby="share-mail" aria-describedby="share-mail-description" class="modal fade" id="share-mail" tabindex="-1" data-backdrop="static" data-keyboard="true">
   <div class="vertical-alignment-helper">
      <div class="modal-dialog share_modal vertical-align-center" role="document">
         <div class="modal-content">
            <div class="modal-body">
               <div class="signin_close">
                   <button type="button" data-dismiss="modal" aria-label="Close" title="Close">
                      <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                    </button>
               </div>
               <h2 id="commontool-sharevia" tabindex="0" aria-labelledby="commontool-sharevia">Share This via...</h2>
               <div class="share_icons">
														









        

<a class="hide" href="https://plus.google.com/share?url=https%3A%2F%2Fwww.humankineticslibrary.com%2Fencyclopedia-chapter%3Fdocid%3Db-9781718219342%26tocid%3Db-9781718219342-chapter14" onclick="javascript:if(confirm('You are being redirected to an external link. Do you wish to continue?')) {window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');

dataLayer.push({
        	'event' : 'content_share',
        	'method' : 'Google'
        	});   
        	
return false;

}
		else {return false;}">
	<span class="icon-Social_Google" title="Google"></span>
</a>

<a  class="confirmModal hide facebook_btn" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.humankineticslibrary.com%2Fencyclopedia-chapter%3Fdocid%3Db-9781718219342%26tocid%3Db-9781718219342-chapter14">
	<span class="icon-Social_Facebook" class="Facebook" title="Facebook"></span>
</a>

<a class="twitter-share hide" href="https://twitter.com/share?url=https%3A%2F%2Fwww.humankineticslibrary.com%2Fencyclopedia-chapter%3Fdocid%3Db-9781718219342%26tocid%3Db-9781718219342-chapter14&text=Scoring Systems" onclick="javascript:if(confirm('You are being redirected to an external link. Do you wish to continue?')) {window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');

dataLayer.push({
        	'event' : 'content_share',
        	'method' : 'Twitter'
        	});

return false;}
		else {return false;}">
	<span class="icon-Social_Twitter" title="Twitter"></span>
</a>

<a target="_blank" class="hide" href="https://pinterest.com/pin/create/link/?url=https%3A%2F%2Fwww.humankineticslibrary.com%2Fencyclopedia-chapter%3Fdocid%3Db-9781718219342%26tocid%3Db-9781718219342-chapter14&media=https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/q_34,b_black,h_0.7/hklskill/b-9781718219342/9781718219342.jpg&description=Scoring Systems" onclick="javascript:if(confirm('You are being redirected to an external link. Do you wish to continue?')) {window.open(this.href,'','menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');

dataLayer.push({
        	'event' : 'content_share',
        	'method' : 'Pinterest'
        	}); 

return false;}
		else {return false;}">
	<span class="icon-Social_Pinterest"></span>
</a>


                  <br>
                  <div id="commontool-or" align="center" tabindex="0" aria-labelledby="commontool-or" class="hide">Or</div>
				               </div>
               <div class="clearfix"></div>
                              







 
  
  
 
<h1>
 
 





 








 


 


<h2 id="emailshare-email" tabindex="0" aria-labelledby="emailshare-email">Email</h2>
<form  id="share-via-form" method="post" action="/app/contentemail">
  <div class="form-group">
	 <label id="emailshare-nametxt" tabindex="0" aria-labelledby="emailshare-nmetxt">To Name<sup>*</sup></label>
	 <input id="to-name" type="text" class="form-control" placeholder="Recipient's Name" name="toname"   value="" 
	 method="post" autocomplete="off"> 
  </div>
  <div class="form-group">
	 <label id="emailshare-emailtxt" tabindex="0" aria-labelledby="emailshare-emailtxt">To Email<sup>*</sup></label>
	 <input id="to-email" type="text" class="form-control email-type" placeholder="Recipient's Email" name="toemail"  value="" 
	 method="post" autocomplete="off"> 
	 <span id="emailshare-emailtxt-err" class="err-msg hide" tabindex="0" aria-live="polite" aria-labelledby="emailshare-emailtxt-err">Invalid Email address</span>
  </div>
  <div class="form-group">
	 <label id="emailshare-yournme" tabindex="0" aria-labelledby="emailshare-yournme">Your Name<sup>*</sup></label>
	 <input id="your-name" type="text" class="form-control" placeholder="Enter Your Name" name="fromname" data-name-value=" "  value="" method="post" autocomplete="off"> 
  </div>
  <div class="form-group">
	 <label id="emailshare-youremail" tabindex="0" aria-labelledby="emailshare-youremail">Your Email<sup>*</sup></label>
	 <input id="your-email" type="text" class="form-control email-type" placeholder="Enter Your Email" name="fromemail" data-mail-value=""  value=""   method="post" autocomplete="off"> 
	 <span id="emailshare-youremail-err" class="err-msg hide" tabindex="0" aria-live="polite" aria-labelledby="emailshare-youremail-err">Invalid Email address</span>
  </div>
  <div class="form-group">
	 <label id="emailshare-subj" tabindex="0" aria-label="emailshare-subj">Subject<sup>*</sup></label>
	 <input id="subject" type="text" class="form-control" maxlength="100" placeholder="Enter Subject" name="subject" method="post" autocomplete="off"/> 
  </div>
	<div class="form-group">
		<label id="emailshare-commen" tabindex="0" aria-labelledby="emailshare-commen">Comments</label>
		<span id="share-char-count" class="character-count">500</span>
		<textarea id="share-text-area" class="form-control" name="comments" method="post" placeholder="Enter your comment"></textarea>
	</div>
     <input type="hidden" id="selected-docids" name="docidlist" value="" method="post"/>
     <input type="hidden" id="selected-imageurl" name="selectedImageList" method="post">
     <input type="hidden" id="selected-citations" name="citationlist" method="post"/>
     <input type="hidden" id="selected-content-paths" name="contenttypelist" method="post"/>
     <input type="hidden" id="selectedsavedItems" name="savesearchnames" method="post"/>
	 <input type="hidden" id="selected-xml-list" name="selectedxmls" method="post"/>
	 <input type="hidden" id="selected-source-xml-list" name="selectedsourcexmls" method="post"/>
	 <input type="hidden" id="selectedsavedContenttypes" name="contenttypesavedlist" method="post"/>
	 <input type="hidden" id="selected-contenttypes" name="content_type" value="" method="post"/>
	 <input type="hidden" id="selected-subtitle" name="share_subtitle" value="" method="post"/>
	 <input type="hidden" id="selected-pubDate" name="share_date" value="" method="post"/>
 	 <input type="hidden" id="share-title" name="share_title" method="post"/>
	 <input type="hidden" id="share-authors" name="share_authors" method="post"/>
	 <input type="hidden" id="share-contenttype" name="share_contenttype" method="post"/>
	 <input type="hidden" id="share-image" name="share_image" method="post"/>
	 <input type="hidden" id="share-mylibrary-items" name="share_libraryitems" method="post"/>
	 <input type="hidden" id="share-saved-search" name="share_saved_search" value="false" method="post"/>
	 <input type="hidden" id="citation-exist" name="citation_exist" method="post"/>
	 <input type="hidden" name="docidForFree" value="b-9781718219342-chapter14" method="post">
	 <input type="hidden" id="shared-description" name="shared-description"   method="post">
	 <input type="hidden" id="shared-itemdate" name="shared-itemdate"   method="post">
	 <input type="hidden" id="shared-alternativetitle"  name="shared-alternativetitle"   method="post">
	 <input type="hidden" id="shared-filedate" name="shared-filedate"   method="post">
	 <input type="hidden" id="shared-filedescription"  name="shared-filedescription"   method="post">
	 <input type="hidden" id="shared-filealternativetitle"  name="shared-filealternativetitle"   method="post">
	 <input type="hidden" name="docidForOg" value="b-9781718219342-chapter14" method="post">
	 <input type="hidden" name="lang" value="en" method="post">
	  <input type="hidden" id="shared-contentcdescription" name="shared-contentcdescription"   method="post">
	  <input type="hidden" id="shared-contentfileTitle" name="shared-contentfileTitle"   method="post">

	 	 	<input type="hidden" id="current-docid" name="docid" value="b-9781718219342-chapter14" method="post"/>
          <input type="hidden" id="current-contentType" name="contentType" value="encyclopedia" method="post"/>
	 
	 
	 
	 			<input type="hidden" id="contenttypeurl" name="contenttypeurl" value="/encyclopedia-chapter?docid=b-9781718219342&tocid=b-9781718219342-chapter14" method="post"/>
		    <input type="hidden" id="userloggedin" name="userloggedin" value="$userLoggedIn" method="post"/>
		<input type="hidden" id="sitename" name="sitename" value="hklp" method="post"/>
		<input type="hidden"  name="title" value="title" method="post"/>
		<input type="hidden" id="authors" name="authors" value="authors" method="post"/>
		<input type="hidden" id="page_image" name="page_image" value="" method="post"/>
		<input type="hidden" id="hostname" name="hostname" value="https://www.humankineticslibrary.com" method="post"/>
		<input type="hidden" name="citation_exist_single" value="$citationExist" method="post"/>
	 	
	 	<input type="hidden" id="publishUrl" value="www.humankineticslibrary.com"/>
	 	<input type="hidden" id="hostVariable" value="www.humankineticslibrary.com"/>
	 		 	<div align="center" class="capcha">
	      <div align="center" class="g-recaptcha" data-callback="shareCaptchaSuccess" data-expired-callback="shareCaptchaExpire" data-sitekey="6LdegBoUAAAAAKKIzS-B9ySCuRyg3cCODS044F-I"></div>
	    </div>
	    		<div class="share_btns">
			<input type="button" id="share-btn" class="primary_btn disabled-btn" value="Send">			
			<!--<input type="button" value="Reset" class="secondary_btn" data-toggle="modal" data-target="#share-via-reset">-->
			<input type="button" value="Reset" class="secondary_btn share-clear-btn">
		</div>		
</form>


<!--<div class="modal fade" id="share-via-reset" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static" data-keyboard="false">
    <div class="vertical-alignment-helper">
		<div class="modal-dialog alert_modal vertical-align-center" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<h2>Alert</h2>
					<p>Are you sure you want to reset the form?</p>
					<input type="button" value="Yes" class="primary_btn share-clear-btn"> 
					<input type="button" value="No" class="secondary_btn share-clear-no-btn">
				</div>
			</div>
		</div>
	</div>	
</div>-->
<script type="text/javascript">
function shareCaptchaSuccess() {
   var $shareMandatory = $("#to-name, #to-email, #your-name, #your-email, #subject");
   shareValidate($shareMandatory);
}
function shareCaptchaExpire() {
    var $shareMandatory = $("#to-name, #to-email, #your-name, #your-email, #subject");
    shareValidate($shareMandatory);
}
var hostName = window.location.hostname;
var publishUrl = $("#publishUrl").val();
var hostVariable = $("#hostVariable").val();
if (publishUrl) {
	if (!~hostName.indexOf(hostVariable)) {
		$('body').append('<input type="hidden" id="noCaptcha" value="true"/>');
		$(".capcha").remove();
	}
}
</script>            </div>
         </div>
      </div>
   </div>
</div>

<div role="dialog" aria-labelledby="share_success_modal" aria-modal="true" aria-describedby="share_success_modal" class="modal fade" id="share_success_modal" tabindex="-1" data-backdrop="static" data-keyboard="true">
	<div class="vertical-alignment-helper">
		<div class="modal-dialog alert_modal vertical-align-center" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<h2 id="emailshare-successtxt" tabindex="0" aria-labelledby="emailshare-successtxt">Success</h2>
					<p id="email-enquiry" tabindex="0" aria-labelledby="email-enquiry">Your mail has been sent successfully</p>
					<input type="button" value="OK" class="primary_btn share-success-btn" data-dismiss="modal">
				</div>
			</div>
		</div>
	</div>	
</div>

<div role="dialog" aria-labelledby="download-professional" aria-modal="true" aria-describedby="download-professional-description" class="modal fade" id="download-professional" tabindex="-1" data-backdrop="static" data-keyboard="true">
	<div class="vertical-alignment-helper">
		<div class="modal-dialog citation_modal vertical-align-center" role="document">
			<div class="modal-content">
	         	<div class="modal-header">
		         	<div class="signin_close ml-auto">
		         	    <button type="button" class="close-button" data-dismiss="modal" aria-label="Close">
                          <img src="/bloomsbury_assets/bloomsbury/images/signin_close.png" alt="" role="presentation">
                        </button>
		         	</div>
	         	</div>
	            <div class="modal-body">
	            	
	            </div>
	            <a class="hide" id="embedded-download-url"></a>
         	</div>
		</div>
	</div>
</div>

<div id="download-legislation" class="hide">
	<div class="bc-h3 mb30 d-flex justify-content-s-around">Download page as</div>
	<div class="d-flex justify-content-s-around ">
		<div>
	   		<input type="button" class="btn primary_btn professional_download leg-download" value="PDF">
	   		<div class="mt20 button">
	   			Formatted for printing and mark up
	   		</div>
	   	</div>
	</div>
</div>

<div id="download-commentary" class="hide">
	<div class="bc-h3 mb30 d-flex justify-content-s-around">Download page as</div>
	<div class="d-flex justify-content-s-around ">
		<div>
	   		<input type="button" class="btn primary_btn professional_download word-download" value="Editable document">
	   		<div class="mt20 button">
	   			Can be opened in Word or similar (RTF file)
	   		</div>
	   	</div>
		<div>
	   		<input type="button" class="btn primary_btn professional_download leg-download" value="PDF">
	   		<div class="mt20 button">
				Formatted for printing and mark up
	   		</div>
	   	</div>
	</div>
</div>


<div id="download-precendent" class="hide">
	<div class="bc-h3 mb30 d-flex justify-content-s-around">Download page as</div>
	<div class="d-flex justify-content-s-around ">
		<div>
	   		<input type="button" class="btn primary_btn professional_download embedded-download" value="Precedent">
	   		<div class="mt20 button">
	   			to be used as a working file
	   		</div>
	   	</div>
		<div>
	   		<input type="button" class="btn primary_btn professional_download notes-download" value="Additional Information">
	   		<div class="mt20 button">
				Information and notes, if available
	   		</div>
	   	</div>
	</div>
</div>

<script type="text/javascript">

var doctype = "encyclopedia";
var documentId = "b-9781718219342";
var titlename = "Scoring Systems";
var titlevalue = "";
var description = "";
var xmlSource = "9781718219342_txt_xml.xml";
var contentType ="encyclopedia";
var mlaCitation = "$mlaCitation";
var partId = "$partid";
var lang = "en";
var productname = "hklp";
var contentDispType;
var ua = window.navigator.userAgent;
var msie = ua.indexOf("MSIE");
var isIE = false;
if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
	isIE = true;
}
var isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;
var siteId = 'bb01';
	$( "#save-btn" ).on('click',function() {
		if(!$(this).hasClass('disabled-btn')){
			var imagepath = '';
			var pageNo;
			var actionType="save";
			$("#authorname").children('.hide').remove();
			var authorname=$('#authorname').val() || $('#authorname').text();
			var imprintvalue = $('#imprintvalue').val();
			var publicationYear = $('#publicationYear').val() || $('#latlong').val();
			titlename = $('#title').text() || $('#title').val();
			titlevalue = $('#sub-title').text().length > 0 ? $('#sub-title').text().trim() : "";
			description = $('#description').text().trim().length >0 ? $('#description').text().trim():"";
		    if(doctype == "professional"){
			var lawstated = $("#lawstated").val();
			var lastupdated = $("#lastupdated").val();
			var jurisdiction = $("#jurisdiction").val();
			var edition = $("#edition").val();
			var titlevalue = $('#titlevalue').val();
			var parenttitle = $('#parentTitle').val();
			var practiceAreas = '';
			if ($("#vol-practiceArea a").length > 0) {
			    var n = $("#vol-practiceArea a").length; 
			    for (var i = 0; i < n; i++) {
			        var practicearea = $("#vol-practiceArea a").eq(i).text();
			        practiceAreas += practicearea; 
			       
			        if (i < n - 1) {
			            practiceAreas += ', ';
			        }
			    }
			} else {
			    practiceAreas = ''; 
			}
			}
			//var titlevalue = $('#titlevalue').val();
			if($('#actvalues').length > 0) {
				titlevalue += "~act~" + $.trim($('#actvalues').html().replaceAll('<b>','~b~').replaceAll('</b>','~/b~'));
			} else if ($(".drama-inline-block>.section-header").length > 0) {
				titlevalue = titlename;
            	if ($(".drama-inline-block>.section-header").text().toLowerCase().trim() != "playtext" && $(".drama-inline-block>.section-header").text().trim()) {
            		titlename = $(".drama-inline-block>.section-header").text() + " (text)";
            	} else {
            		titlename += " (text)";				
				}
			}
			if($("#seriesTitle").length > 0 && $("#seriesTitle").val()) {
				imprintvalue += "~~" + $("#seriesTitle").val();
			}
			if (!contentDispType) {
				if ($("#vol-contentTypes a").length > 0) {
					contentDispType = $("#vol-contentTypes a").eq(0).text();
				} else if ($("#vol-documentType a").length > 0) {
					contentDispType = $("#vol-documentType a").eq(0).text();
				} else if ($("#vol-contentType a").length > 0) {
					contentDispType = $("#vol-contentType a").eq(0).text();
				} else {
					contentDispType = "";
				}
			}
            var authorText = "";
            if ($(".drama-title-sub").length > 0) {
            	$(".drama-title-sub").each(function(){
            		var newContent = $(this).clone();
            		newContent.find("a").each(function(){
            			$(this).removeAttr("href").removeAttr("class");
            		});
            		authorText += "<p class='det-auth'>" + $.trim(newContent.html()) + "</p>"; 
            	});
            	authorname = authorText.replaceAll("<", "~").replaceAll(">","~~");
            }
            if ($("#authors-playtext").length > 0) {
				authorname = $("#authors-playtext").text().trim();
			}
            var selectedfolder=$('#save-item-page').find('.dropdown-toggle').attr('title');
			var selectedfolderid=$('#save-item-page').find('.selectpicker').find('option:selected').attr('label');
			var link=window.location.pathname;
			link=link.replaceAll('&','~');
			link=link.replaceAll('~com.dotmarketing.htmlpage.language=1','');			
			var queryStr = window.location.search;			
			
			link = (link+queryStr).split('&st=')[0];
			link=link.replaceAll('&','~');
			
            var coverImageUrl = $("#coverImageUrl").length>0?$("#coverImageUrl").attr('src'):$('#buildsupportimagelist').length>0?$('#buildsupportimagelist').val().split('~')[0]:0;
                        if(typeof coverImageUrl != "undefined" && coverImageUrl.length>0){
                imagepath = coverImageUrl;
            }

            			
            var referencingStyle=$('#refsyle').val();
           
			var selectedfolder=$('#save-item-page').find('.dropdown-toggle').attr('title');
			var selectedfolderid=$('#save-item-page').find('.selectpicker').find('option:selected').attr('label');
			var link=window.location.pathname;
			link=link.replaceAll('&','~');
			link=link.replaceAll('~com.dotmarketing.htmlpage.language=1','');			
			var queryStr = window.location.search;			
			
			link = (link+queryStr).split('&st=')[0];
			link=link.replaceAll('&','~');
			
			var path=window.location.href;
			documentId="b-9781718219342";
			var tocid="";
							tocid = "b-9781718219342-chapter14";
						if(tocid.length>0){
				documentId=tocid;
			}
			if(doctype == 'audio' || doctype == 'video'){
				titlename = $('#titletop').val();
				documentId="b-9781718219342";
			}
			if(doctype == 'image' ){
				documentId="b-9781718219342";
			}
		
			 if(doctype == "professional"){
			    imprintvalue ="";
			  }
			 	
			var ContentTypes ="";
			if("$level" == "file") {
			    ContentTypes = "catalogue-viewer-file";
			}else if("$level" == "item") {
			    ContentTypes = "catalogue-item";
			}else{
			    ContentTypes = contentDispType; 
			}
			var foldername = $(".addfoldername").val();
			var data =  {
                contentId: documentId,
                titlename: titlename,
                description: description,
                actionType: actionType,
                folder:selectedfolderid,
                imageUrl:imagepath,
                authorname:authorname,
                xmlSource:xmlSource,
                contentType:ContentTypes,
				contentDispType:contentDispType,
                product:productname,
				publicationYear:publicationYear,
				imprintvalue:imprintvalue,
				titlevalue:titlevalue,			
                link:link,
                referencingStyle:referencingStyle,
                lawstated:lawstated,
                lastupdated:lastupdated,
                jurisdiction:jurisdiction,
                edition:edition,
                practicearea:practiceAreas,
                parenttitle:parenttitle
            };

            var params = {name:foldername,description:'',product:productname,actionType:"save"};
			if (selectedfolderid == '-1') {
				showProgress();
				$.ajax({
					url: "/app/foldermanagement",
		            type: "POST",
		            data: params,
		            success: function(response) {
						if (response && response != "-1") {
		                	data.folder = response;
		                	callSaveMethod(data);
		                	$("#save-item-page").modal("hide");
		                } else {
		                	hideProgress();
		                	$("#errormsg").text('Folder name already exists');
							$('#errormsg').removeClass('hide');
		                }
		            },
		            error: function(xhr) {
		                hideProgress();
		            }	
				});
			} else {
				
			callSaveMethod(data);
			}
           					squidCall('Save', 'Toolbar');
						
            dataLayer.push({
			'event' : 'content_save'
			});
		}
        });
	
	function callSaveMethod(data) {
	
		$.ajax({
            url: "/app/savepageservlet",
            type: "get",
            data: data,
            success: function(response) {
                window.location.reload(true);
            },
            error: function(xhr) {
                hideProgress();
            }
        });
			
	}

	$( "#save-item-btn" ).on('click',function() {
		if($(this).hasClass('active')) {
			$("#delete-folder-common").modal('show');
		} else {
			$(this).attr('data-target','#save-item-page');
			$($(this).data("target")).show();
		}
		
	});
	
	$("#deletefolder").on('click', function(){
		var link=window.location.pathname;
		var queryStr = window.location.search;
		link = (link+queryStr).split('&st=')[0];
		link=link.replaceAll('&','~');
        var actionType="delete";
		if(link.length>0){
            showProgress();
            $.ajax({
                url: "/app/savepageservlet",
                type: "get",
                data: {
                    contentId: documentId,
                    actionType: actionType,
                    link:link
                },
                success: function(response) {
                    hideProgress();
                    $("#delete-folder-common").modal("hide");
                    $("#save-item-btn").removeClass("active").removeClass('selected');
                },
                error: function(xhr) {
                    hideProgress();
                }
            });
		}
	});


	/* Move to Bloomsbury JS */
	function getMobileOperatingSystem() {
        var userAgent = navigator.userAgent || navigator.vendor || window.opera;
        // Windows Phone must come first because its UA also contains "Android"
        if (/windows phone/i.test(userAgent)) {
            return "Windows Phone";
        }
        if (/android/i.test(userAgent)) {
            return "Android";
        }
        // iOS detection from: http://stackoverflow.com/a/9039885/177710
        if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
            return "iOS";
        }
        return "unknown";
    }
    /* Move to Bloomsbury JS */

	

    /* Ctrl + P print functionality */
	
	

	/* Ctrl + P print functionality */
            
	$( ".print_page" ).click(function() {
		var OS = getMobileOperatingSystem();
		if ((isIE || isFirefox || OS == "Android" || OS == "iOS") && $("#pdf-name").length > 0) {
	    } else if (OS == "Android") {
	       	var originalContents = document.body.innerHTML;
	      	if (window.printContents) {
				document.body.innerHTML = window.printContents;
	       	}
	       	setTimeout(function() {
	           	window.print();
	           	document.body.innerHTML = originalContents;
	           	showProgress();
	           	window.location.href=window.location.href;
	       	}, 3000);
	    } else if (OS == "iOS") {
	      	setTimeout(function () {
	      		if (window.frames["frame1"]) {
		        	window.frames["frame1"].focus();
		        	window.frames["frame1"].print();
		    	}
	       	}, 500);
	    } else {
	       	setTimeout(function () {
	       		if (window.frames["frame1"]) {
	       			window.frames["frame1"].focus();
		        	window.frames["frame1"].print();
	       		}
	       	}, 500);
	    }	
					squidCall('Print', 'Toolbar');
				$("#print-dialog").modal("hide");
		$("#print-catalog").modal("hide");
		/*$("#print_waiting").removeClass("hide");
		$("#print_loading").removeClass("hide");
		$("#print_ready").addClass("hide");*/
	});
	
			function squidCall(event, location, link) {
			var mdid = link || "";
			var options = window.squidObj || {};
			options.mact = event;
			options.mut = "Event";
			options.mdid = mdid;
			options.mcz = location;

			var userId;
			var formData;
			if (window.formObj) {
				formData = window.formObj;
				window.formObj = '';
			}
			triggerSquidEvent(options, event, siteId, userId, formData);
		}
		
		$("#citation-modal input[type='button']").on('click', function(e) {
			squidCall('Cite', 'Toolbar');		
		});

		$("#share-btn").on('click', function(e){
			if(!$(this).hasClass('disabled-btn')) {
				setTimeout(function(){
					squidCall('Share', 'Toolbar');
				}, 300);
			}
		});
		
		$("#download").click(function(e) {
			var allowDownload = $("#allowDownload").val();
			if("encyclopedia" == "catalogue" && allowDownload=="false"){
				$("#download-catalog").modal("show");
				e.preventDefault();
			}else if("encyclopedia" == "professional" && allowDownload=="false"){
				$("#download-professional").find(".modal-body").html(" ");
				let pdfPresent = $(".pdf-content").length > 0;
				let wordPresent = $(".word-content").length > 0;
				var bookType = $("#legalContentType").val();
				if(bookType=="legislation"){
					$("#download-professional").find(".modal-body").append($("#download-legislation").html());
				}else if(bookType=="precedents" || (bookType=="commentary" && (pdfPresent || wordPresent))){
					$("#download-professional").find(".modal-body").append($("#download-precendent").html());
				}else{
					$("#download-professional").find(".modal-body").append($("#download-commentary").html());
				}
				$("#download-professional").modal("show");
				e.preventDefault();
			}else{
				squidCall('Download', 'Toolbar');
				$("#allowDownload").val("false");
				var fileandextension = $('#download').attr('download');
				var substr = fileandextension.split('.');
				var fileName = '';
				var extension = '';
				if(substr.length > 1)
				{
				 fileName = substr[0];
				 extension = substr[1];
				}
				
				dataLayer.push({
				'event' : 'content_download',
				'file_name' : fileName,
				'file_extension' : extension 
				});
				$("#download-professional").modal("hide");
				$("#download-catalog").find(".download_start").removeClass("hide");
			}
		});
	    
    /* Citation Modal Responsive TABS - MLA, APA, Chicago */
	$.fn.responsiveTabs = function() {
          this.addClass('responsive-tabs');
          this.append($('<span class="glyphicon glyphicon-triangle-bottom"></span>'));
          this.append($('<span class="glyphicon glyphicon-triangle-top"></span>'));
   
          this.on('click', 'li.active > a, span.glyphicon', function() {
              this.toggleClass('open');
          }.bind(this));
   
          this.on('click', 'li:not(.active) > a', function() {
              this.removeClass('open');
          }.bind(this));
    };
    $('.nav.nav-tabs').responsiveTabs();
    /* Citation Modal Responsive TABS - MLA, APA, Chicago */

	$('#citation-btn').on('click',function(){
		if(!$(this).parent().hasClass('inactive')) {
		    				var citeUrl = "/app/getCitations?doctype="+doctype+"&docid=b-9781718219342-chapter14"+"&volid=b-9781718219342"+"&xmlSource="+"9781718219342_txt_xml.xml";
				
			var targetElement = $(this);
			showProgress();
			$.ajax({
	            url: citeUrl, 
	            success: function (result) {
	                hideProgress();
	                var all_citations = JSON.parse(result);
	                for(member in all_citations) {
	                	$('.citation_'+member).html(all_citations[member]);	
	                }
					 $('.exportFile').attr('href',all_citations["risFile"]);
					 $('.exportFile').attr('target','_blank');
					var citation_modal=$('#citation-modal');
					citation_modal.find('li').removeClass('active');
					citation_modal.find('.citation').children('li:first').addClass('active');
					citation_modal.find('.responsive-tabs').children('li:first').addClass('active');
					citation_modal.find('.tab-content').children().removeClass('active');
					citation_modal.find('.tab-content').children('div:first').addClass('active');
					$(this).attr('data-target','#citation-modal');
					citation_modal.find('.primary_btn').val('Copy to Clipboard').removeAttr('disabled');
					document.getSelection().removeAllRanges();
					citation_modal.modal('show');
	            },
	            error: function(error) {
	            	hideProgress();
	            }
        	});
        	
		}
	});
  	
    $('.export_RIS_btn').on('click',function(){
		dataLayer.push({
		'event' : 'content_cite'
		});
    });

    $(document).on('keydown', function (e) {
        if (e.key === "Escape") {
            $('.modal.show').each(function () {
                $(this).modal('hide');
            });
        }
    });

  	$(document).ready(function(event) {
    	$('.favourite-signin').on('click', function(){
  			addModalClass();
  		});
    	
    	$("#print-catalog,#download-catalog").on('hidden.bs.modal', function() {
    		$(this).find('.err-msg').addClass('hide');
    		$(this).find('input[type="number"]').val('');
    		$(this).find('input[type="number"]').prop('disabled',true);
    		$(this).find('.print_ready').addClass('hide');
    		$(this).find("#current-check").prop('checked', true);
    		$(this).find("#current-download").prop('checked', true);
    		$(this).find(".download_start").addClass("hide");
    	});
    	
    	$("#print-catalog").on('show.bs.modal', function() {
    		$(this).find('.print_ready').addClass('hide');
    	});
    	
    	$("input[name='print-type'],input[name='download-type']").on('change',function(){
    		if($(this).val()=="range"){
    			$(this).parent().find('input[type="number"]').prop('disabled',false);
    		}
    		if($(this).val()=="current"){
    			$(this).parent().parent().find('input[type="number"]').val('');
    			$(this).parent().parent().find('input[type="number"]').prop('disabled',true);
    		}
    	});
    	
    	$("#print-from,#print-to,#download-from,#download-to").keypress(function(e){
    	    if((e.keyCode >= 48 && e.keyCode <= 57))
    	    	return true;
    	   	return false;
    	});
    	    	
  		  			/* Create Article Reference Links */
	  		
	  		/* Create Article Reference Links */
  		
  		/* External links Alert Pop up */
  		
  		/* External links Alert Pop up */

  		/* Page Numbering indicators in document pages */
  		
		/* Page Numbering indicators in document pages */

		/* Table and Image modal*/
		
		/* Table and Image modal*/
		

  		$('.addfoldername').on('keyup', function(e){
	  		$("#errormsg").addClass('hide');
	  		if($(this).val()) {
	  			$('#save-btn').removeClass('disabled-btn');
	  		} else {
	  			$('#save-btn').addClass('disabled-btn');
	  		}
	  		var keyPressed = e.keyCode;
	  		if (keyPressed == 13) {
	  			$("#save-btn").click();
	  		}
	  	});
	  	$('.addfoldername').on('keydown', function(e){
	  		var keyPressed = e.keyCode;
	  		if (keyPressed == 13) {
	  			e.preventDefault();
	  		}
	  	});

		$("#favorite-dwnld, #favorite-sbscript, #share-sharetxtmail, #citation-btn, #save-item-btn").on('click', function(e) {
			if( e.which != 2 ) {
				$(this).addClass('active');
			}
		});

		$('#share-mail').on('shown.bs.modal',function(){
		    var author=$('#author a').text();
		    if(author.length==0){
                var authors=[];
                $('.article_cont .pull-left a').each(function(){
                    if($(this).text().length>0) {
                        authors.push($(this).text());
                    }
                });
                author=authors.join(',');
            }

            var title=$('#title').text() || $('#title').val();
            var date=$('#share_itemdate').text() || $('#share_itemdate').val();
            var description=$('#share_description').text() || $('#share_description').val();
            var alternativetitle=$('#share_alternativetitle').text() || $('#share_alternativetitle').val();
            var filedate=$('#share_filedate').text() || $('#share_filedate').val();
            var filealternativetitle=$('#share_filealternative_title').text() || $('#share_filealternative_title').val();
            var filedescription=$('#share_filedescription').text() || $('#share_filedescription').val();
            
			if(title.length==0){
				title=$('.article_right #title h2').text()
			}
            $('#share-title').val(title);
            $('#shared-itemdate').val(date);
            $('#shared-description').val(description);
            $('#shared-alternativetitle').val(alternativetitle);
            $('#shared-filedate').val(filedate);
            $('#shared-filedescription').val(filedescription);
            $('#shared-filealternativetitle').val(filealternativetitle);
            $('#share-authors').val(author);
            if ($('#vol-contentType').text()) {
            	$('#share-contenttype').val($('#vol-contentType').text());
            } else if ($('#vol-contentTypes').text()) {
            	$('#share-contenttype').val($('#vol-contentTypes').text());
            } else if ($('#vol-documentType').text()) {
            	$('#share-contenttype').val($('#vol-documentType').text());
            }
            var coverImageUrl = $("#coverImageUrl").attr('src')?$("#coverImageUrl").attr('src'):$("#coverImage").attr('src')?$("#coverImage").attr('src'):$("#coverImageUrl").val()?$("#coverImageUrl").val():$('#buildsupportimagelist').length>0?$('#buildsupportimagelist').val().split('~')[0]:"";
            $("#selected-imageurl").val(coverImageUrl);
            var titlevalue = $('#titlevalue').val();
            if("encyclopedia" == "museum") {
            	$("#current-contentType").val($("#recentcontenttype").val());	
            }
            $("#selected-subtitle").val(titlevalue);
            $("#selected-pubDate").val($('#publicationYear').val());
            $('#share-image').val($('#coverImageUrl').attr('src'));
            $('button[title="Close"]').focus();
        });

        $('#download-modal, #subscription-modal, #share-mail, #citation-modal, #save-item-page,#signin_modal').on('hidden.bs.modal', function(e) {
            $("#favorite-dwnld, #favorite-sbscript, #share-sharetxtmail, #citation-btn").removeClass('active');
            if(!$('#save-item-btn').hasClass('selected')){
                $('#save-item-btn').removeClass('active');
            }
        });
        $("#save-item-page").on("show.bs.modal", function (e) {
        	$('.addfoldername').val('').parent().addClass('hide');
            $('#save-item-page').find('.selectpicker').selectpicker('val', '');
            $('#save-btn').addClass('disabled-btn');

            $('.folder-name').attr("aria-hidden", "true");
            $('button[data-id="folder-select"]').attr("role", "listbox");
            $('li').attr("role", "application");
        });

        $(document).on('keypress', '.dropdown-menu.inner li a', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                this.click();
            }
        });

        $('#save-item-page').find('#folder-select').on('change', function() {
            selectedFolder = $(this).val();
  			if (selectedFolder == '-1') {
  				$('.addfoldername').parent().removeClass('hide');
  				$('#errormsg').html("");

  				$('.folder-name').removeAttr("aria-hidden");
  			} else {
  				$('.addfoldername').val('').parent().addClass('hide');

  				$('.folder-name').attr("aria-hidden", "true");

  				if(selectedFolder.trim().length == 0){
                	$('#save-btn').addClass('disabled-btn');
            	} else {
                	$('#save-btn').removeClass('disabled-btn');
            	}
  			}
        });
        $(".author-view-more").text("More...");
        $(".author-view-less").text("...Less");
        $('.subfacet').on('click', function(){
        	$.cookie('type', 'taxonomy');
        });

        $(".modal.fade").on('shown.bs.modal', function(e){
            e.preventDefault();
            $('button[title="Close"]').focus();
            const $modalButtons = $(this).find("button, [role='button']");
            disableBackground($modalButtons, true);
            disableViewerInteractions(true);
        });

        $(".modal.fade").on('hidden.bs.modal', function(e){
            const $modalButtons = $(this).find("button, [role='button']");
            disableBackground($modalButtons, false);
        });

        function disableBackground($modalButtons, disable) {
            if(disable)
            {
                $("button, [role='button'], [type='submit'], .acrobat-button")
                    .not($modalButtons)
                    .attr("aria-disabled", "true");

                $(".main-container").attr("aria-hidden", "true");
                $("#pdf-content").attr("aria-hidden", "true");
            }
            else
            {
                $("button, [role='button'], [type='submit'], .acrobat-button")
                    .removeAttr("aria-disabled");

                $(".main-container").removeAttr("aria-hidden");
                $("#pdf-content").removeAttr("aria-hidden");
            }
        }

        $('.citation-modal-tab [role="tab"]').each(function () {
        	$(this).on('keydown', function (e) {
        		//console.log('Key pressed:', e.key);

        		if (e.key === 'b') {
        			e.preventDefault();
        			$('.modal-content').each(function () {
        				const button = $(this).find('button, input[type="button"]').eq(1);

        				if (button.length) {
        					//console.log('Focusing button:', button[0]);
        					button.focus();
        				}
        			});
        		}
        	});
        });
  	});
			/* Squid calls for Recently Viewed/Related Content/Reference Links */
		
		/* Squid calls for Recently Viewed/Related Content/Reference Links */
	</script>			</div>
			<script language="javascript">
				var _$tarQ = _$tarQ || [];
				//Create an instance of contenttype and call getHtmlContent method passing content type and cache page type
	    		var echap = Object.create(contenttype);
				echap.getHtmlContent("encyclopedia", "echap");			
			</script>
			<div class="ssp-footer-layout">    <footer class="footer-temp2">    	<div class="ssp-footer-top">            <div class="container">                <div class="row ssp-foot">                    <div class="col-xs-12 col-sm-12 hidden-md hidden-lg">                        <ul class="ssp-footer-menu">                        						                    	<li class="" role="listitem"><a tabindex="0" aria-label="Home" href="/home">Home</a></li><li class="" role="listitem"><a tabindex="0" aria-label="About" href="/about-human-kinetics-library">About</a></li><li class="" role="listitem"><a tabindex="0" aria-label="Help" href="/help-content">Help</a></li><li class="" role="listitem"><a tabindex="0" aria-label="Accessibility" href="/accessibility">Accessibility</a></li><li class="" role="listitem"><a tabindex="0" aria-label="Contact Us" href="/contact-us">Contact Us</a></li>		                                            </ul>                    </div>							<div class="sm-temp2-container">								<div class="ssp-foot-logo">                    <div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 ssp-footleft-img">                        <span class="navbar-brand zero-leftpad first-logo">						    <a class="confirmModal" target="_blank" href="https://www.bloomsbury.com/dr/digital-resources/"><img src="/bloomsbury_assets/hklp/images/Bloomsbury Digital Resources.jpg" class="img-responsive" alt="Bloomsbury Digital Resources" title="Bloomsbury Digital Resources"></a>                        </span>                    </div>                    <div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 ssp-footright-img">						<span class="navbar-brand second-logo">                            <a class="confirmModal" target="_blank" href="https://uk.humankinetics.com/"><img src="/bloomsbury_assets/hklp/images/hklogo.png" class="img-responsive" alt="Human Kinetics" title="Human Kinetics"></a>                        </span>                    </div>					</div>                    <div class="col-xs-6 hidden-sm col-md-5 col-lg-6 hidden-xs footer2-nav">                        <ul class="ssp-footer-menu">                        						                    	<li class="" role="listitem"><a tabindex="0" aria-label="Home" href="/home">Home</a></li><li class="" role="listitem"><a tabindex="0" aria-label="About" href="/about-human-kinetics-library">About</a></li><li class="" role="listitem"><a tabindex="0" aria-label="Help" href="/help-content">Help</a></li><li class="" role="listitem"><a tabindex="0" aria-label="Accessibility" href="/accessibility">Accessibility</a></li><li class="" role="listitem"><a tabindex="0" aria-label="Contact Us" href="/contact-us">Contact Us</a></li>		                                            </ul>                    </div>                    <div class="col-xs-6 col-sm-3 col-md-3 col-lg-2 footer2-social">						<div class="hidden-xs footer2-social-inner">															<div class="social-media">									<!-- <h5 tabindex="0">Social Media</h5> -->									<ul role="menu">										<li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://www.bloomsbury.com/newsletter/academic/bloomsbury-digital-resources/human-kinetics-library" title="Newsletters"><span class="icon-Newsletters" title="Newsletters"></span></a></li><li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://twitter.com/BloomsburyDigtl" title="X"><span class="icon-X" title="X"></span></a></li><li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://www.instagram.com/bloomsburydigtl/" title="Instagram"><span class="icon-Instagram" title="Instagram"></span></a></li>									</ul>								</div>													</div>						</div>						<!-- social Icons for mobile devices starts-->						<div class="visible-xs xs-social">														<div class="social-media">									<!-- <h5 tabindex="0">Social Media</h5> -->									<ul role="menu">										<li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://www.bloomsbury.com/newsletter/academic/bloomsbury-digital-resources/human-kinetics-library" title="Newsletters"><span class="icon-Newsletters" title="Newsletters"></span></a></li><li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://twitter.com/BloomsburyDigtl" title="X"><span class="icon-X" title="X"></span></a></li><li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://www.instagram.com/bloomsburydigtl/" title="Instagram"><span class="icon-Instagram" title="Instagram"></span></a></li>									</ul>								</div>								<div class="dropup">									<div class="more-social-icon dropdown">										<a class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">											<img src="/bloomsbury_assets/bloomsbury/images/more-dot-icon.png" alt="">										</a>										<div class="dropdown-menu signin_dropdown social-dropdown-layer" role="menu">											<div class="social-dropdown">												<ul role="menu">													<li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://www.bloomsbury.com/newsletter/academic/bloomsbury-digital-resources/human-kinetics-library" title="Newsletters"><span class="icon-Newsletters" title="Newsletters"></span></a></li><li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://twitter.com/BloomsburyDigtl" title="X"><span class="icon-X" title="X"></span></a></li><li role="menuitem" class=""><a target="_blank" class="confirmModal" href="https://www.instagram.com/bloomsburydigtl/" title="Instagram"><span class="icon-Instagram" title="Instagram"></span></a></li>												</ul>											</div>										</div>									</div>								</div>													</div>							<!-- social Icons for mobile devices ends-->                    </div>                </div>            </div>        </div>        <div class="ssp-footer-btm">            <div class="container">                <div class="row">                 <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 text-left">                        <h6>                        						                    	Copyright Bloomsbury Publishing Plc 2025		                                            </h6>                    </div>                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 text-right">                       											                   	<h6><a href="/terms-and-conditions" alt="Terms and Conditions" title="Terms and Conditions">Terms and Conditions</a></h6><h6><a href="/privacy-policy" alt="Privacy Policy" title="Privacy Policy">Privacy Policy</a></h6>		                				                    </div>                </div>            </div>        </div>    </footer></div>
  	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    	    		
<script>
      plyr.setup();
    $('.popper').popover({
    placement: 'top',
    container: 'body',
    trigger: 'manual',
    html: true,
    content: function () {
      return $(this).next('.popper-content').length>0?$(this).next('.popper-content').html():$(this).parent().next('.popper-content').html();
    }
  }).off('keyup click').on('keyup click', function(e){
    if (e.keyCode == 13) {
      $('this').trigger('click');
    } else if (e.type == "click") {
      e.stopPropagation();
      $('.popper').popover('hide');
      $(this).popover('toggle');
    }
  });
  
  $('.article-popper').popover({
    placement: 'top',
    container: 'body',
    trigger: 'manual',
    html: true,
    content: function () {
      return $('.popper-content[id="'+$(this).attr('popover-id')+'"]').html();
    }
  }).on('keyup click', function(e){
    if (e.keyCode == 13) {
      $('this').trigger('click');
    } else if (e.type == "click") {
      e.stopPropagation();
      $('.article-popper').popover('hide');
      $(this).popover('toggle');
    }
  });
  initArcadianLibraryImageSlider();
  $('a[target="_blank"]').each(function(){
    $(this).attr("rel", "noopener noreferrer");
  });
  $('.custom_text_widget a').on('click', function(e){
    dataLayer.push({
      'event' : 'click_institutional_message'
    });
  });
   $('.owl-dots').on('click', function(e){
   		var cms_element_type="";
   		const navObj = {};	
   		cms_element_type="Image Slider";
        navObj.event= 'cms_element_click';
		navObj.cms_element_type =cms_element_type;
	    dataLayer.push(navObj);
    });
       $(".owl-nav").on('click', function(e){
   		var cms_element_type="";
   		const navObj = {};	
   		if(!e.isTrigger){
   		cms_element_type="Image Slider";
        navObj.event= 'cms_element_click';
		navObj.cms_element_type =cms_element_type;
	    dataLayer.push(navObj);
	    }
    });
     $('.carousel-indicators').on('click', function(e){
   		var cms_element_type="";
   		const navObj = {};	
   		cms_element_type="Image Carousel";
        navObj.event= 'cms_element_click';
		navObj.cms_element_type =cms_element_type;
	    dataLayer.push(navObj);
    });
      $('.hero_image_widget').on('click', function(e){
   		var cms_element_type="";
   		const navObj = {};	
   		cms_element_type="Hero Image";
        navObj.event= 'cms_element_click';
		navObj.cms_element_type =cms_element_type;
	    dataLayer.push(navObj);
    });

  var cmselements = '.audio_widget,.video_widget,.paragraph_widget,.social_feed,.image_feature,.carousel-layer,.image-slider-layout,.contact_us,.adminportal_widget,.tile_widget,.custom_text_widget';
   var cms_element_type="";
   const navObj = {};	
   var isImageFeature = false;
    $(cmselements).find('a,button,input[type="button"],img').on('click',function(){
	var classname = $(this).parents(cmselements).attr('class');
	if(!isImageFeature){
    var parentElement = $(this).parent('a');
  	if (parentElement.is('a') && $(this).is('img')) {        
        isImageFeature = true; 
        return true; 
           } 
    }
	var currentclasses = classname.split(' ');	
	var presentclass = '';
	for(var x=0;x<currentclasses.length;x++) {
    if (cmselements.includes(currentclasses[x])) {
   		presentclass = currentclasses[x]; 
  		 classname = presentclass;
		break;	
	}
	}
	switch (classname) {		
       case 'audio_widget':
		cms_element_type="Audio";
		break;
		case 'video_widget':
		cms_element_type="Video";
		break;
		case 'paragraph_widget':
		cms_element_type="Paragraph";
		break;
		case 'social_feed':
		cms_element_type="Social Feeds";
		break;
		case 'image_feature':
		cms_element_type="Image";
		break;
		case 'carousel-layer':
		cms_element_type="Image Carousel";
		break;
		case 'image-slider-layout':
		cms_element_type="Image Slider";
		break;
		case 'contact_us':
		cms_element_type="Contact Us form";
		break;
		case 'adminportal_widget':
		cms_element_type="Admin Portal";
		break;
		case 'tile_widget':
		cms_element_type="Title/Custom Grid";
		break;
		case 'custom_text_widget':
		cms_element_type="Custom Text Box";
		break;
    }
		navObj.event= 'cms_element_click'
		navObj.cms_element_type =cms_element_type
	    dataLayer.push(navObj);
	    isImageFeature = false;
	});
$('.ssp-footer-layout li a').on('click', function(e){
		 var domainname = window.location.host;
 		 var host = window.location.href;
  		 var parent=$(this).parent().parent();   		 
   		 var interactiontype = "parent";
   		 var sibling= "";
   		 var linkclasses = "";
         if (parent.hasClass('dropdown-menu'))
	   	 {
		   interactiontype = "child";
		   sibling=parent.prev().text()+ " > "+$(this).text();		  
	  	 }
		else
		{
		  sibling = $(this).text();
		}
		 var idattrvalue = $(this).attr('title');
		 if(idattrvalue == undefined){
			 idattrvalue = "";
		 }
		 var hrefValue = $(this).attr('href');
		 if(hrefValue== "#")
		 {
		  hrefValue = '';
		 }
		  if(hrefValue== "javascript:void(0)")
		 {
		  hrefValue = '';
		 }
		 linkclasses =  $(this).attr('class');
		 if(linkclasses == undefined){
			 linkclasses = "";
		 }
		 const navObj = {};			 
		 navObj.event= 'click_nav_link'
		 navObj.link_classes = linkclasses
		 navObj.link_domain = domainname
		 navObj.link_id = idattrvalue
		 navObj.link_text = $(this).text()
		 navObj.link_url = host+hrefValue
		 navObj.link_breadcrumb = sibling
		 navObj.interaction_type = interactiontype
		 dataLayer.push(navObj);
           });
     	$(document).on('click', '#quiz_data_form input[type="radio"], #quiz_data_form input[type="checkbox"]', function() {
    	var cms_element_type="";
   		const navObj = {};	
   		cms_element_type="Quiz";
        navObj.event= 'cms_element_click';
		navObj.cms_element_type =cms_element_type;
	    dataLayer.push(navObj);               	
        });
  if (!window.analyticsFlag) {
		googleAnalyticsPageLoad();
	}
	</script>
<script type="text/javascript">
	yourContentAdjustment();
	function yourContentAdjustment() {
		$(".your_content_widget").each(function(){
			var container = $(this).find('.main-content-area .archieve_top').length ? $(this).find('.main-content-area .archieve_top') : $(this);
			var totalAccordionList = $(this).find(".yourcontent_accordion");
			var accordionList = $(this).find(".yourcontent_accordion").filter(function(){
				return $(this).find(".item-list").length > 0;
			});
			var rowCount = $(this).find(".row").length;
			var accordionCount = accordionList.length;
			var numColumns = $(this).find(".yourContentColums").val();
			numColumns = parseInt(numColumns)?parseInt(numColumns):0;
			var numEntries = $(this).find(".yourContentEntries").val();
			numEntries = parseInt(numEntries)?parseInt(numEntries):0;
			var rowAdjustmentFlag = accordionList.length < totalAccordionList.length;
			if (rowAdjustmentFlag) {
				$(this).find('.row').remove();
			}
			for (let i = 0; i < accordionList.length; i += numColumns) {
		    const newRow = $('<div class="row"></div>');
		    for (let j = i; j < i + numColumns && j < accordionList.length; j++) {
		    	var itemListCount = $(accordionList[j]).find('.item-list').length;
		     	if (itemListCount > numEntries) {
		     		$(accordionList[j]).find(".browse-all-link").removeClass("hide");
		     		$(accordionList[j]).find(".item-list").slice(numEntries).remove();
		     	} else {
		     		$(accordionList[j]).find(".browse-all-link").addClass("hide");
		     	}
		     	if (rowAdjustmentFlag) {
		      	newRow.append($(accordionList[j]));
		    	}
		    }
		    if (rowAdjustmentFlag) {
		    	container.append(newRow);
		    }
		  }  
			if(accordionList.length == 0) {
				$(this).parent().addClass("hide");
			}
	  	//$(this).find(".yourcontent_accordion").each(function(){});
		});
		$(".your_content_widget .collapse").on("shown.bs.collapse", function (e) {
			$(this).parent().find('.panel-heading .glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
		}).on("hidden.bs.collapse", function(e){
			$(this).parent().find('.panel-heading .glyphicon').removeClass('glyphicon-minus').addClass('glyphicon-plus');
		});
	}
</script>
</body>
</html>
